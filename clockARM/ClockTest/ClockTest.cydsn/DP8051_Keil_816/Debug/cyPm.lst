C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 1   


C51 COMPILER V8.16, COMPILATION OF MODULE CYPM
OBJECT MODULE PLACED IN C:/Users/Jon Moeller/Documents/PSoC Creator/clockARM/ClockTest/ClockTest.cydsn/DP8051_Keil_816/Debug/cyPm.OBJ
COMPILER INVOKED BY: C:\Program Files\Cypress\PSoC Creator\1.0\PSoC Creator\import\keil\pk51\8.16\C51\BIN\c51.exe C:\Use
                    -rs\Jon Moeller\Documents\PSoC Creator\clockARM\ClockTest\ClockTest.cydsn\Generated_Source\PSoC3\cyPm.c NOIV LARGE MODDP2
                    - OMF2 VB(1) PR(C:/Users/Jon Moeller/Documents/PSoC Creator/clockARM/ClockTest/ClockTest.cydsn/DP8051_Keil_816/Debug/cyPm
                    -.lst) CD DB NOIP OT(2,SIZE) INCDIR(Generated_Source/PSoC3) OJ(C:/Users/Jon Moeller/Documents/PSoC Creator/clockARM/Clock
                    -Test/ClockTest.cydsn/DP8051_Keil_816/Debug/cyPm.OBJ)

line level    source

   1          /*******************************************************************************
   2          * File Name: cyPm.c
   3          * Version 2.20
   4          *
   5          *  Description:
   6          *   Provides an API for the power management.
   7          *
   8          *  Note:
   9          *   Documentation of the API's in this file is located in the
  10          *   System Reference Guide provided with PSoC Creator.
  11          *
  12          *******************************************************************************
  13          * Copyright 2008-2010, Cypress Semiconductor Corporation.  All rights reserved.
  14          * You may use this file only in accordance with the license, terms, conditions,
  15          * disclaimers, and limitations in the end user license agreement accompanying
  16          * the software package with which this file was provided.
  17          ********************************************************************************/
  18          
  19          #include "cyPm.h"
  20          
  21          static CY_PM_BACKUP_STRUCT  cyPmBackup;
  22          
  23          /* Convertion table between CyIMO_SetFreq() parameters and register's value */
  24          const uint8 CYCODE cyPmImoFreqMhz2Reg[7u] = {
  25              CY_IMO_FREQ_12MHZ, CY_IMO_FREQ_6MHZ,  CY_IMO_FREQ_24MHZ, CY_IMO_FREQ_3MHZ,
  26              CY_IMO_FREQ_48MHZ, CY_IMO_FREQ_62MHZ, CY_IMO_FREQ_74MHZ};
  27          
  28          /* Convertion table between register's values and frequency in MHz  */
  29          const uint8 CYCODE cyPmImoFreqReg2Mhz[7u] = {12u, 6u, 24u, 3u, 48u, 62u, 74u};
  30          
  31          /* Function Prototypes */
  32          void CyPmCtwSaveSet(uint8 ctwInterval);
  33          void CyPmFtwSaveSet(uint8 ftwInterval);
  34          void CyPmOppsSaveSet(void);
  35          
  36          void CyPmHibSaveSet(void);
  37          void CyPmHibRestore(void) ;
  38          
  39          void CyPmHibSlpSaveSet(uint8 powerMode);
  40          void CyPmHibSlpRestore(void);
  41          
  42          
  43          /*******************************************************************************
  44          * Function Name: CyPmSaveClocks
  45          ********************************************************************************
  46          *
  47          * Summary:
  48          *  This function is called in preparation for entering sleep or hibernate low
  49          *  power modes. Saves all state of the clocking system that doesn?t persist
  50          *  during sleep/hibernate or that needs to be altered in preparation for
  51          *  sleep/hibernate. Shutdowns all the digital and analog clock dividers.
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 2   

  52          *
  53          *  Switches the master clock over to the IMO and shuts down the PLL and MHz
  54          *  Crystal. If the IMO is not currently running it is enabled at 3 MHz before
  55          *  the switch over. The ILO and 32 KHz oscillators are not impacted. The current
  56          *  Flash wait state setting is saved and the Flash wait state setting is
  57          *  set for the current IMO speed.
  58          *
  59          * Parameters:
  60          *  None.
  61          *
  62          * Return:
  63          *  None.
  64          *
  65          * Reentrant:
  66          *  No.
  67          *
  68          * Side Effects:
  69          *  All peripheral clocks are going to be off after this API method call.
  70          *
  71          *******************************************************************************/
  72          void CyPmSaveClocks(void)
  73          {
  74   1          /* Digital and analog clocks - save enable state and disable them all */
  75   1          cyPmBackup.enClkA = CY_PM_ACT_CFG1_REG & CY_PM_ACT_EN_CLK_A_MASK;
  76   1          cyPmBackup.enClkD = CY_PM_ACT_CFG2_REG;
  77   1          CY_PM_ACT_CFG1_REG &= ~CY_PM_ACT_EN_CLK_A_MASK;
  78   1          CY_PM_ACT_CFG2_REG &= ~CY_PM_ACT_EN_CLK_D_MASK;
  79   1      
  80   1          /* Master clock - save current source */
  81   1          cyPmBackup.masterClkSrc = CY_PM_CLKDIST_MSTR1_REG & CY_PM_MASTER_CLK_SRC_MASK;
  82   1      
  83   1          /* IMO - save current IMO MHZ OSC */
  84   1          cyPmBackup.imoFreqMhz = cyPmImoFreqReg2Mhz[(CY_PM_FASTCLK_IMO_CR_REG & CY_PM_FASTCLK_IMO_CR_FREQ_MASK)
             -];
  85   1      
  86   1          /* Save current flash wait cycles and set the maximum new one */
  87   1          cyPmBackup.flashWaitCycles = (CY_PM_CACHE_CR_CYCLES_MASK & CY_PM_CACHE_CR_REG);
  88   1      
  89   1          /* Device is PSoC 3 and the revision is ES3 or later */
  90   1          #if(CY_PM_PSOC3_ES3)
  91   1      
  92   1              CyFlash_SetWaitCycles(45u);
  93   1                          
  94   1          #endif  /* End of (CY_PM_PSOC3_ES3) */
  95   1      
  96   1          /* Device is PSoC 3 and the revision is ES2 or earlier */
  97   1          #if(CY_PM_PSOC3_ES2)
                      
                      CyFlash_SetWaitCycles(49u);
                      
                  #endif  /* End of (CY_PM_PSOC3_ES2) */
 102   1          
 103   1          /* Device is PSoC 5 */
 104   1          #if(CY_PM_PSOC5_ES1 || CY_PM_PSOC5_ES2)
              
                      CyFlash_SetWaitCycles(73u);
              
                  #endif  /* End of (CY_PM_PSOC5_ES1 || CY_PM_PSOC5_ES2) */
 109   1      
 110   1          /* IMO - save enable state and enable with wait to settle */
 111   1          if(0u != (CY_PM_ACT_CFG0_IMO & CY_PM_ACT_CFG0_REG))
 112   1          {
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 3   

 113   2              /* IMO - save enabled state */
 114   2              cyPmBackup.imoEnable = CY_PM_ENABLED;
 115   2              
 116   2              /* IMO - set it below 48 MHz */
 117   2              if((CY_PM_FASTCLK_IMO_CR_REG & CY_PM_FASTCLK_IMO_CR_FREQ_MASK) > CY_IMO_FREQ_48MHZ)
 118   2              {
 119   3                  /* IMO - set 48 MHz frequency */
 120   3                  CyIMO_SetFreq(CY_IMO_FREQ_48MHZ);
 121   3              }
 122   2          }
 123   1          else
 124   1          {
 125   2              /* IMO - save disabled state */
 126   2              cyPmBackup.imoEnable = CY_PM_DISABLED;
 127   2              
 128   2              /* IMO - set 3 MHz frequency if not yet */
 129   2              if(cyPmImoFreqReg2Mhz[(CY_PM_FASTCLK_IMO_CR_REG & CY_PM_FASTCLK_IMO_CR_FREQ_MASK)] != CY_IMO_FREQ_
             -3MHZ)
 130   2              {
 131   3                  CyIMO_SetFreq(CY_IMO_FREQ_3MHZ);
 132   3              }   /* Do nothing if IMO MHZ OSC is already set */
 133   2              
 134   2              /* IMO - enable */
 135   2              CyIMO_Start(CY_PM_WAIT_IMO);
 136   2          }
 137   1      
 138   1          /* IMO - save the current IMOCLK source and set to IMO if not yet */
 139   1          if(0u != (CY_PM_FASTCLK_IMO_CR_REG & CY_PM_FASTCLK_IMO_CR_XCLKEN))
 140   1          {
 141   2              /* DSI or XTAL CLK */
 142   2              cyPmBackup.imoClkSrc =
 143   2                  (CY_PM_CLKDIST_CR_REG & CY_PM_CLKDIST_IMO2X_SRC) ? CY_IMO_SOURCE_XTAL : CY_IMO_SOURCE_DSI;
 144   2      
 145   2              /* IMO -  set IMOCLK source to MHz OSC */
 146   2              CyIMO_SetSource(CY_IMO_SOURCE_IMO);
 147   2          }
 148   1          else
 149   1          {
 150   2              /* IMO */
 151   2              cyPmBackup.imoClkSrc = CY_IMO_SOURCE_IMO;
 152   2          }
 153   1      
 154   1          /* Save clk_imo source */
 155   1          cyPmBackup.clkImoSrc = (CY_PM_CLKDIST_CR_REG & CY_PM_CLKDIST_IMO_OUT_MASK);
 156   1      
 157   1          if(CY_PM_CLKDIST_IMO_OUT_IMO != cyPmBackup.clkImoSrc)
 158   1          {
 159   2              /* IMOCLK2X or SPC OSC is source for clk_imo */
 160   2      
 161   2              /* Set IMOCLK to source for clk_imo */
 162   2              CY_PM_CLKDIST_CR_REG = (CY_PM_CLKDIST_CR_REG & ~CY_PM_CLKDIST_IMO_OUT_MASK) |
 163   2                                  CY_PM_CLKDIST_IMO_OUT_IMO;
 164   2          }    /* Need to change nothing if IMOCLK is source clk_imo */
 165   1      
 166   1          /* IMO doubler - save enable state and disable */
 167   1          if(0u != (CY_PM_FASTCLK_IMO_CR_REG & CY_PM_FASTCLK_IMO_CR_F2XON))
 168   1          {
 169   2              /* IMO doubler enabled - save and disable */
 170   2              cyPmBackup.imo2x = CY_PM_ENABLED;
 171   2              CyIMO_DisableDoubler();
 172   2          }
 173   1          else
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 4   

 174   1          {
 175   2              /* IMO doubler disabled */
 176   2              cyPmBackup.imo2x = CY_PM_DISABLED;
 177   2          }
 178   1      
 179   1          /* Master clock - save divider and set it to divide-by-one (if no yet) */
 180   1          cyPmBackup.clkSyncDiv = CY_PM_CLKDIST_MSTR0_REG;
 181   1          if(CY_PM_DIV_BY_ONE != cyPmBackup.clkSyncDiv)
 182   1          {
 183   2              /* Divider is > 1 */
 184   2              CyMasterClk_SetDivider(CY_PM_DIV_BY_ONE);
 185   2          }    /* Need to change nothing if master clock divider is 1 */
 186   1      
 187   1          /* Master clock source - set it to IMO if not yet. Saved above. */
 188   1          if(CY_MASTER_SOURCE_IMO != cyPmBackup.masterClkSrc)
 189   1          {
 190   2              CyMasterClk_SetSource(CY_MASTER_SOURCE_IMO);
 191   2          }    /* Need to change nothing if master clock source is IMO */
 192   1      
 193   1          /* Bus clock - save divider and set it, if needed, to divide-by-one */
 194   1          cyPmBackup.clkBusDiv = ((uint16) CY_PM_CLK_BUS_MSB_DIV_REG << 8u) | CY_PM_CLK_BUS_LSB_DIV_REG;
 195   1          if(CY_PM_BUS_CLK_DIV_BY_ONE != cyPmBackup.clkBusDiv)
 196   1          {
 197   2              CyBusClk_SetDivider(CY_PM_BUS_CLK_DIV_BY_ONE);
 198   2          }    /* Do nothing if saved and actual values are equal */
 199   1      
 200   1      
 201   1          /* Device is PSoC 3 and the revision is ES3 or later */
 202   1          #if(CY_PM_PSOC3_ES3)
 203   1      
 204   1              /* Save CPU frequency in MHz */
 205   1              cyPmBackup.cpuFreqMhz = (cyPmImoFreqReg2Mhz[CY_PM_FASTCLK_IMO_CR_REG & CY_PM_FASTCLK_IMO_CR_FREQ_M
             -ASK] /
 206   1                          (((CY_PM_CLKDIST_MSTR1_REG & CY_PM_CLKDIST_CPU_DIV_MASK) >> 4u) + 1u));
 207   1      
 208   1          #endif  /* End of (CY_PM_PSOC3_ES3) */
 209   1      
 210   1          /* Device is PSoC 3 and the revision is ES2 or earlier */
 211   1          #if(CY_PM_PSOC3_ES2)
              
                      /* Save CPU frequency in MHz */
                      cyPmBackup.cpuFreqMhz = (cyPmImoFreqReg2Mhz[CY_PM_FASTCLK_IMO_CR_REG & CY_PM_FASTCLK_IMO_CR_FREQ_M
             -ASK] /
                                  ((CY_GET_XTND_REG8(CYREG_SFR_USER_CPUCLK_DIV) & CY_PM_SFR_USER_CPUCLK_MASK) + 1u));
              
                  #endif  /* End of (CY_PM_PSOC3_ES2) */
 218   1          
 219   1          /* Device is PSoC 5 */
 220   1          #if(CY_PM_PSOC5_ES1 || CY_PM_PSOC5_ES2)
              
                      /* Save CPU frequency in MHz. The CPU clock is directly derived from
                      *  bus clock.
                      */
                      cyPmBackup.cpuFreqMhz = (cyPmImoFreqReg2Mhz[CY_PM_FASTCLK_IMO_CR_REG & CY_PM_FASTCLK_IMO_CR_FREQ_M
             -ASK]);
              
                  #endif  /* End of (CY_PM_PSOC5_ES1 || CY_PM_PSOC5_ES2) */
 228   1          
 229   1          /* Set number of wait cycles for the flash */
 230   1          CyFlash_SetWaitCycles(cyPmBackup.cpuFreqMhz);
 231   1      
 232   1          /* PLL - check enable state, disable if needed */
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 5   

 233   1          if(0u != (CY_PM_FASTCLK_PLL_CFG0_REG & CY_PM_PLL_CFG0_ENABLE))
 234   1          {
 235   2              /* PLL is enabled - save state and disable */
 236   2              cyPmBackup.pllEnableState = CY_PM_ENABLED;
 237   2              CyPLL_OUT_Stop();
 238   2          }
 239   1          else
 240   1          {
 241   2              /* PLL is disabled - save state */
 242   2              cyPmBackup.pllEnableState = CY_PM_DISABLED;
 243   2          }
 244   1      
 245   1          /* MHz ECO - check enable state and disable if needed */
 246   1          if(0u != (CY_PM_FASTCLK_XMHZ_CSR_REG & CY_PM_XMHZ_CSR_ENABLE))
 247   1          {
 248   2              /* MHz ECO is enabled - save state and disable */
 249   2              cyPmBackup.xmhzEnableState = CY_PM_ENABLED;
 250   2              CyXTAL_Stop();
 251   2          }
 252   1          else
 253   1          {
 254   2              /* MHz ECO is disabled - save state */
 255   2              cyPmBackup.xmhzEnableState = CY_PM_DISABLED;
 256   2          }
 257   1      }
 258          
 259          
 260          /*******************************************************************************
 261          * Function Name: CyPmRestoreClocks
 262          ********************************************************************************
 263          *
 264          * Summary:
 265          *  Restores any state that was preserved by the last call to CyPmSaveClocks().
 266          *  The Flash wait state setting is also restored.
 267          *
 268          *  The merge region could be used to process state when  the megahertz crystal
 269          *  is not ready after CY_PM_MHZ_XTAL_WAIT_MS milliseconds.
 270          *
 271          *
 272          * Parameters:
 273          *  None.
 274          *
 275          * Return:
 276          *  None.
 277          *
 278          * Side Effects:
 279          *  None.
 280          *
 281          *******************************************************************************/
 282          void CyPmRestoreClocks(void) 
 283          {
 284   1          cystatus status = CYRET_TIMEOUT;
 285   1          uint8 i;
 286   1          
 287   1          /* MHz ECO restore state */
 288   1          if(CY_PM_ENABLED == cyPmBackup.xmhzEnableState)
 289   1          {
 290   2              /* Enabling XMHZ XTAL. The actual CyXTAL_Start() with non zero wait
 291   2                 period uses FTW for period measurement. This could cause a problem
 292   2                 if CTW/FTW is used as a wake up time in the low power modes APIs.
 293   2                 So, the XTAL wait procedure is implemented with a software delay.
 294   2              */
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 6   

 295   2              
 296   2              /* Enable XMHZ XTAL with no wait */
 297   2              CyXTAL_Start(CY_PM_XTAL_MHZ_NO_WAIT);
 298   2              
 299   2              /* Read XERR bit to clear it */
 300   2              CY_PM_FASTCLK_XMHZ_CSR_REG;
 301   2              
 302   2              /* Wait 5 times for CY_PM_WAIT_200_US */
 303   2              for(i = 5u; i > 0u; i--)
 304   2              {
 305   3                  /* Make a us delay */
 306   3                  CyDelayCycles(CY_PM_WAIT_200_US * cyPmBackup.cpuFreqMhz);
 307   3                  
 308   3                  /* High output indicates oscillator failure */
 309   3                  if(0u == (CY_PM_FASTCLK_XMHZ_CSR_REG & CY_PM_XMHZ_CSR_XERR)) 
 310   3                  {
 311   4                      status = CYRET_SUCCESS;
 312   4                      break;
 313   4                  }
 314   3              }
 315   2              
 316   2              if(CYRET_TIMEOUT == status)
 317   2              {
 318   3                  /* `#START MHZ ECO TIMEOUT` */
 319   3      
 320   3                  /* `#END` */
 321   3              }
 322   2          }
 323   1          else
 324   1          {
 325   2              /* Disable MHz ECO */
 326   2              CyXTAL_Stop();
 327   2          }   /* End of (CY_PM_ENABLED == cyPmBackup.xmhzEnableState) */
 328   1      
 329   1      
 330   1          /* PLL restore state */
 331   1          if(CY_PM_ENABLED == cyPmBackup.pllEnableState)
 332   1          {
 333   2              /* Enabling PLL. The actual CyPLL_OUT_Start() without wait period uses
 334   2                 FTW for period measurement. This could cause a problem if CTW/FTW is
 335   2                 used as a wake up time in the low power modes APIs. So, the PLL wait
 336   2                 procedure is implemented with a software delay.
 337   2              */
 338   2              
 339   2              /* Enable PLL */
 340   2              CyPLL_OUT_Start(CY_PM_PLL_OUT_NO_WAIT);
 341   2      
 342   2              /* Make a 250 us delay */
 343   2              CyDelayCycles(CY_PM_WAIT_250_US * cyPmBackup.cpuFreqMhz);
 344   2          }
 345   1          else
 346   1          {
 347   2              /* Disable PLL */
 348   2              CyPLL_OUT_Stop();
 349   2          }   /* End of (CY_PM_ENABLED == cyPmBackup.pllEnableState) */
 350   1      
 351   1          /* Device is PSoC 3 and the revision is ES3 or later */
 352   1          #if(CY_PM_PSOC3_ES3)
 353   1      
 354   1              /* Temprorary set the maximum flash wait cycles */
 355   1              CyFlash_SetWaitCycles(45u);
 356   1                          
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 7   

 357   1          #endif  /* End of (CY_PM_PSOC3_ES3) */
 358   1      
 359   1          /* Device is PSoC 3 and the revision is ES2 or earlier */
 360   1          #if(CY_PM_PSOC3_ES2)
              
                      /* Temprorary set the maximum flash wait cycles */
                      CyFlash_SetWaitCycles(49u);
                      
                  #endif  /* End of (CY_PM_PSOC3_ES2) */
 366   1          
 367   1          /* Device is PSoC 5 */
 368   1          #if(CY_PM_PSOC5_ES1 || CY_PM_PSOC5_ES2)
              
                      /* Temprorary set the maximum flash wait cycles */
                      CyFlash_SetWaitCycles(73u);
              
                  #endif  /* End of (CY_PM_PSOC5_ES1 || CY_PM_PSOC5_ES2) */
 374   1      
 375   1          if(CY_PM_MASTER_CLK_SRC_IMO != cyPmBackup.masterClkSrc)
 376   1          {
 377   2              /* If not IMO, then PLL or XMHZ or DSI_CLKIN.
 378   2              *  All clocks above are ready to be source for Master clock,
 379   2              *  so restore Master clock source and Master clock divider.
 380   2              */
 381   2              if(CY_PM_CLKDIST_MSTR0_REG != cyPmBackup.clkSyncDiv)
 382   2              {
 383   3                  /* Restore Master clock divider */
 384   3                  CyMasterClk_SetDivider(cyPmBackup.clkSyncDiv);
 385   3              }
 386   2              
 387   2              /* Restore Master clock source */
 388   2              CyMasterClk_SetSource(cyPmBackup.masterClkSrc);
 389   2          }
 390   1      
 391   1          /* IMO - restore IMO frequency */
 392   1          if(cyPmBackup.imoFreqMhz != cyPmImoFreqReg2Mhz[(CY_PM_FASTCLK_IMO_CR_REG & CY_PM_FASTCLK_IMO_CR_FREQ_M
             -ASK)])
 393   1          {
 394   2              CyIMO_SetFreq(cyPmImoFreqMhz2Reg[cyPmBackup.imoFreqMhz]);
 395   2          }    /* Do nothing if IMO freq is equal to saved */
 396   1      
 397   1          /* IMO - restore enable state if needed */
 398   1          if((CY_PM_ENABLED == cyPmBackup.imoEnable) &&
 399   1                  (0u == (CY_PM_ACT_CFG0_IMO & CY_PM_ACT_CFG0_REG)))
 400   1          {
 401   2              /* IMO - restore enabled state */
 402   2              CyIMO_Start(CY_PM_WAIT_IMO);
 403   2          }    /* Do nothing if saved and actual values are equal */
 404   1      
 405   1          /* IMO - restore enable state if needed */
 406   1          if((CY_PM_ENABLED != cyPmBackup.imoEnable) &&
 407   1                  (0u != (CY_PM_ACT_CFG0_IMO & CY_PM_ACT_CFG0_REG)))
 408   1          {
 409   2              /* IMO - restore disabled state */
 410   2              CyIMO_Stop();
 411   2          }    /* Do nothing if saved and actual values are equal */
 412   1      
 413   1          /* IMO - restore IMOCLK source */
 414   1          CyIMO_SetSource(cyPmBackup.imoClkSrc);
 415   1      
 416   1          /* Restore IMO doubler enable state */
 417   1          if(CY_PM_ENABLED == cyPmBackup.imo2x)
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 8   

 418   1          {
 419   2              /* IMO doubler - enable */
 420   2              CyIMO_EnableDoubler();
 421   2          }
 422   1          else
 423   1          {
 424   2              /* IMO doubler - disable */
 425   2              CyIMO_DisableDoubler();
 426   2          }
 427   1      
 428   1          /* IMO - restore clk_imo source, if needed */
 429   1          if(cyPmBackup.clkImoSrc != (CY_PM_CLKDIST_CR_REG & CY_PM_CLKDIST_IMO_OUT_MASK))
 430   1          {
 431   2              CY_PM_CLKDIST_CR_REG = (CY_PM_CLKDIST_CR_REG & ~CY_PM_CLKDIST_IMO_OUT_MASK) |
 432   2                                  cyPmBackup.clkImoSrc;
 433   2          }    /* Do nothing if saved and actual values are equal */
 434   1      
 435   1          if(CY_PM_MASTER_CLK_SRC_IMO == cyPmBackup.masterClkSrc)
 436   1          {
 437   2              /* The IMO is ready to be source for Master clock */
 438   2              if(CY_PM_CLKDIST_MSTR0_REG != cyPmBackup.clkSyncDiv)
 439   2              {
 440   3                  /* Restore Master clock divider */
 441   3                  CyMasterClk_SetDivider(cyPmBackup.clkSyncDiv);
 442   3              }
 443   2              
 444   2              /* Restore Master clock source */
 445   2              CyMasterClk_SetSource(cyPmBackup.masterClkSrc);
 446   2              
 447   2          }   /* End of (CY_PM_MASTER_CLK_SRC_IMO == cyPmBackup.masterClkSrc) */
 448   1      
 449   1          /* Bus clock - restore divider, if needed */
 450   1          if(cyPmBackup.clkBusDiv != (((uint16) CY_PM_CLK_BUS_MSB_DIV_REG << 8u) | CY_PM_CLK_BUS_LSB_DIV_REG))
 451   1          {
 452   2              CyBusClk_SetDivider(cyPmBackup.clkBusDiv);
 453   2          }
 454   1          
 455   1          /* Restore flash wait cycles */
 456   1          CY_PM_CACHE_CR_REG = ((CY_PM_CACHE_CR_REG & ~CY_PM_CACHE_CR_CYCLES_MASK) |
 457   1                                  cyPmBackup.flashWaitCycles);
 458   1      
 459   1          /* Digital and analog clocks - restore state */
 460   1          CY_PM_ACT_CFG1_REG = cyPmBackup.enClkA;
 461   1          CY_PM_ACT_CFG2_REG = cyPmBackup.enClkD;
 462   1      }
 463          
 464          
 465          /*******************************************************************************
 466          * Function Name: CyPmAltAct
 467          ********************************************************************************
 468          *
 469          * Summary:
 470          *  Puts the part into the Alternate Active (Standby) state.  Before switching to
 471          *  Alternate Active, if a wakeupTime other than NONE is specified, then the
 472          *  appropriate timer state is configured as specified with the interrupt for
 473          *  that timer disabled.  The wakeup source will be the combination of the values
 474          *  specified in the wakeupSource and any timer specified in the wakeupTime
 475          *  argument.  Once the wakeup condition is satisfied, then all saved state is
 476          *  restored and the function returns in the Active state.
 477          *
 478          *  Note that if the wakeupTime is made with a different value, the period before
 479          *  the wakeup occurs can be significantly shorter than the specified time.  If
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 9   

 480          *  the next call is made with the same wakeupTime value, then the wakeup will
 481          *  occur the specified period after the previous wakeup occurred.
 482          *
 483          *  If a wakeupTime other than NONE is specified, then upon exit the state of the
 484          *  specified timer will be left as specified by wakeupTime with the timer
 485          *  enabled and the interrupt disabled.  If the CTW, FTW or One PPS is already
 486          *  configured for wakeup, for example with the SleepTimer or RTC components,
 487          *  then specify NONE for the wakeupTime and include the appropriate source for
 488          *  wakeupSource. 
 489          *
 490          *  The Alternate Active state can allow for any of the capabilities of the
 491          *  device to be active, but the operation of this function is dependent on the
 492          *  CPU being disabled during the Alternate Active state.  The configuration code
 493          *  and the component APIs will configure the template for the Alternate Active
 494          *  state to be the same as the Active state with the exception that the CPU will
 495          *  be disabled during Alternate Active.
 496          *
 497          * Parameters:
 498          *  wakeupTime: Specifies a timer wakeup source and the frequency of that
 499          *               source.
 500          *
 501          *           Define                      Time
 502          *  PM_ALT_ACT_TIME_NONE             None
 503          *  PM_ALT_ACT_TIME_ONE_PPS          One PPS: 1 second
 504          *  PM_ALT_ACT_TIME_CTW_2MS          CTW: 2 ms
 505          *  PM_ALT_ACT_TIME_CTW_4MS          CTW: 4 ms
 506          *  PM_ALT_ACT_TIME_CTW_8MS          CTW: 8 ms
 507          *  PM_ALT_ACT_TIME_CTW_16MS         CTW: 16 ms
 508          *  PM_ALT_ACT_TIME_CTW_32MS         CTW: 32 ms
 509          *  PM_ALT_ACT_TIME_CTW_64MS         CTW: 64 ms
 510          *  PM_ALT_ACT_TIME_CTW_128MS        CTW: 128 ms
 511          *  PM_ALT_ACT_TIME_CTW_256MS        CTW: 256 ms
 512          *  PM_ALT_ACT_TIME_CTW_512MS        CTW: 512 ms
 513          *  PM_ALT_ACT_TIME_CTW_1024MS       CTW: 1024 ms
 514          *  PM_ALT_ACT_TIME_CTW_2048MS       CTW: 2048 ms
 515          *  PM_ALT_ACT_TIME_CTW_4096MS       CTW: 4096 ms
 516          *  PM_ALT_ACT_TIME_FTW(1-256)*       FTW: 10us to 2.56ms
 517          *
 518          *  *Note:   PM_ALT_ACT_TIME_FTW() is a macro that takes an argument that
 519          *           specifies how many increments of 10us to delay. For PSoC 3 ES2
 520          *           silicon and earlier and PSoC 5 ES1 silicon and earlier the valid
 521          *           range of values is 1 to 32. For later silicon the valid range of
 522          *           values is 1 to 256.
 523          *
 524          *  wakeUpSource:    Specifies a bitwise mask of wakeup sources. In addition, if
 525          *                   a wakeupTime has been specified the associated timer will be
 526          *                   included as a wakeup source.
 527          *
 528          *           Define                      Source
 529          *  PM_ALT_ACT_SRC_NONE              None
 530          *  PM_ALT_ACT_SRC_COMPARATOR0       Comparator 0
 531          *  PM_ALT_ACT_SRC_COMPARATOR1       Comparator 1
 532          *  PM_ALT_ACT_SRC_COMPARATOR2       Comparator 2
 533          *  PM_ALT_ACT_SRC_COMPARATOR3       Comparator 3
 534          *  PM_ALT_ACT_SRC_INTERRUPT         Interrupt
 535          *  PM_ALT_ACT_SRC_PICU              PICU
 536          *  PM_ALT_ACT_SRC_I2C               I2C
 537          *  PM_ALT_ACT_SRC_BOOSTCONVERTER    Boost Converter
 538          *  PM_ALT_ACT_SRC_FTW               Fast Timewheel
 539          *  PM_ALT_ACT_SRC_CTW               Central Timewheel*
 540          *  PM_ALT_ACT_SRC_ONE_PPS           One PPS*
 541          *  PM_ALT_ACT_SRC_LCD               LCD
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 10  

 542          *
 543          *  *Note: CTW and One PPS wakeup signals are in the same mask bit. For
 544          *         PSoC 5 ES1 these are also the same address as the FTW.
 545          *
 546          *  When specifying a Comparator as the wakeupSource an instance specific define
 547          *  should be used that will track with the specific comparator that the instance
 548          *  is placed into. As an example, for a Comparator instance named ?MyComp? the
 549          *  value to OR into the mask is: MyComp_ctComp__CMP_MASK.
 550          *
 551          * Return:
 552          *  None.
 553          *
 554          * Reentrant:
 555          *  No.
 556          *
 557          * Side Effects:
 558          *  For PSoC 3 ES2 silcon or earlier the wakeup source is not selectable. In this
 559          *  case the wakeupSource argument is ignored and any of the available wakeup
 560          *  sources will wake the device.
 561          *
 562          *  For PSoC 5 ES1 silicon or earlier the LCD is not a selectable wakeup source.
 563          *
 564          *  If a wakeupTime other than NONE is specified, then upon exit the state of the
 565          *  specified timer will be left as specified by wakeupTime with the timer
 566          *  enabled and the interrupt disabled.  Also, ILO power mode will be left in a
 567          *  low power mode, the ILO 1 KHz (if CTW timer is used as wake up time) or
 568          *  ILO 100 KHz (if FTW timer is used as wake up time) will be left started.
 569          *
 570          *******************************************************************************/
 571          void CyPmAltAct(uint16 wakeupTime, uint16 wakeupSource)
 572          {
 573   1          /* FTW - save current and set new configuration */
 574   1          if((wakeupTime >= PM_ALT_ACT_TIME_FTW(1u)) && (wakeupTime <= PM_ALT_ACT_TIME_FTW(256u)))
 575   1          {
 576   2              /* Device is PSoC 3 and the revision is ES2 or earlier, or
 577   2              *  device is PSoC 5 and the revision is ES1 or earlier.
 578   2              */
 579   2              #if(CY_PM_PSOC3_ES2 || CY_PM_PSOC5_ES1)
                      
                          /* If out of range - set to max value */
                          if(wakeupTime >= PM_ALT_ACT_TIME_FTW(32u))
                          {
                                              /* Save FTW configuration and set new one to max value */
                              CyPmFtwSaveSet((PM_ALT_ACT_TIME_FTW(32u) - CY_PM_FTW_INTERVAL_SHIFT - 1u) & CY_PM_FTW_INTE
             -RVAL_MASK);
                          }
                          else    /* value is in range - just pass parameter as is */
                          {
                              /* Save current FTW configuration and set new one */
                              CyPmFtwSaveSet((wakeupTime - CY_PM_FTW_INTERVAL_SHIFT - 1u) & CY_PM_FTW_INTERVAL_MASK);
                          }
                      
                      /* Device is PSoC 3 and the revision is ES3 or later, or
                      *  device is PSoC 5 and the revision is ES2 or later.
                      */
                      #else
 597   2      
 598   2                  /* Save current FTW configuration and set new one */
 599   2                  CyPmFtwSaveSet((wakeupTime - CY_PM_FTW_INTERVAL_SHIFT - 1u) & CY_PM_FTW_INTERVAL_MASK);
 600   2              
 601   2              #endif  /* End of (CY_PM_PSOC3_ES2 || CY_PM_PSOC5_ES1) */
 602   2              
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 11  

 603   2              /* Include associated timer to the wakeupSource */
 604   2              wakeupSource |= PM_ALT_ACT_SRC_FTW;
 605   2          }
 606   1      
 607   1          /* CTW - save current and set new configuration */
 608   1          if((wakeupTime >= PM_ALT_ACT_TIME_CTW_2MS) && (wakeupTime <= PM_ALT_ACT_TIME_CTW_4096MS))
 609   1          {
 610   2              /* Save current CTW configuration and set new one */
 611   2              CyPmCtwSaveSet((wakeupTime - 1u) & CY_PM_CTW_INTERVAL_MASK);
 612   2      
 613   2              /* Include associated timer to the wakeupSource */
 614   2              wakeupSource |= PM_ALT_ACT_SRC_CTW;
 615   2          }
 616   1      
 617   1          /* 1PPS - save current and set new configuration */
 618   1          if(PM_ALT_ACT_TIME_ONE_PPS == wakeupTime)
 619   1          {
 620   2              /* Save current 1PPS configuration and set new one */
 621   2              CyPmOppsSaveSet();
 622   2      
 623   2              /* Include associated timer to the wakeupSource */
 624   2              wakeupSource |= PM_ALT_ACT_SRC_ONE_PPS;
 625   2          }
 626   1      
 627   1      
 628   1          /* Device is PSoC 3 and the revision is ES3 or later, or
 629   1          *  device is PSoC 5 and the revision is ES1 or earlier.
 630   1          */
 631   1          #if(CY_PM_PSOC3_ES3 || CY_PM_PSOC5_ES1)
 632   1              
 633   1              /* Save and set new wake up configuration */
 634   1      
 635   1              /* Interrupt, PICU, I2C, Boost converter, CTW/1PPS */
 636   1              cyPmBackup.wakeupCfg0 = CY_PM_WAKEUP_CFG0_REG;
 637   1              CY_PM_WAKEUP_CFG0_REG = ((uint8) ((wakeupSource >> 4u) & 0xFFu));
 638   1      
 639   1              /* Comparators */
 640   1              cyPmBackup.wakeupCfg1 = CY_PM_WAKEUP_CFG1_REG;
 641   1              CY_PM_WAKEUP_CFG1_REG = (((uint8) wakeupSource) & CY_PM_WAKEUP_SRC_CMPS_MASK);
 642   1      
 643   1              /* Device is PSoC 3 and the revision is ES3 or later */
 644   1              #if(CY_PM_PSOC3_ES3)
 645   1      
 646   1                  /* LCD */
 647   1                  cyPmBackup.wakeupCfg2 = CY_PM_WAKEUP_CFG2_REG;
 648   1                  CY_PM_WAKEUP_CFG2_REG = ((uint8) ((wakeupSource >> 12u) & 0x01u));
 649   1      
 650   1              #endif  /* End of (CY_PM_PSOC3_ES3) */
 651   1          
 652   1          /* Device is PSoC 3 and the revision is ES2 or earlier, or
 653   1          *  device is PSoC 5 and the revision is ES2 or later.
 654   1          */
 655   1          #else
              
                      /* To remove unreferenced local variable warning */
                      wakeupSource++;
              
                  #endif /* End of (CY_PM_PSOC3_ES3 || CY_PM_PSOC5_ES1) */
 661   1      
 662   1          /* Device is PSoC 3 and the revision is ES3 or later */
 663   1          #if(CY_PM_PSOC3_ES3)
 664   1      
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 12  

 665   1              /* Save current global interrupt enable and disable it,
 666   1              *  this should be done only if clk_bus is disabled during
 667   1              *  Alternate Active mode. By default, clk_bus is enabled
 668   1              *  during this mode, but user is able to disable it manually,
 669   1              *  so implement this workaround for sure.
 670   1              */
 671   1              cyPmBackup.interruptEnable = CyEnterCriticalSection();
 672   1      
 673   1          #endif  /* End of (CY_PM_PSOC3_ES3)*/
 674   1      
 675   1          /* Switch to the Sleep mode */
 676   1          CY_PM_MODE_CSR_REG = ((CY_PM_MODE_CSR_REG & ~CY_PM_MODE_CSR_MASK) | CY_PM_MODE_CSR_ALT_ACT);
 677   1      
 678   1          /* Recommended readback. */
 679   1          CY_PM_MODE_CSR_REG;
 680   1      
 681   1          /* Two recommended NOPs to get into the mode. */
 682   1          CY_NOP;
 683   1          CY_NOP;
 684   1      
 685   1          /* Device is PSoC 5 */
 686   1          #if(CY_PM_PSOC5_ES1 || CY_PM_PSOC5_ES2)
              
                      /* PSoC3 and PSoC5 has different low power modes entry way */
              
                      #if defined(__ARMCC_VERSION)
              
                          /* Instristic for Keil compilers */
                          __wfi();
              
                      #else
              
                          /* ASM for GCC */
                          asm volatile ("WFI \n");
              
                      #endif /* End of (__ARMCC_VERSION) */
              
                  #endif /* End of (CY_PM_PSOC5_ES1 || CY_PM_PSOC5_ES2) */
 703   1          
 704   1          /* Point of return from Alternate Active Mode */
 705   1      
 706   1          /* Device is PSoC 3 and the revision is ES3 or later */
 707   1          #if(CY_PM_PSOC3_ES3)
 708   1          
 709   1              /* Restore global interrupt enable state */
 710   1              CyExitCriticalSection(cyPmBackup.interruptEnable);
 711   1          
 712   1          #endif  /* End of (CY_PM_PSOC3_ES3)*/
 713   1      
 714   1          /* Device is PSoC 3 and the revision is ES3 or later, or
 715   1          *  device is PSoC 5 and the revision is ES1 or earlier.
 716   1          */
 717   1          #if(CY_PM_PSOC3_ES3 || CY_PM_PSOC5_ES1)
 718   1      
 719   1              /* Wake up source configuration */
 720   1      
 721   1              /* Restore current wake up configuration */
 722   1              CY_PM_WAKEUP_CFG0_REG = cyPmBackup.wakeupCfg0;
 723   1              CY_PM_WAKEUP_CFG1_REG = cyPmBackup.wakeupCfg1;
 724   1      
 725   1              /* Device is PSoC 3 and the revision is ES3 or later */
 726   1              #if(CY_PM_PSOC3_ES3)
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 13  

 727   1      
 728   1                  CY_PM_WAKEUP_CFG2_REG = cyPmBackup.wakeupCfg2;
 729   1      
 730   1              #endif  /* End of (CY_PM_PSOC3_ES3) */
 731   1      
 732   1          #endif /* End of (CY_PM_PSOC3_ES3 || CY_PM_PSOC5_ES1) */
 733   1      }
 734          
 735          
 736          /*******************************************************************************
 737          * Function Name: CyPmSleep
 738          ********************************************************************************
 739          *
 740          * Summary:
 741          *  Puts the part into the Sleep state.  Before switching to Sleep, if a
 742          *  wakeupTime other than NONE is specified, then the appropriate timer state is
 743          *  configured as specified with the interrupt for that timer disabled.  The
 744          *  wakeup source will be the combination of the values specified in the
 745          *  wakeupSource and any timer specified in the wakeupTime argument.  Once the
 746          *  wakeup condition is satisfied, then all saved state is restored and the
 747          *  function returns in the Active state.
 748          *
 749          *  Note that if the wakeupTime is made with a different value, the period before
 750          *  the wakeup occurs can be significantly shorter than the specified time.  If
 751          *  the next call is made with the same wakeupTime value, then the wakeup will
 752          *  occur the specified period after the previous wakeup occurred.
 753          *
 754          *  If a wakeupTime other than NONE is specified, then upon exit the state of the
 755          *  specified timer will be left as specified by wakeupTime with the timer
 756          *  enabled and the interrupt disabled.  If the CTW or One PPS is already
 757          *  configured for wakeup, for example with the SleepTimer or RTC components,
 758          *  then specify NONE for the wakeupTime and include the appropriate source for
 759          *  wakeupSource. 
 760          *
 761          * Parameters:
 762          *  wakeupTime:      Specifies a timer wakeup source and the frequency of that
 763          *                   source.
 764          *
 765          *           Define                      Time
 766          *  PM_SLEEP_TIME_NONE               None
 767          *  PM_SLEEP_TIME_ONE_PPS            One PPS: 1 second
 768          *  PM_SLEEP_TIME_CTW_2MS            CTW: 2 ms
 769          *  PM_SLEEP_TIME_CTW_4MS            CTW: 4 ms
 770          *  PM_SLEEP_TIME_CTW_8MS            CTW: 8 ms
 771          *  PM_SLEEP_TIME_CTW_16MS           CTW: 16 ms
 772          *  PM_SLEEP_TIME_CTW_32MS           CTW: 32 ms
 773          *  PM_SLEEP_TIME_CTW_64MS           CTW: 64 ms
 774          *  PM_SLEEP_TIME_CTW_128MS          CTW: 128 ms
 775          *  PM_SLEEP_TIME_CTW_256MS          CTW: 256 ms
 776          *  PM_SLEEP_TIME_CTW_512MS          CTW: 512 ms
 777          *  PM_SLEEP_TIME_CTW_1024MS         CTW: 1024 ms
 778          *  PM_SLEEP_TIME_CTW_2048MS         CTW: 2048 ms
 779          *  PM_SLEEP_TIME_CTW_4096MS         CTW: 4096 ms
 780          *
 781          *  wakeUpSource:    Specifies a bitwise mask of wakeup sources. In addition, if
 782          *                   a wakeupTime has been specified the associated timer will be
 783          *                   included as a wakeup source.
 784          *
 785          *           Define                      Source
 786          *  PM_SLEEP_SRC_NONE                None
 787          *  PM_SLEEP_SRC_COMPARATOR0         Comparator 0
 788          *  PM_SLEEP_SRC_COMPARATOR1         Comparator 1
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 14  

 789          *  PM_SLEEP_SRC_COMPARATOR2         Comparator 2
 790          *  PM_SLEEP_SRC_COMPARATOR3         Comparator 3
 791          *  PM_SLEEP_SRC_PICU                PICU
 792          *  PM_SLEEP_SRC_I2C                 I2C
 793          *  PM_SLEEP_SRC_BOOSTCONVERTER      Boost Converter
 794          *  PM_SLEEP_SRC_CTW                 Central Timewheel*
 795          *  PM_SLEEP_SRC_ONE_PPS             One PPS*
 796          *  PM_SLEEP_SRC_LCD                 LCD
 797          *
 798          *  *Note:   CTW and One PPS wakeup signals are in the same mask bit. For
 799          *           PSoC 5 ES1 these are in a different bit.
 800          *
 801          *  When specifying a Comparator as the wakeupSource an instance specific define
 802          *  should be used that will track with the specific comparator that the instance
 803          *  is placed into. As an example for a Comparator instance named ?MyComp? the
 804          *  value to OR into the mask is: MyComp_ctComp__CMP_MASK.
 805          *
 806          * Return:
 807          *  None.
 808          *
 809          * Reentrant:
 810          *  No.
 811          *
 812          * Side Effects:
 813          *  For PSoC 3 ES2 silcon or earlier the wakeup source is not selectable. In this
 814          *  case the wakeupSource argument is ignored and any of the available wakeup
 815          *  sources will wake the device.
 816          *
 817          *  For PSoC 5 ES1 silicon or earlier the LCD is not a selectable wakeup source.
 818          *
 819          *  If a wakeupTime other than NONE is specified, then upon exit the state of the
 820          *  specified timer will be left as specified by wakeupTime with the timer
 821          *  enabled and the interrupt disabled.  Also, ILO power mode will be left in a
 822          *  low power mode, the ILO 1 KHz (if CTW timer is used as wake up time) will be
 823          *  left started.
 824          *
 825          *  Note: PSoC 3 ES2 and PSoC 5 ES1 silicon have a defect that causes connections
 826          *  to several analog resources to be unreliable when the device is placed in a
 827          *  low power mode. See the silicon errata for details.
 828          *
 829          *  Be aware of potential silent failures when using CyPmSleep().
 830          *
 831          *******************************************************************************/
 832          void CyPmSleep(uint8 wakeupTime, uint16 wakeupSource)
 833          {
 834   1          /* Device is PSoC 3 and the revision is ES3 or later */
 835   1          #if(CY_PM_PSOC3_ES3)
 836   1      
 837   1              /* Hibernate/Sleep regulator stabilization */
 838   1              if(0u == (CY_PM_MODE_CSR_REG & CY_PM_MODE_CSR_PWRUP_PULSE_Q))
 839   1              {
 840   2                  /* Disable hold off - no action on restore */
 841   2                  CY_PM_PWRSYS_SLP_TR_REG &= CY_PM_PWRSYS_SLP_TR_HIBSLP_HOLDOFF_MASK;    
 842   2              }
 843   1              else
 844   1              {
 845   2                  /* Abort, device is not ready for low power mode entry */
 846   2                  return;
 847   2              }
 848   1      
 849   1          #endif /* End of (CY_PM_PSOC3_ES3) */
 850   1          
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 15  

 851   1          /* CTW - save current and set new configuration */
 852   1          if((wakeupTime >= PM_SLEEP_TIME_CTW_2MS) && (wakeupTime <= PM_SLEEP_TIME_CTW_4096MS))
 853   1          {
 854   2              /* Save current and set new configuration of the CTW */
 855   2              CyPmCtwSaveSet((wakeupTime - 1u) & CY_PM_CTW_INTERVAL_MASK);
 856   2      
 857   2              /* Include associated timer to the wakeupSource */
 858   2              wakeupSource |= PM_SLEEP_SRC_CTW;
 859   2          }
 860   1          
 861   1          /* 1PPS - save current and set new configuration */
 862   1          if(PM_SLEEP_TIME_ONE_PPS == wakeupTime)
 863   1          {
 864   2              /* Save current and set new configuration of the 1PPS */
 865   2              CyPmOppsSaveSet();
 866   2              
 867   2              /* Include associated timer to the wakeupSource */
 868   2              wakeupSource |= PM_SLEEP_SRC_ONE_PPS;
 869   2          }
 870   1      
 871   1          /* Device is PSoC 3 and the revision is ES3 or later, or
 872   1          *  device is PSoC 5 and the revision is ES1 or earlier.
 873   1          */
 874   1          #if(CY_PM_PSOC3_ES3 || CY_PM_PSOC5_ES1)
 875   1      
 876   1              /* Save and set new wake up configuration */
 877   1      
 878   1              /* Interrupt, PICU, I2C, Boost converter, CTW/1PPS */
 879   1              cyPmBackup.wakeupCfg0 = CY_PM_WAKEUP_CFG0_REG;
 880   1              CY_PM_WAKEUP_CFG0_REG = ((uint8) ((wakeupSource >> 4u) & 0xFFu));
 881   1      
 882   1              /* Comparators */
 883   1              cyPmBackup.wakeupCfg1 = CY_PM_WAKEUP_CFG1_REG;
 884   1              CY_PM_WAKEUP_CFG1_REG = (((uint8) wakeupSource) & CY_PM_WAKEUP_SRC_CMPS_MASK);
 885   1      
 886   1              /* Device is PSoC 3 and the revision is ES3 or later */
 887   1              #if(CY_PM_PSOC3_ES3)
 888   1      
 889   1                  /* LCD */
 890   1                  cyPmBackup.wakeupCfg2 = CY_PM_WAKEUP_CFG2_REG;
 891   1                  CY_PM_WAKEUP_CFG2_REG = ((uint8) ((wakeupSource >> 12u) & 0x01u));
 892   1      
 893   1              #endif  /* End of (CY_PM_PSOC3_ES3) */
 894   1          
 895   1          /* Device is PSoC 3 and the revision is ES2 or earlier, or
 896   1          *  device is PSoC 5 and the revision is ES2 or later.
 897   1          */
 898   1          #else
              
                      /* To remove unreferenced local variable warning */
                      wakeupSource++;
              
                  #endif /* End of (CY_PM_PSOC3_ES3 || CY_PM_PSOC5_ES1) */
 904   1      
 905   1          /* Tune LVI/HVI and wait for Hibernate/Sleep regulator to stabilize */
 906   1          CyPmHibSlpSaveSet(CY_PM_MODE_CSR_SLEEP);
 907   1      
 908   1          /* Device is PSoC 3 and the revision is ES3 or later */
 909   1          #if(CY_PM_PSOC3_ES3)
 910   1      
 911   1              /* Save current global interrupt enable and disable it */
 912   1              cyPmBackup.interruptEnable = CyEnterCriticalSection();
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 16  

 913   1      
 914   1              /* Disable LDO-A regulator prior to entering sleep when buzzing is needed */
 915   1              if(CY_PM_PWRSYS_WAKE_TR2_EN_BUZZ == CY_PM_PWRSYS_WAKE_TR2_REG & CY_PM_PWRSYS_WAKE_TR2_EN_BUZZ)
 916   1              {
 917   2                  /* Prepares for disabling LDO-A by moving bandgap reference to VCCD */
 918   2                  CY_PM_PWRSYS_CR1_REG = CY_PM_PWRSYS_CR1_LDOA_ISO | (CY_PM_PWRSYS_CR1_REG & ~CY_PM_PWRSYS_CR1_L
             -DOA_DIS);
 919   2              
 920   2                  /* Disables LDO-A */
 921   2                  CY_PM_PWRSYS_CR1_REG |= CY_PM_PWRSYS_CR1_LDOA_DIS;
 922   2              }
 923   1      
 924   1          #endif  /* End of (CY_PM_PSOC3_ES3)*/
 925   1      
 926   1          /* Switch to the Sleep mode */
 927   1          CY_PM_MODE_CSR_REG = ((CY_PM_MODE_CSR_REG & ~CY_PM_MODE_CSR_MASK) | CY_PM_MODE_CSR_SLEEP);
 928   1      
 929   1          /* Recommended readback. */
 930   1          CY_PM_MODE_CSR_REG;
 931   1      
 932   1          /* Two recommended NOPs to get into the mode. */
 933   1          CY_NOP;
 934   1          CY_NOP;
 935   1      
 936   1          /* Device is PSoC 5 */
 937   1          #if(CY_PM_PSOC5_ES1 || CY_PM_PSOC5_ES2)
              
                      /* PSoC3 and PSoC5 has different low power modes entry way */
              
                      #if defined(__ARMCC_VERSION)
              
                          /* Instristic for Keil compilers */
                          __wfi();
              
                      #else
              
                          /* ASM for GCC */
                          asm volatile ("WFI \n");
              
                      #endif /* End of (__ARMCC_VERSION) */
              
                  #endif /* End of (CY_PM_PSOC5_ES1 || CY_PM_PSOC5_ES2) */
 954   1      
 955   1          /* Point of return from Sleep Mode */
 956   1      
 957   1          /* Gives the sleep regulator time to stabilize (20us) */
 958   1          CyDelayCycles(CY_PM_WAIT_20_US * cyPmBackup.cpuFreqMhz); 
 959   1      
 960   1          /* Device is PSoC 3 and the revision is ES3 or later */
 961   1          #if(CY_PM_PSOC3_ES3)
 962   1      
 963   1              /* Re-enable LDO-A after waking up from sleep when buzzing is needed */
 964   1              if(CY_PM_PWRSYS_WAKE_TR2_EN_BUZZ == CY_PM_PWRSYS_WAKE_TR2_REG & CY_PM_PWRSYS_WAKE_TR2_EN_BUZZ)
 965   1              {
 966   2                  /* Enable LDO-A */
 967   2                  CY_PM_PWRSYS_CR1_REG &= ~CY_PM_PWRSYS_CR1_LDOA_DIS;
 968   2                  
 969   2                  /* Stop preparing the system to disable the LDO-A */
 970   2                  CY_PM_PWRSYS_CR1_REG &= ~CY_PM_PWRSYS_CR1_LDOA_ISO;
 971   2              }
 972   1      
 973   1              /* Restore global interrupt enable state */
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 17  

 974   1              CyExitCriticalSection(cyPmBackup.interruptEnable);
 975   1          
 976   1          #endif  /* End of (CY_PM_PSOC3_ES3)*/
 977   1      
 978   1          /* Restore LVI/HVI configuration */
 979   1          CyPmHibSlpRestore();
 980   1      
 981   1          /* Device is PSoC 3 and the revision is ES3 or later, or
 982   1          *  device is PSoC 5 and the revision is ES2 or later.
 983   1          */
 984   1          #if(CY_PM_PSOC3_ES3 || CY_PM_PSOC5_ES2)
 985   1      
 986   1              /* Wake up source configuration */
 987   1      
 988   1              /* Restore current wake up configuration */
 989   1              CY_PM_WAKEUP_CFG0_REG = cyPmBackup.wakeupCfg0;
 990   1              CY_PM_WAKEUP_CFG1_REG = cyPmBackup.wakeupCfg1;
 991   1      
 992   1              /* Device is PSoC 3 and the revision is ES3 or later */
 993   1              #if(CY_PM_PSOC3_ES3)
 994   1      
 995   1                  CY_PM_WAKEUP_CFG2_REG = cyPmBackup.wakeupCfg2;
 996   1      
 997   1              #endif  /* End of (CY_PM_PSOC3_ES3) */
 998   1      
 999   1          #endif /* End of (CY_PM_PSOC3_ES3 || CY_PM_PSOC5_ES2) */
1000   1      }
1001          
1002          
1003          /*******************************************************************************
1004          * Function Name: CyPmHibernate
1005          ********************************************************************************
1006          *
1007          * Summary:
1008          *  Puts the part into the Hibernate state. Before switching to Hibernate the
1009          *  PICU wakeup source bit is saved and then set. The PICU is the only available
1010          *  source to wakeup from the Hibernate state. Once the wakeup condition is
1011          *  satisfied, then the PICU wakeup source bit is restored and the function
1012          *  returns in the Active state.
1013          *
1014          *  There is a firmware requirement that specifies applications cannot wakeup
1015          *  from hibernate and enter sleep for 20 us. The time starts from the wakeup
1016          *  event and gives the sleep regulator time to stabilize. There is no hardware
1017          *  check that this requirement is met. The specified delay should be done on
1018          *  ISR entry.
1019          *
1020          * Parameters:
1021          *  None.
1022          *
1023          * Return:
1024          *  None.
1025          *
1026          * Reentrant:
1027          *  No.
1028          *
1029          * Side Effects:
1030          *  None.
1031          *
1032          *  Note: PSoC 3 ES2 and PSoC 5 ES1 silicon have a defect that causes connections
1033          *  to several analog resources to be unreliable when the device is placed in a
1034          *  low power mode. See the silicon errata for details.
1035          *
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 18  

1036          *  Be aware of potential silent failures when using CyPmHibernate().
1037          *
1038          *******************************************************************************/
1039          void CyPmHibernate(void)
1040          {
1041   1          /* Device is PSoC 3 and the revision is ES3 or later */
1042   1          #if(CY_PM_PSOC3_ES3)
1043   1      
1044   1              /* Hibernate/Sleep regulator stabilization */
1045   1              if(0u == (CY_PM_MODE_CSR_REG & CY_PM_MODE_CSR_PWRUP_PULSE_Q))
1046   1              {
1047   2                  /* Disable hold off - no action on restore */
1048   2                  CY_PM_PWRSYS_SLP_TR_REG &= CY_PM_PWRSYS_SLP_TR_HIBSLP_HOLDOFF_MASK;    
1049   2              }
1050   1              else
1051   1              {
1052   2                  /* Abort, device is not ready for low power mode entry */
1053   2                  /* This section will be redesign to be correct till Beta 5
1054   2                  *  when PSoC3/5 PM API files become device version specific.
1055   2                  */            
1056   2                  return;
1057   2              }
1058   1      
1059   1          #endif /* End of (CY_PM_PSOC3_ES3) */
1060   1          
1061   1          /* Prepare device for proper Hibernate mode entry */
1062   1          CyPmHibSaveSet();
1063   1      
1064   1          /* Device is PSoC 3 and the revision is ES3 or later, or
1065   1          *  device is PSoC 5 and the revision is ES1 or earlier.
1066   1          */
1067   1          #if(CY_PM_PSOC3_ES3 || CY_PM_PSOC5_ES1)
1068   1      
1069   1              /* Save and set new wake up configuration */
1070   1      
1071   1              /* Save and enable only wake up on PICU */
1072   1              cyPmBackup.wakeupCfg0 = CY_PM_WAKEUP_CFG0_REG;
1073   1              CY_PM_WAKEUP_CFG0_REG = CY_PM_WAKEUP_PICU;
1074   1      
1075   1              /* Comparators */
1076   1              cyPmBackup.wakeupCfg1 = CY_PM_WAKEUP_CFG1_REG;
1077   1              CY_PM_WAKEUP_CFG1_REG = 0x00u;
1078   1      
1079   1              /* Device is PSoC 3 and the revision is ES3 or later */
1080   1              #if(CY_PM_PSOC3_ES3)
1081   1      
1082   1                  /* LCD */
1083   1                  cyPmBackup.wakeupCfg2 = CY_PM_WAKEUP_CFG2_REG;
1084   1                  CY_PM_WAKEUP_CFG2_REG = 0x00u;
1085   1      
1086   1              #endif  /* End of (CY_PM_PSOC3_ES3) */
1087   1      
1088   1          #endif /* End of (CY_PM_PSOC3_ES3 || CY_PM_PSOC5_ES1) */
1089   1      
1090   1          /* Device is PSoC 3 and the revision is ES3 or later */
1091   1          #if(CY_PM_PSOC3_ES3)
1092   1      
1093   1              /* Save current global interrupt enable and disable it */
1094   1              cyPmBackup.interruptEnable = CyEnterCriticalSection();
1095   1      
1096   1          #endif  /* End of (CY_PM_PSOC3_ES3)*/
1097   1      
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 19  

1098   1          /* Switch to Hibernate Mode */
1099   1          CY_PM_MODE_CSR_REG = ((CY_PM_MODE_CSR_REG & ~CY_PM_MODE_CSR_MASK) | CY_PM_MODE_CSR_HIBERNATE);
1100   1      
1101   1          /* Recommended readback. */
1102   1          CY_PM_MODE_CSR_REG;
1103   1      
1104   1          /* Two recommended NOPs to get into the mode. */
1105   1          CY_NOP;
1106   1          CY_NOP;
1107   1      
1108   1          /* Device is PSoC 5 */
1109   1          #if(CY_PM_PSOC5_ES1 || CY_PM_PSOC5_ES2)
              
                      /* PSoC3 and PSoC5 has different low power modes entry way */
              
                      #if defined(__ARMCC_VERSION)
              
                          /* Instristic for Keil compilers */
                          __wfi();
              
                      #else
              
                          /* ASM for GCC */
                          asm volatile ("WFI \n");
              
                      #endif /* End of (__ARMCC_VERSION) */
              
                  #endif /* End of (CY_PM_PSOC5_ES1 || CY_PM_PSOC5_ES2) */
1126   1      
1127   1          /* Point of return from Hibernate mode */
1128   1      
1129   1          /* Device is PSoC 3 and the revision is ES3 or later */
1130   1          #if(CY_PM_PSOC3_ES3)
1131   1          
1132   1              /* Restore global interrupt enable state */
1133   1              CyExitCriticalSection(cyPmBackup.interruptEnable);
1134   1          
1135   1          #endif  /* End of (CY_PM_PSOC3_ES3)*/
1136   1      
1137   1          /* Restore device for proper Hibernate mode exit*/
1138   1          CyPmHibRestore();
1139   1      
1140   1          /* Device is PSoC 3 and the revision is ES3 or later, or
1141   1          *  device is PSoC 5 and the revision is ES2 or later.
1142   1          */
1143   1          #if(CY_PM_PSOC3_ES3 || CY_PM_PSOC5_ES2)
1144   1      
1145   1              /* Restore saved wake up configuration */
1146   1              CY_PM_WAKEUP_CFG0_REG = cyPmBackup.wakeupCfg0;
1147   1              CY_PM_WAKEUP_CFG1_REG = cyPmBackup.wakeupCfg1;
1148   1      
1149   1              /* Device is PSoC 3 and the revision is ES3 or later */
1150   1              #if(CY_PM_PSOC3_ES3)
1151   1      
1152   1                  CY_PM_WAKEUP_CFG2_REG = cyPmBackup.wakeupCfg2;
1153   1      
1154   1              #endif  /* End of (CY_PM_PSOC3_ES3) */
1155   1      
1156   1          #endif /* End of (CY_PM_PSOC3_ES3 || CY_PM_PSOC5_ES2) */
1157   1      }
1158          
1159          
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 20  

1160          /*******************************************************************************
1161          * Function Name: CyPMReadStatus
1162          ********************************************************************************
1163          *
1164          * Summary:
1165          *  Manages the Power Manager Interrupt Status Register.  This register has the
1166          *  interrupt status for the one pulse per second, central timewheel and fast
1167          *  timewheel timers.  This hardware register clears on read.  To allow for only
1168          *  clearing the bits of interest and preserving the other bits, this function
1169          *  uses a shadow register that retains the state.  This function reads the
1170          *  status register and ORs that value with the shadow register.  That is the
1171          *  value that is returned.  Then the bits in the mask that are set are cleared
1172          *  from this value and written back to the shadow register.
1173          *
1174          * Parameters:
1175          *  mask: Bits in the shadow register to clear.
1176          *
1177          *       Define                      Source
1178          *  CY_PM_FTW_INT                Fast Timewheel
1179          *  CY_PM_CTW_INT                Central Timewheel
1180          *  CY_PM_ONEPPS_INT             One Pulse Per Second
1181          *
1182          * Return:
1183          *  Status.  Same bits values as the mask parameter.
1184          *
1185          * Reentrant:
1186          *  No.
1187          *
1188          * Side Effects:
1189          *  None.
1190          *
1191          *******************************************************************************/
1192          uint8 CyPmReadStatus(uint8 mask)
1193          {
1194   1          static uint8 interruptStatus;
1195   1          uint8 interruptState;
1196   1          uint8 tmpStatus;
1197   1      
1198   1          /* Enter critical section */
1199   1          interruptState = CyEnterCriticalSection();
1200   1      
1201   1          /* Save value of the register, copy it and clear desired bit */
1202   1          interruptStatus |= CY_PM_INT_SR_REG;
1203   1          tmpStatus = interruptStatus;
1204   1          interruptStatus &= ~mask;
1205   1      
1206   1          /* Exit critical section */
1207   1          CyExitCriticalSection(interruptState);
1208   1      
1209   1          return(tmpStatus);
1210   1      }
1211          
1212          
1213          /*******************************************************************************
1214          * Function Name: CyPmHibSaveSet
1215          ********************************************************************************
1216          *
1217          * Summary:
1218          *  Prepare device for proper Hibernate low power mode entry: disable I2C backup
1219          *  regulator, save enable state of the 1 kHz and 100 kHz ILO and disable them.
1220          *  Save ILO power down mode state and enable it. Disable use_vccdclk_det.
1221          *
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 21  

1222          * Parameters:
1223          *  None.
1224          *
1225          * Return:
1226          *  None.
1227          *
1228          * Reentrant:
1229          *  No.
1230          *
1231          * Side Effects:
1232          *  None.
1233          *
1234          *******************************************************************************/
1235          void CyPmHibSaveSet(void)
1236          {
1237   1          /* I2C backup reg must be off when the sleep reg is unavailable */
1238   1          if(0u != (CY_PM_PWRSYS_CR1_REG & CY_PM_PWRSYS_CR1_I2CREG_BACKUP))
1239   1          {
1240   2              /* I2C backup reg is enabled, save enable state and disable */
1241   2              cyPmBackup.i2cRegBackup = CY_PM_ENABLED;
1242   2              CY_PM_PWRSYS_CR1_REG &= ~CY_PM_PWRSYS_CR1_I2CREG_BACKUP;
1243   2          }
1244   1          else
1245   1          {
1246   2              /* Save disabled state of the I2C backup regulator */
1247   2              cyPmBackup.i2cRegBackup = CY_PM_DISABLED;
1248   2          }
1249   1      
1250   1          /* Device is PSoC 3 and the revision is ES3 or later */
1251   1          #if(CY_PM_PSOC3_ES3)
1252   1      
1253   1              /* Save current ILO power mode and ensure low power mode */
1254   1              cyPmBackup.iloPowerMode = CyILO_SetPowerMode(CY_PM_POWERDOWN_MODE);
1255   1          
1256   1              /* Save current 1kHz ILO enable state. Disabled automatically. */
1257   1              cyPmBackup.ilo1kEnable = (0u != (CY_PM_SLOWCLK_ILO_CR0_REG & CY_PM_ILO_CR0_EN_1K)) ?
1258   1                                          CY_PM_ENABLED : CY_PM_DISABLED;
1259   1          
1260   1              /* Save current 100kHz ILO enable state. Disabled automatically. */
1261   1              cyPmBackup.ilo100kEnable = (0u != (CY_PM_SLOWCLK_ILO_CR0_REG & CY_PM_ILO_CR0_EN_100K)) ?
1262   1                                          CY_PM_ENABLED : CY_PM_DISABLED;
1263   1      
1264   1          #endif  /* End of (CY_PM_PSOC3_ES3) */
1265   1      
1266   1          /* Device is PSoC 3 and the revision is ES3 or later */
1267   1          #if(CY_PM_PSOC3_ES3)
1268   1      
1269   1                  if(0u == (CY_PM_PWRSYS_SLP_TR_REG & CY_PM_PWRSYS_SLP_TR_BYPASS))
1270   1                  {
1271   2                      /* Save current bypass state */
1272   2                      cyPmBackup.slpTrBypass = CY_PM_DISABLED;
1273   2              
1274   2                      /* When set, disables the sleep regulator and shorts vccd to vpwrsleep */
1275   2                      CY_PM_PWRSYS_SLP_TR_REG |= CY_PM_PWRSYS_SLP_TR_BYPASS;
1276   2                  }
1277   1                  else
1278   1                  {
1279   2                      /* Save current bypass state */
1280   2                      cyPmBackup.slpTrBypass = CY_PM_ENABLED;
1281   2                  }
1282   1      
1283   1              #endif  /* End of (CY_PM_PSOC3_ES3) */
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 22  

1284   1      
1285   1      
1286   1          /* Device is PSoC 3 and the revision is ES3 or later */
1287   1          #if(CY_PM_PSOC3_ES3)
1288   1      
1289   1              /* Only affects when BOTH ext_vccd=1 and ext_vcca=1 */
1290   1              if((0u != (CY_PM_PWRSYS_CR0_REG & CY_PM_PWRSYS_CR0_EXT_VCCA)) &&
1291   1              (0u != (CY_PM_PWRSYS_CR0_REG & CY_PM_PWRSYS_CR0_EXT_VCCD)))
1292   1              {
1293   2      
1294   2                  if(0u != CY_PM_PWRSYS_WAKE_TR2_REG & CY_PM_PWRSYS_WAKE_TR2_VCCD_CLK_DET)
1295   2                  {
1296   3                      /* Save alternate powergood detector state */
1297   3                      cyPmBackup.vccdClkDet = CY_PM_ENABLED;
1298   3      
1299   3                      /* Enable LPCOMPs (slower) instead of faster powergood detector */
1300   3                      CY_PM_PWRSYS_WAKE_TR2_REG &= ~CY_PM_PWRSYS_WAKE_TR2_VCCD_CLK_DET;
1301   3                  }
1302   2                  else
1303   2                  {
1304   3                      /* Save alternate powergood detector state */
1305   3                      cyPmBackup.vccdClkDet = CY_PM_DISABLED;
1306   3                  }
1307   2              }
1308   1      
1309   1          #endif /* End of (CY_PM_PSOC3_ES3) */
1310   1      
1311   1          /* Tune LVI/HVI and wait for Hibernate/Sleep regulator to stabilize */
1312   1          CyPmHibSlpSaveSet(CY_PM_MODE_CSR_HIBERNATE);
1313   1      }
1314          
1315          
1316          /*******************************************************************************
1317          * Function Name: CyPmHibRestore
1318          ********************************************************************************
1319          *
1320          * Summary:
1321          *  Restore device for proper Hibernate mode exit: restore state of I2C backup
1322          *  regulator, restore enable state of the 1 kHz ILO and 100 kHz ILO. Restore
1323          *  ILO power down mode state.
1324          *
1325          * Parameters:
1326          *  None.
1327          *
1328          * Return:
1329          *  None.
1330          *
1331          * Side Effects:
1332          *  None.
1333          *
1334          *******************************************************************************/
1335          void CyPmHibRestore(void) 
1336          {
1337   1          /* Restore LVI/HVI configuration */
1338   1          CyPmHibSlpRestore();
1339   1      
1340   1          /* Restore I2C backup regulator configuration */
1341   1          if(CY_PM_ENABLED == cyPmBackup.i2cRegBackup)
1342   1          {
1343   2              /* Enable I2C backup regulator state */
1344   2              CY_PM_PWRSYS_CR1_REG |= CY_PM_PWRSYS_CR1_I2CREG_BACKUP;
1345   2          }
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 23  

1346   1      
1347   1          /* Device is PSoC 3 and the revision is ES3 or later */
1348   1          #if(CY_PM_PSOC3_ES3)
1349   1          
1350   1              /* Restore 1kHz ILO enable state */
1351   1              if(CY_PM_ENABLED == cyPmBackup.ilo1kEnable)
1352   1              {
1353   2                  /* Enable 1kHz ILO */
1354   2                  CyILO_Start1K();
1355   2              }
1356   1          
1357   1              /* Restore 100kHz ILO enable state */
1358   1              if(CY_PM_ENABLED == cyPmBackup.ilo100kEnable)
1359   1              {
1360   2                  /* Enable 100kHz ILO */
1361   2                  CyILO_Start100K();
1362   2              }
1363   1          
1364   1              /* Restore ILO power mode */
1365   1              CyILO_SetPowerMode(cyPmBackup.iloPowerMode);
1366   1      
1367   1          #endif  /* End of (CY_PM_PSOC3_ES3) */
1368   1      
1369   1          /* Device is PSoC 3 and the revision is ES3 or later */
1370   1          #if(CY_PM_PSOC3_ES3)
1371   1          
1372   1              if(CY_PM_DISABLED == cyPmBackup.slpTrBypass)
1373   1              {
1374   2                  /* Enable the sleep regulator and short vccd to vpwrsleep */
1375   2                  CY_PM_PWRSYS_SLP_TR_REG &= ~CY_PM_PWRSYS_SLP_TR_BYPASS;    
1376   2              }
1377   1      
1378   1          #endif  /* End of (CY_PM_PSOC3_ES3) */
1379   1          
1380   1          /* Device is PSoC 3 and the revision is ES3 or later */
1381   1          #if(CY_PM_PSOC3_ES3)
1382   1      
1383   1              /* Restore alternate powergood detector state */
1384   1              if(CY_PM_ENABLED == cyPmBackup.vccdClkDet)
1385   1              {
1386   2                  /* Enable LPCOMPs (slower) instead of faster powergood detector */
1387   2                  CY_PM_PWRSYS_WAKE_TR2_REG |= CY_PM_PWRSYS_WAKE_TR2_VCCD_CLK_DET;
1388   2              }
1389   1      
1390   1          #endif /* End of (CY_PM_PSOC3_ES3) */
1391   1      }
1392          
1393          
1394          /*******************************************************************************
1395          * Function Name: CyPmCtwSaveSet
1396          ********************************************************************************
1397          *
1398          * Summary:
1399          *  Saves current CTW interval, ILO power mode, 1 kHz ILO enable state, CTW
1400          *  interrupt enable state and CTW enable state. Sets new CTW interval, sets ILO
1401          *  to the low power mode, enables 1 kHz ILO (if needed), disables CTW interrupt
1402          *  and enables CTW (if needed).
1403          *
1404          * Parameters:
1405          *  ctwInterval: the CTW interval to be set.
1406          *
1407          * Return:
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 24  

1408          *  None.
1409          *
1410          * Reentrant:
1411          *  No.
1412          *
1413          * Side Effects:
1414          *  None.
1415          *
1416          *******************************************************************************/
1417          void CyPmCtwSaveSet(uint8 ctwInterval)
1418          {
1419   1          /* Enable low power mode */
1420   1              CyILO_SetPowerMode(CY_PM_POWERDOWN_MODE);
1421   1      
1422   1          /* Disable CTW interrupt enable if not yet */
1423   1          if(0u != (CY_PM_TW_CFG2_REG & CY_PM_CTW_IE))
1424   1          {
1425   2              /* Disable CTW interrupt */
1426   2              CY_PM_TW_CFG2_REG &= ~CY_PM_CTW_IE;
1427   2          }   /* Do nothing if CTW interrupt is disabled */
1428   1      
1429   1          /* Enable 1kHz ILO if needed */
1430   1          if(0u == (CY_PM_SLOWCLK_ILO_CR0_REG & CY_PM_ILO_CR0_EN_1K))
1431   1          {
1432   2              /* Enable the 1kHz ILO */
1433   2              CyILO_Start1K();
1434   2          }
1435   1                      
1436   1          /* Enable CTW and update interval if needed */
1437   1          if(0u != (CY_PM_TW_CFG2_REG & CY_PM_CTW_EN))
1438   1          {
1439   2                      /* Set CTW interval if needed */
1440   2                      if(CY_PM_TW_CFG1_REG != ctwInterval)
1441   2                      {
1442   3                              /* Disable the CTW, set new CTW interval and enable it again */
1443   3                              CY_PM_TW_CFG2_REG &= ~CY_PM_CTW_EN;         
1444   3                              CY_PM_TW_CFG1_REG = ctwInterval;
1445   3                              CY_PM_TW_CFG2_REG |= CY_PM_CTW_EN;
1446   3                      }
1447   2          }
1448   1          else
1449   1          {
1450   2                      /* Set CTW interval if needed */
1451   2                      if(CY_PM_TW_CFG1_REG != ctwInterval)
1452   2                      {
1453   3                              /* Set the new CTW interval. Could be changed if CTW is disabled */
1454   3                              CY_PM_TW_CFG1_REG = ctwInterval;
1455   3                      }
1456   2      
1457   2              /* Enable the CTW */
1458   2              CY_PM_TW_CFG2_REG |= CY_PM_CTW_EN;
1459   2          }
1460   1      }
1461          
1462          
1463          /*******************************************************************************
1464          * Function Name: CyPmOppsSaveSet
1465          ********************************************************************************
1466          *
1467          * Summary:
1468          *  Saves current 32kHz XTAL power mode state, saves current 32kHz XTAL enable
1469          *  state, saves 1PPS interrupt enable state, saves 1PPS enable state. Enable
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 25  

1470          *  32kHz XTAL (if needed), disable 1PPS interrupt (if needed), enable 1PPS
1471          *  (if needed).
1472          *
1473          * Parameters:
1474          *  None.
1475          *
1476          * Return:
1477          *  None.
1478          *
1479          * Reentrant:
1480          *  No.
1481          *
1482          * Side Effects:
1483          *  None.
1484          *
1485          *******************************************************************************/
1486          void CyPmOppsSaveSet(void)
1487          {
1488   1          /* Set 32kHz XTAL low power mode */
1489   1              CyXTAL_32KHZ_SetPowerMode(CY_PM_POWERDOWN_MODE);
1490   1      
1491   1          /* Enable 32kHz XTAL if needed */
1492   1          if(0u == (CY_PM_SLOWCLK_X32_CR_REG & CY_PM_X32_CR_X32EN))
1493   1          {
1494   2              /* Enable 32kHz XTAL */
1495   2              CyXTAL_32KHZ_Start();
1496   2          }
1497   1      
1498   1          /* Disable 1PPS interrupt enable if needed */
1499   1          if(0u != (CY_PM_TW_CFG2_REG & CY_PM_1PPS_IE))
1500   1          {
1501   2              /* Disable 1PPS interrupt */
1502   2              CY_PM_TW_CFG2_REG &= ~CY_PM_1PPS_IE;
1503   2          }
1504   1      
1505   1          /* Enable 1PPS if needed */
1506   1          if(0u == (CY_PM_TW_CFG2_REG & CY_PM_1PPS_EN))
1507   1          {
1508   2              /* Enable 1PPS operation */
1509   2              CY_PM_TW_CFG2_REG |= CY_PM_1PPS_EN;
1510   2          }
1511   1      }
1512          
1513          
1514          /*******************************************************************************
1515          * Function Name: CyPmFtwSaveSet
1516          ********************************************************************************
1517          *
1518          * Summary:
1519          *  Saves current FTW interval and set new one, saves ILO power mode state and
1520          *  sets low power mode, saves 100kHz ILO enable state and enables 100kHz ILO,
1521          *  saves current FTW interrupt enable state and disable it if needed, saves
1522          *  current FTW enable state and enable if needed.
1523          *
1524          * Parameters:
1525          *  ftwInterval - FTW counter interval.
1526          *
1527          * Return:
1528          *  None.
1529          *
1530          * Reentrant:
1531          *  No.
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 26  

1532          *
1533          * Side Effects:
1534          *  None.
1535          *
1536          *******************************************************************************/
1537          void CyPmFtwSaveSet(uint8 ftwInterval)
1538          {
1539   1          /* Enable ILO low power mode */
1540   1          CyILO_SetPowerMode(CY_PM_POWERDOWN_MODE);
1541   1      
1542   1          /* Enable 100kHz ILO if needed */
1543   1          if(0u == (CY_PM_SLOWCLK_ILO_CR0_REG & CY_PM_ILO_CR0_EN_100K))
1544   1          {
1545   2              /* Enable the 100kHz ILO */
1546   2              CyILO_Start100K();
1547   2          }
1548   1      
1549   1          /* Enable FTW and set new FTW interval if needed */
1550   1          if(0u != (CY_PM_TW_CFG2_REG & CY_PM_FTW_EN))
1551   1          {
1552   2              /* Disable FTW, set new FTW interval if needed and enable it again */
1553   2                      if(CY_PM_TW_CFG0_REG != ftwInterval)
1554   2                      {
1555   3                              /* Disable the CTW, set new CTW interval and enable it again */
1556   3                  CY_PM_TW_CFG2_REG &= ~CY_PM_FTW_EN;
1557   3                  CY_PM_TW_CFG0_REG = ftwInterval;
1558   3                  CY_PM_TW_CFG2_REG |= CY_PM_FTW_EN;
1559   3                      }
1560   2          }
1561   1          else
1562   1          {
1563   2              /* Set new FTW counter interval if nedded. FTW is disabled. */
1564   2                      if(CY_PM_TW_CFG0_REG != ftwInterval)
1565   2                      {
1566   3                              /* Set the new CTW interval. Could be changed if CTW is disabled */
1567   3                              CY_PM_TW_CFG0_REG = ftwInterval;
1568   3                      }
1569   2      
1570   2              /* Enable the FTW */
1571   2              CY_PM_TW_CFG2_REG |= CY_PM_FTW_EN;
1572   2          }
1573   1      
1574   1          /* Disable FTW interrupt enable if needed */
1575   1          if(0u != (CY_PM_TW_CFG2_REG & CY_PM_FTW_IE))
1576   1          {
1577   2              /* Disable FTW interrupt */
1578   2              CY_PM_TW_CFG2_REG &= ~CY_PM_FTW_IE;
1579   2          }
1580   1      }
1581          
1582          
1583          /*******************************************************************************
1584          * Function Name: CyPmHibSlpSaveSet
1585          ********************************************************************************
1586          *
1587          * Summary:
1588          *  Saves en_lvia, en_lvid, en_hvi enable state, saves wakeup trims (timeout and
1589          *  holdoff). Disable LVI/HVI if entering hibernate power mode to avoid spurious
1590          *  interrupts on wakeup. For the Sleep power mode, leaves LVI/HVI as is but
1591          *  update wakeup time if they are used.
1592          *
1593          *  Before entering a mode that can lose state, make sure pwrup_pulse is finished
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 27  

1594          *  and clear the powerup pulse holdoff setting.
1595          *
1596          * Parameters:
1597          *  CY_PM_MODE_CSR_HIBERNATE - prepare for the Hibernate low power mode.
1598          *  CY_PM_MODE_CSR_SLEEP     - prepare for the Sleep low power mode.
1599          *
1600          * Return:
1601          *  None.
1602          *
1603          * Reentrant:
1604          *  No.
1605          *
1606          * Side Effects:
1607          *  Currently, the is no way to define device grade. This API method must be
1608          *  invoked only for I- & A-grades.
1609          *
1610          *  This API could be blocking as it waits for Hibernate/Sleep regulator to
1611          *  stabilize.
1612          *
1613          *******************************************************************************/
1614          void CyPmHibSlpSaveSet(uint8 powerMode)
1615          {
1616   1          /* Save en_lvia, en_lvid, en_hvi */
1617   1          cyPmBackup.lviaLvidHvi = (CY_PM_RESET_CR1_REG & CY_PM_RESET_CR1_HVI_LVI_EN_MASK);
1618   1      
1619   1          /* Device is PSoC 3 and the revision is ES3 or later */
1620   1          #if(CY_PM_PSOC3_ES3)
1621   1          
1622   1              /* Save SC/CT routing registers */
1623   1              cyPmBackup.scct_data[0u]   = CY_GET_REG8(CYDEV_ANAIF_RT_SC0_SW0 );
1624   1              cyPmBackup.scct_data[1u]   = CY_GET_REG8(CYDEV_ANAIF_RT_SC0_SW2 );
1625   1              cyPmBackup.scct_data[2u]   = CY_GET_REG8(CYDEV_ANAIF_RT_SC0_SW3 );
1626   1              cyPmBackup.scct_data[3u]   = CY_GET_REG8(CYDEV_ANAIF_RT_SC0_SW4 );
1627   1              cyPmBackup.scct_data[4u]   = CY_GET_REG8(CYDEV_ANAIF_RT_SC0_SW6 );
1628   1              cyPmBackup.scct_data[5u]   = CY_GET_REG8(CYDEV_ANAIF_RT_SC0_SW8 );
1629   1              cyPmBackup.scct_data[6u]   = CY_GET_REG8(CYDEV_ANAIF_RT_SC0_SW10);
1630   1          
1631   1              cyPmBackup.scct_data[7u]   = CY_GET_REG8(CYDEV_ANAIF_RT_SC1_SW0 );
1632   1              cyPmBackup.scct_data[8u]   = CY_GET_REG8(CYDEV_ANAIF_RT_SC1_SW2 );
1633   1              cyPmBackup.scct_data[9u]   = CY_GET_REG8(CYDEV_ANAIF_RT_SC1_SW3 );
1634   1              cyPmBackup.scct_data[10u]  = CY_GET_REG8(CYDEV_ANAIF_RT_SC1_SW4 );
1635   1              cyPmBackup.scct_data[11u]  = CY_GET_REG8(CYDEV_ANAIF_RT_SC1_SW6 );
1636   1              cyPmBackup.scct_data[12u]  = CY_GET_REG8(CYDEV_ANAIF_RT_SC1_SW8 );
1637   1              cyPmBackup.scct_data[13u]  = CY_GET_REG8(CYDEV_ANAIF_RT_SC1_SW10);
1638   1          
1639   1              cyPmBackup.scct_data[14u]  = CY_GET_REG8(CYDEV_ANAIF_RT_SC2_SW0 );
1640   1              cyPmBackup.scct_data[15u]  = CY_GET_REG8(CYDEV_ANAIF_RT_SC2_SW2 );
1641   1              cyPmBackup.scct_data[16u]  = CY_GET_REG8(CYDEV_ANAIF_RT_SC2_SW3 );
1642   1              cyPmBackup.scct_data[17u]  = CY_GET_REG8(CYDEV_ANAIF_RT_SC2_SW4 );
1643   1              cyPmBackup.scct_data[18u]  = CY_GET_REG8(CYDEV_ANAIF_RT_SC2_SW6 );
1644   1              cyPmBackup.scct_data[19u]  = CY_GET_REG8(CYDEV_ANAIF_RT_SC2_SW8 );
1645   1              cyPmBackup.scct_data[20u]  = CY_GET_REG8(CYDEV_ANAIF_RT_SC2_SW10);
1646   1          
1647   1              cyPmBackup.scct_data[21u]  = CY_GET_REG8(CYDEV_ANAIF_RT_SC3_SW0 );
1648   1              cyPmBackup.scct_data[22u]  = CY_GET_REG8(CYDEV_ANAIF_RT_SC3_SW2 );
1649   1              cyPmBackup.scct_data[23u]  = CY_GET_REG8(CYDEV_ANAIF_RT_SC3_SW3 );
1650   1              cyPmBackup.scct_data[24u]  = CY_GET_REG8(CYDEV_ANAIF_RT_SC3_SW4 );
1651   1              cyPmBackup.scct_data[25u]  = CY_GET_REG8(CYDEV_ANAIF_RT_SC3_SW6 );
1652   1              cyPmBackup.scct_data[26u]  = CY_GET_REG8(CYDEV_ANAIF_RT_SC3_SW8 );
1653   1              cyPmBackup.scct_data[27u]  = CY_GET_REG8(CYDEV_ANAIF_RT_SC3_SW10);
1654   1      
1655   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC0_SW0 , 0u);
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 28  

1656   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC0_SW2 , 0u);
1657   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC0_SW3 , 0u);
1658   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC0_SW4 , 0u);
1659   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC0_SW6 , 0u);
1660   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC0_SW8 , 0u);
1661   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC0_SW10, 0u);
1662   1          
1663   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC1_SW0 , 0u);
1664   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC1_SW2 , 0u);
1665   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC1_SW3 , 0u);
1666   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC1_SW4 , 0u);
1667   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC1_SW6 , 0u);
1668   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC1_SW8 , 0u);
1669   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC1_SW10, 0u);
1670   1          
1671   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC2_SW0 , 0u);
1672   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC2_SW2 , 0u);
1673   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC2_SW3 , 0u);
1674   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC2_SW4 , 0u);
1675   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC2_SW6 , 0u);
1676   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC2_SW8 , 0u);
1677   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC2_SW10, 0u);
1678   1          
1679   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC3_SW0 , 0u);
1680   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC3_SW2 , 0u);
1681   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC3_SW3 , 0u);
1682   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC3_SW4 , 0u);
1683   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC3_SW6 , 0u);
1684   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC3_SW8 , 0u);
1685   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC3_SW10, 0u);
1686   1      
1687   1              /* LVI/HVI workaround  - save wake up trims */
1688   1              cyPmBackup.wakeupTrimTimeout= CY_PM_PWRSYS_WAKE_TR0_REG;
1689   1              cyPmBackup.wakeupTrim1      = CY_PM_PWRSYS_WAKE_TR1_REG;
1690   1              cyPmBackup.wakeupTrim2      = CY_PM_PWRSYS_WAKE_TR2_REG;
1691   1              cyPmBackup.wakeupTrimHoldoff= CY_PM_PWRSYS_WAKE_TR3_REG;
1692   1      
1693   1              /* Enable replica regulated vcca supply state */
1694   1              CY_PM_PWRSYS_WAKE_TR2_REG |= CY_PM_PWRSYS_WAKE_TR2_USE_VCCA_BACKUP;
1695   1                      
1696   1              switch(powerMode)
1697   1              {
1698   2                  case CY_PM_MODE_CSR_HIBERNATE:
1699   2      
1700   2                      if(0u == (CY_PM_PWRSYS_HIB_TR1_REG & CY_PM_PWRSYS_HIB_TRIM))
1701   2                      {
1702   3                          /* Disable LVI/HVI for hibernate - clear en_lvia, en_lvid, en_hvi */
1703   3                          CY_PM_RESET_CR1_REG &= ~CY_PM_RESET_CR1_HVI_LVI_EN_MASK;
1704   3                          break;
1705   3                      }
1706   2                      /* Intentional fall through */
1707   2      
1708   2                  case CY_PM_MODE_CSR_SLEEP:
1709   2      
1710   2                      /* Reconfigure power mode wakeup trim registers */
1711   2                      if(0u != (CY_PM_RESET_CR1_REG & (CY_PM_RESET_CR1_HVIA_EN | 
1712   2                                CY_PM_RESET_CR1_LVIA_EN | CY_PM_RESET_CR1_LVID_EN)))
1713   2                      {
1714   3                          CY_PM_PWRSYS_WAKE_TR0_REG = CY_PM_PWRSYS_WAKE_TR0_LHVI_DIS;
1715   3                          CY_PM_PWRSYS_WAKE_TR1_REG = CY_PM_PWRSYS_WAKE_TR1_LHVI_DIS;
1716   3                          CY_PM_PWRSYS_WAKE_TR2_REG = CY_PM_PWRSYS_WAKE_TR2_LHVI_DIS;
1717   3                          CY_PM_PWRSYS_WAKE_TR3_REG = CY_PM_PWRSYS_WAKE_TR3_LHVI_DIS;
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 29  

1718   3                      }
1719   2                      else
1720   2                      {
1721   3                          /* Extend wakeup timeline */
1722   3                          CY_PM_PWRSYS_WAKE_TR0_REG = CY_PM_PWRSYS_WAKE_TIMEOUT_IA;
1723   3                          CY_PM_PWRSYS_WAKE_TR3_REG = CY_PM_PWRSYS_WAKE_HOLFOFF_IA;
1724   3                      }
1725   2                      break;
1726   2      
1727   2                  default:
1728   2      
1729   2                      /* No action */
1730   2                      break;
1731   2              }   /* End of switch(powerMode) */
1732   1              
1733   1              /* Serial Wire Viewer (SWV) workaround */
1734   1          
1735   1              /* Disable SWV before entering low power mode */
1736   1              if(0u != (CY_PM_MLOGIC_DBG_REG & CY_PM_MLOGIC_DBG_SWV_CLK_EN))
1737   1              {
1738   2                  /* Save SWV clock enabled state */
1739   2                  cyPmBackup.swvClkEnabled = CY_PM_ENABLED;
1740   2                  
1741   2                  /* Save current ports drive mode settings */
1742   2                  cyPmBackup.prt1Dm = ((CY_PM_PRT1_PC3_REG & CY_PM_PRT1_PC3_DM_MASK) |
1743   2                                      CY_PM_PRT1_PC3_DM_STRONG);
1744   2          
1745   2                  /* Disable SWV clocks */
1746   2                  CY_PM_MLOGIC_DBG_REG &= ~CY_PM_MLOGIC_DBG_SWV_CLK_EN;
1747   2              }
1748   1              else
1749   1              {
1750   2                  /* Save SWV clock disabled state */
1751   2                  cyPmBackup.swvClkEnabled = CY_PM_DISABLED;
1752   2              }
1753   1          
1754   1          #else   /* Not PSoC3 ES3 */
              
                      /* Disable LVI/HVI to save power - doesn't work during buzzing in these revisions */
                      CY_PM_RESET_CR1_REG &= ~CY_PM_RESET_CR1_HVI_LVI_EN_MASK;
              
                      /* Suppress unreferenced local variable warning */
                      powerMode++;
                      
                  #endif  /* End of (CY_PM_PSOC3_ES3) */
1763   1      
1764   1      }
1765          
1766          
1767          /*******************************************************************************
1768          * Function Name: CyPmHibSlpRestore
1769          ********************************************************************************
1770          *
1771          * Summary:
1772          *  Restores en_lvia, en_lvid, en_hvi enable state and wakeup trims (timeout and
1773          *  holdoff).
1774          *
1775          * Parameters:
1776          *  None.
1777          *
1778          * Return:
1779          *  None.
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 30  

1780          *
1781          * Side Effects:
1782          *  None.
1783          *
1784          *******************************************************************************/
1785          void CyPmHibSlpRestore(void) 
1786          {
1787   1          /* Restore en_lvia, en_lvid, en_hvi */
1788   1          CY_PM_RESET_CR1_REG = cyPmBackup.lviaLvidHvi;
1789   1      
1790   1          /* Device is PSoC 3 and the revision is ES3 or later */
1791   1          #if(CY_PM_PSOC3_ES3)
1792   1      
1793   1              /* Restore SC/CT routing registers */
1794   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC0_SW0 , cyPmBackup.scct_data[0u] );
1795   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC0_SW2 , cyPmBackup.scct_data[1u] );
1796   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC0_SW3 , cyPmBackup.scct_data[2u] );
1797   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC0_SW4 , cyPmBackup.scct_data[3u] );
1798   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC0_SW6 , cyPmBackup.scct_data[4u] );
1799   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC0_SW8 , cyPmBackup.scct_data[5u] );
1800   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC0_SW10, cyPmBackup.scct_data[6u] );
1801   1      
1802   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC1_SW0 , cyPmBackup.scct_data[7u] );
1803   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC1_SW2 , cyPmBackup.scct_data[8u] );
1804   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC1_SW3 , cyPmBackup.scct_data[9u] );
1805   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC1_SW4 , cyPmBackup.scct_data[10u]);
1806   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC1_SW6 , cyPmBackup.scct_data[11u]);
1807   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC1_SW8 , cyPmBackup.scct_data[12u]);
1808   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC1_SW10, cyPmBackup.scct_data[13u]);
1809   1      
1810   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC2_SW0 , cyPmBackup.scct_data[14u]);
1811   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC2_SW2 , cyPmBackup.scct_data[15u]);
1812   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC2_SW3 , cyPmBackup.scct_data[16u]);
1813   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC2_SW4 , cyPmBackup.scct_data[17u]);
1814   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC2_SW6 , cyPmBackup.scct_data[18u]);
1815   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC2_SW8 , cyPmBackup.scct_data[19u]);
1816   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC2_SW10, cyPmBackup.scct_data[20u]);
1817   1      
1818   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC3_SW0 , cyPmBackup.scct_data[21u]);
1819   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC3_SW2 , cyPmBackup.scct_data[22u]);
1820   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC3_SW3 , cyPmBackup.scct_data[23u]);
1821   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC3_SW4 , cyPmBackup.scct_data[24u]);
1822   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC3_SW6 , cyPmBackup.scct_data[25u]);
1823   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC3_SW8 , cyPmBackup.scct_data[26u]);
1824   1              CY_SET_REG8(CYDEV_ANAIF_RT_SC3_SW10, cyPmBackup.scct_data[27u]);        
1825   1      
1826   1              /* Restore wake up trims */ 
1827   1              CY_PM_PWRSYS_WAKE_TR0_REG = cyPmBackup.wakeupTrimTimeout;
1828   1              CY_PM_PWRSYS_WAKE_TR1_REG = cyPmBackup.wakeupTrim1;
1829   1              CY_PM_PWRSYS_WAKE_TR2_REG = cyPmBackup.wakeupTrim2;
1830   1              CY_PM_PWRSYS_WAKE_TR3_REG = cyPmBackup.wakeupTrimHoldoff;
1831   1      
1832   1              /* Serial Wire Viewer (SWV) workaround */
1833   1              if(CY_PM_ENABLED == cyPmBackup.swvClkEnabled)
1834   1              {
1835   2                  /* Restore ports drive mode */
1836   2                  cyPmBackup.prt1Dm = ((CY_PM_PRT1_PC3_REG & CY_PM_PRT1_PC3_DM_MASK) |
1837   2                                          cyPmBackup.prt1Dm);
1838   2          
1839   2                  /* Enable SWV clocks */
1840   2                  CY_PM_MLOGIC_DBG_REG |= CY_PM_MLOGIC_DBG_SWV_CLK_EN;
1841   2              }
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 31  

1842   1          
1843   1          #endif /* End of (CY_PM_PSOC3_ES3) */
1844   1      }
1845          
1846          /* [] END OF FILE */
1847          
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 32  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION CyPmSaveClocks (BEGIN)
                                           ; SOURCE LINE # 72
                                           ; SOURCE LINE # 73
                                           ; SOURCE LINE # 75
0000 9043A1            MOV     DPTR,#043A1H
0003 E0                MOVX    A,@DPTR
0004 FF                MOV     R7,A
0005 EF                MOV     A,R7
0006 540F              ANL     A,#0FH
0008 FF                MOV     R7,A
0009 900000      R     MOV     DPTR,#cyPmBackup+010H
000C EF                MOV     A,R7
000D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 76
000E 9043A2            MOV     DPTR,#043A2H
0011 E0                MOVX    A,@DPTR
0012 FF                MOV     R7,A
0013 900000      R     MOV     DPTR,#cyPmBackup+011H
0016 EF                MOV     A,R7
0017 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 77
0018 9043A1            MOV     DPTR,#043A1H
001B E0                MOVX    A,@DPTR
001C FF                MOV     R7,A
001D EF                MOV     A,R7
001E 54F0              ANL     A,#0F0H
0020 FF                MOV     R7,A
0021 EF                MOV     A,R7
0022 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 78
0023 9043A2            MOV     DPTR,#043A2H
0026 E0                MOVX    A,@DPTR
0027 FF                MOV     R7,A
0028 EF                MOV     A,R7
0029 5400              ANL     A,#00H
002B FF                MOV     R7,A
002C EF                MOV     A,R7
002D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 81
002E 904005            MOV     DPTR,#04005H
0031 E0                MOVX    A,@DPTR
0032 FF                MOV     R7,A
0033 EF                MOV     A,R7
0034 5403              ANL     A,#03H
0036 FF                MOV     R7,A
0037 900000      R     MOV     DPTR,#cyPmBackup+03H
003A EF                MOV     A,R7
003B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 84
003C 904200            MOV     DPTR,#04200H
003F E0                MOVX    A,@DPTR
0040 FF                MOV     R7,A
0041 EF                MOV     A,R7
0042 5407              ANL     A,#07H
0044 FF                MOV     R7,A
0045 EF                MOV     A,R7
0046 900000      R     MOV     DPTR,#cyPmImoFreqReg2Mhz
0049 93                MOVC    A,@A+DPTR
004A FF                MOV     R7,A
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 33  

004B 900000      R     MOV     DPTR,#cyPmBackup+06H
004E EF                MOV     A,R7
004F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 87
0050 904800            MOV     DPTR,#04800H
0053 E0                MOVX    A,@DPTR
0054 FF                MOV     R7,A
0055 EF                MOV     A,R7
0056 54C0              ANL     A,#0C0H
0058 FF                MOV     R7,A
0059 900000      R     MOV     DPTR,#cyPmBackup+0CH
005C EF                MOV     A,R7
005D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 92
005E 7F2D              MOV     R7,#02DH
0060 120000      E     LCALL   _CyFlash_SetWaitCycles
                                           ; SOURCE LINE # 111
0063 9043A0            MOV     DPTR,#043A0H
0066 E0                MOVX    A,@DPTR
0067 FF                MOV     R7,A
0068 EF                MOV     A,R7
0069 5410              ANL     A,#010H
006B FF                MOV     R7,A
006C 7E00              MOV     R6,#00H
006E EF                MOV     A,R7
006F 4E                ORL     A,R6
0070 6021              JZ      ?C0001
                                           ; SOURCE LINE # 112
                                           ; SOURCE LINE # 114
0072 900000      R     MOV     DPTR,#cyPmBackup+08H
0075 7401              MOV     A,#01H
0077 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 117
0078 904200            MOV     DPTR,#04200H
007B E0                MOVX    A,@DPTR
007C FF                MOV     R7,A
007D EF                MOV     A,R7
007E 5407              ANL     A,#07H
0080 FF                MOV     R7,A
0081 7E00              MOV     R6,#00H
0083 D3                SETB    C
0084 EF                MOV     A,R7
0085 9404              SUBB    A,#04H
0087 EE                MOV     A,R6
0088 9400              SUBB    A,#00H
008A 4028              JC      ?C0003
                                           ; SOURCE LINE # 118
                                           ; SOURCE LINE # 120
008C 7F04              MOV     R7,#04H
008E 120000      E     LCALL   _CyIMO_SetFreq
                                           ; SOURCE LINE # 121
                                           ; SOURCE LINE # 122
0091 8021              SJMP    ?C0003
0093         ?C0001:
                                           ; SOURCE LINE # 124
                                           ; SOURCE LINE # 126
0093 900000      R     MOV     DPTR,#cyPmBackup+08H
0096 E4                CLR     A
0097 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 129
0098 904200            MOV     DPTR,#04200H
009B E0                MOVX    A,@DPTR
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 34  

009C FF                MOV     R7,A
009D EF                MOV     A,R7
009E 5407              ANL     A,#07H
00A0 FF                MOV     R7,A
00A1 EF                MOV     A,R7
00A2 900000      R     MOV     DPTR,#cyPmImoFreqReg2Mhz
00A5 93                MOVC    A,@A+DPTR
00A6 FF                MOV     R7,A
00A7 EF                MOV     A,R7
00A8 6005              JZ      ?C0004
                                           ; SOURCE LINE # 130
                                           ; SOURCE LINE # 131
00AA 7F00              MOV     R7,#00H
00AC 120000      E     LCALL   _CyIMO_SetFreq
                                           ; SOURCE LINE # 132
00AF         ?C0004:
                                           ; SOURCE LINE # 135
00AF 7F00              MOV     R7,#00H
00B1 120000      E     LCALL   _CyIMO_Start
                                           ; SOURCE LINE # 136
00B4         ?C0003:
                                           ; SOURCE LINE # 139
00B4 904200            MOV     DPTR,#04200H
00B7 E0                MOVX    A,@DPTR
00B8 FF                MOV     R7,A
00B9 EF                MOV     A,R7
00BA 5420              ANL     A,#020H
00BC FF                MOV     R7,A
00BD 7E00              MOV     R6,#00H
00BF EF                MOV     A,R7
00C0 4E                ORL     A,R6
00C1 6021              JZ      ?C0005
                                           ; SOURCE LINE # 140
                                           ; SOURCE LINE # 143
00C3 904000            MOV     DPTR,#04000H
00C6 E0                MOVX    A,@DPTR
00C7 FF                MOV     R7,A
00C8 EF                MOV     A,R7
00C9 5440              ANL     A,#040H
00CB FF                MOV     R7,A
00CC 7E00              MOV     R6,#00H
00CE EF                MOV     A,R7
00CF 4E                ORL     A,R6
00D0 6004              JZ      ?C0006
00D2 7F01              MOV     R7,#01H
00D4 8002              SJMP    ?C0007
00D6         ?C0006:
00D6 7F02              MOV     R7,#02H
00D8         ?C0007:
00D8 900000      R     MOV     DPTR,#cyPmBackup+04H
00DB EF                MOV     A,R7
00DC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 146
00DD 7F00              MOV     R7,#00H
00DF 120000      E     LCALL   _CyIMO_SetSource
                                           ; SOURCE LINE # 147
00E2 8005              SJMP    ?C0008
00E4         ?C0005:
                                           ; SOURCE LINE # 149
                                           ; SOURCE LINE # 151
00E4 900000      R     MOV     DPTR,#cyPmBackup+04H
00E7 E4                CLR     A
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 35  

00E8 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 152
00E9         ?C0008:
                                           ; SOURCE LINE # 155
00E9 904000            MOV     DPTR,#04000H
00EC E0                MOVX    A,@DPTR
00ED FF                MOV     R7,A
00EE EF                MOV     A,R7
00EF 5430              ANL     A,#030H
00F1 FF                MOV     R7,A
00F2 900000      R     MOV     DPTR,#cyPmBackup+05H
00F5 EF                MOV     A,R7
00F6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 157
00F7 900000      R     MOV     DPTR,#cyPmBackup+05H
00FA E0                MOVX    A,@DPTR
00FB FF                MOV     R7,A
00FC EF                MOV     A,R7
00FD 600B              JZ      ?C0009
                                           ; SOURCE LINE # 158
                                           ; SOURCE LINE # 162
00FF 904000            MOV     DPTR,#04000H
0102 E0                MOVX    A,@DPTR
0103 FF                MOV     R7,A
0104 EF                MOV     A,R7
0105 54CF              ANL     A,#0CFH
0107 FF                MOV     R7,A
0108 EF                MOV     A,R7
0109 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 164
010A         ?C0009:
                                           ; SOURCE LINE # 167
010A 904200            MOV     DPTR,#04200H
010D E0                MOVX    A,@DPTR
010E FF                MOV     R7,A
010F EF                MOV     A,R7
0110 5410              ANL     A,#010H
0112 FF                MOV     R7,A
0113 7E00              MOV     R6,#00H
0115 EF                MOV     A,R7
0116 4E                ORL     A,R6
0117 600B              JZ      ?C0010
                                           ; SOURCE LINE # 168
                                           ; SOURCE LINE # 170
0119 900000      R     MOV     DPTR,#cyPmBackup+07H
011C 7401              MOV     A,#01H
011E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 171
011F 120000      E     LCALL   CyIMO_DisableDoubler
                                           ; SOURCE LINE # 172
0122 8005              SJMP    ?C0011
0124         ?C0010:
                                           ; SOURCE LINE # 174
                                           ; SOURCE LINE # 176
0124 900000      R     MOV     DPTR,#cyPmBackup+07H
0127 E4                CLR     A
0128 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 177
0129         ?C0011:
                                           ; SOURCE LINE # 180
0129 904004            MOV     DPTR,#04004H
012C E0                MOVX    A,@DPTR
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 36  

012D FF                MOV     R7,A
012E 900000      R     MOV     DPTR,#cyPmBackup+0BH
0131 EF                MOV     A,R7
0132 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 181
0133 900000      R     MOV     DPTR,#cyPmBackup+0BH
0136 E0                MOVX    A,@DPTR
0137 FF                MOV     R7,A
0138 EF                MOV     A,R7
0139 6005              JZ      ?C0012
                                           ; SOURCE LINE # 182
                                           ; SOURCE LINE # 184
013B 7F00              MOV     R7,#00H
013D 120000      E     LCALL   _CyMasterClk_SetDivider
                                           ; SOURCE LINE # 185
0140         ?C0012:
                                           ; SOURCE LINE # 188
0140 900000      R     MOV     DPTR,#cyPmBackup+03H
0143 E0                MOVX    A,@DPTR
0144 FF                MOV     R7,A
0145 EF                MOV     A,R7
0146 6005              JZ      ?C0013
                                           ; SOURCE LINE # 189
                                           ; SOURCE LINE # 190
0148 7F00              MOV     R7,#00H
014A 120000      E     LCALL   _CyMasterClk_SetSource
                                           ; SOURCE LINE # 191
014D         ?C0013:
                                           ; SOURCE LINE # 194
014D 904007            MOV     DPTR,#04007H
0150 E0                MOVX    A,@DPTR
0151 FF                MOV     R7,A
0152 7E00              MOV     R6,#00H
0154 EF                MOV     A,R7
0155 7F00              MOV     R7,#00H
0157 FE                MOV     R6,A
0158 904006            MOV     DPTR,#04006H
015B E0                MOVX    A,@DPTR
015C FD                MOV     R5,A
015D 7C00              MOV     R4,#00H
015F EE                MOV     A,R6
0160 4C                ORL     A,R4
0161 FE                MOV     R6,A
0162 EF                MOV     A,R7
0163 4D                ORL     A,R5
0164 FF                MOV     R7,A
0165 900000      R     MOV     DPTR,#cyPmBackup+09H
0168 EE                MOV     A,R6
0169 F0                MOVX    @DPTR,A
016A A3                INC     DPTR
016B EF                MOV     A,R7
016C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 195
016D 900000      R     MOV     DPTR,#cyPmBackup+09H
0170 E0                MOVX    A,@DPTR
0171 FE                MOV     R6,A
0172 A3                INC     DPTR
0173 E0                MOVX    A,@DPTR
0174 FF                MOV     R7,A
0175 EF                MOV     A,R7
0176 4E                ORL     A,R6
0177 6007              JZ      ?C0014
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 37  

                                           ; SOURCE LINE # 196
                                           ; SOURCE LINE # 197
0179 7F00              MOV     R7,#00H
017B 7E00              MOV     R6,#00H
017D 120000      E     LCALL   _CyBusClk_SetDivider
                                           ; SOURCE LINE # 198
0180         ?C0014:
                                           ; SOURCE LINE # 206
0180 904005            MOV     DPTR,#04005H
0183 E0                MOVX    A,@DPTR
0184 FF                MOV     R7,A
0185 EF                MOV     A,R7
0186 54F0              ANL     A,#0F0H
0188 FF                MOV     R7,A
0189 7E00              MOV     R6,#00H
018B EE                MOV     A,R6
018C C4                SWAP    A
018D F8                MOV     R0,A
018E 54F0              ANL     A,#0F0H
0190 C8                XCH     A,R0
0191 68                XRL     A,R0
0192 FE                MOV     R6,A
0193 EF                MOV     A,R7
0194 C4                SWAP    A
0195 540F              ANL     A,#0FH
0197 48                ORL     A,R0
0198 FF                MOV     R7,A
0199 EF                MOV     A,R7
019A 2401              ADD     A,#01H
019C FD                MOV     R5,A
019D EE                MOV     A,R6
019E 3400              ADDC    A,#00H
01A0 FC                MOV     R4,A
01A1 904200            MOV     DPTR,#04200H
01A4 E0                MOVX    A,@DPTR
01A5 FF                MOV     R7,A
01A6 EF                MOV     A,R7
01A7 5407              ANL     A,#07H
01A9 FF                MOV     R7,A
01AA EF                MOV     A,R7
01AB 900000      R     MOV     DPTR,#cyPmImoFreqReg2Mhz
01AE 93                MOVC    A,@A+DPTR
01AF FF                MOV     R7,A
01B0 7E00              MOV     R6,#00H
01B2 120000      E     LCALL   ?C?UIDIV
01B5 900000      R     MOV     DPTR,#cyPmBackup+016H
01B8 EF                MOV     A,R7
01B9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 230
01BA 900000      R     MOV     DPTR,#cyPmBackup+016H
01BD E0                MOVX    A,@DPTR
01BE FF                MOV     R7,A
01BF 120000      E     LCALL   _CyFlash_SetWaitCycles
                                           ; SOURCE LINE # 233
01C2 904220            MOV     DPTR,#04220H
01C5 E0                MOVX    A,@DPTR
01C6 FF                MOV     R7,A
01C7 EF                MOV     A,R7
01C8 5401              ANL     A,#01H
01CA FF                MOV     R7,A
01CB 7E00              MOV     R6,#00H
01CD EF                MOV     A,R7
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 38  

01CE 4E                ORL     A,R6
01CF 600B              JZ      ?C0015
                                           ; SOURCE LINE # 234
                                           ; SOURCE LINE # 236
01D1 900000      R     MOV     DPTR,#cyPmBackup+01H
01D4 7401              MOV     A,#01H
01D6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 237
01D7 120000      E     LCALL   CyPLL_OUT_Stop
                                           ; SOURCE LINE # 238
01DA 8005              SJMP    ?C0016
01DC         ?C0015:
                                           ; SOURCE LINE # 240
                                           ; SOURCE LINE # 242
01DC 900000      R     MOV     DPTR,#cyPmBackup+01H
01DF E4                CLR     A
01E0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 243
01E1         ?C0016:
                                           ; SOURCE LINE # 246
01E1 904210            MOV     DPTR,#04210H
01E4 E0                MOVX    A,@DPTR
01E5 FF                MOV     R7,A
01E6 EF                MOV     A,R7
01E7 5401              ANL     A,#01H
01E9 FF                MOV     R7,A
01EA 7E00              MOV     R6,#00H
01EC EF                MOV     A,R7
01ED 4E                ORL     A,R6
01EE 600A              JZ      ?C0017
                                           ; SOURCE LINE # 247
                                           ; SOURCE LINE # 249
01F0 900000      R     MOV     DPTR,#cyPmBackup+02H
01F3 7401              MOV     A,#01H
01F5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 250
01F6 120000      E     LCALL   CyXTAL_Stop
                                           ; SOURCE LINE # 251
01F9 22                RET     
01FA         ?C0017:
                                           ; SOURCE LINE # 253
                                           ; SOURCE LINE # 255
01FA 900000      R     MOV     DPTR,#cyPmBackup+02H
01FD E4                CLR     A
01FE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 256
                                           ; SOURCE LINE # 257
01FF         ?C0019:
01FF 22                RET     
             ; FUNCTION CyPmSaveClocks (END)

             ; FUNCTION CyPmRestoreClocks (BEGIN)
                                           ; SOURCE LINE # 282
                                           ; SOURCE LINE # 283
                                           ; SOURCE LINE # 284
0000 900000      R     MOV     DPTR,#status
0003 7410              MOV     A,#010H
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 288
0006 900000      R     MOV     DPTR,#cyPmBackup+02H
0009 E0                MOVX    A,@DPTR
000A FF                MOV     R7,A
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 39  

000B EF                MOV     A,R7
000C 6401              XRL     A,#01H
000E 7058              JNZ     ?C0020
                                           ; SOURCE LINE # 289
                                           ; SOURCE LINE # 297
0010 7F00              MOV     R7,#00H
0012 120000      E     LCALL   _CyXTAL_Start
                                           ; SOURCE LINE # 300
0015 904210            MOV     DPTR,#04210H
0018 E0                MOVX    A,@DPTR
0019 FF                MOV     R7,A
                                           ; SOURCE LINE # 303
001A 900000      R     MOV     DPTR,#i
001D 7405              MOV     A,#05H
001F F0                MOVX    @DPTR,A
0020         ?C0021:
0020 900000      R     MOV     DPTR,#i
0023 E0                MOVX    A,@DPTR
0024 FF                MOV     R7,A
0025 EF                MOV     A,R7
0026 D3                SETB    C
0027 9400              SUBB    A,#00H
0029 4032              JC      ?C0022
                                           ; SOURCE LINE # 304
                                           ; SOURCE LINE # 306
002B 900000      R     MOV     DPTR,#cyPmBackup+016H
002E E0                MOVX    A,@DPTR
002F FF                MOV     R7,A
0030 7EC8              MOV     R6,#0C8H
0032 EF                MOV     A,R7
0033 8EF0              MOV     B,R6
0035 A4                MUL     AB
0036 FF                MOV     R7,A
0037 AEF0              MOV     R6,B
0039 E4                CLR     A
003A FC                MOV     R4,A
003B FD                MOV     R5,A
003C 120000      E     LCALL   _CyDelayCycles
                                           ; SOURCE LINE # 309
003F 904210            MOV     DPTR,#04210H
0042 E0                MOVX    A,@DPTR
0043 FF                MOV     R7,A
0044 EF                MOV     A,R7
0045 5480              ANL     A,#080H
0047 FF                MOV     R7,A
0048 7E00              MOV     R6,#00H
004A EF                MOV     A,R7
004B 4E                ORL     A,R6
004C 7007              JNZ     ?C0023
                                           ; SOURCE LINE # 310
                                           ; SOURCE LINE # 311
004E 900000      R     MOV     DPTR,#status
0051 E4                CLR     A
0052 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 312
0053 8008              SJMP    ?C0022
                                           ; SOURCE LINE # 313
                                           ; SOURCE LINE # 314
0055         ?C0023:
0055 900000      R     MOV     DPTR,#i
0058 E0                MOVX    A,@DPTR
0059 14                DEC     A
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 40  

005A F0                MOVX    @DPTR,A
005B 80C3              SJMP    ?C0021
005D         ?C0022:
                                           ; SOURCE LINE # 316
005D 900000      R     MOV     DPTR,#status
0060 E0                MOVX    A,@DPTR
0061 FF                MOV     R7,A
0062 EF                MOV     A,R7
0063 B41005            CJNE    A,#010H,?C0026
                                           ; SOURCE LINE # 317
                                           ; SOURCE LINE # 321
                                           ; SOURCE LINE # 322
0066 8003              SJMP    ?C0026
0068         ?C0020:
                                           ; SOURCE LINE # 324
                                           ; SOURCE LINE # 326
0068 120000      E     LCALL   CyXTAL_Stop
                                           ; SOURCE LINE # 327
006B         ?C0026:
                                           ; SOURCE LINE # 331
006B 900000      R     MOV     DPTR,#cyPmBackup+01H
006E E0                MOVX    A,@DPTR
006F FF                MOV     R7,A
0070 EF                MOV     A,R7
0071 B4011B            CJNE    A,#01H,?C0027
                                           ; SOURCE LINE # 332
                                           ; SOURCE LINE # 340
0074 7F00              MOV     R7,#00H
0076 120000      E     LCALL   _CyPLL_OUT_Start
                                           ; SOURCE LINE # 343
0079 900000      R     MOV     DPTR,#cyPmBackup+016H
007C E0                MOVX    A,@DPTR
007D FF                MOV     R7,A
007E 7EFA              MOV     R6,#0FAH
0080 EF                MOV     A,R7
0081 8EF0              MOV     B,R6
0083 A4                MUL     AB
0084 FF                MOV     R7,A
0085 AEF0              MOV     R6,B
0087 E4                CLR     A
0088 FC                MOV     R4,A
0089 FD                MOV     R5,A
008A 120000      E     LCALL   _CyDelayCycles
                                           ; SOURCE LINE # 344
008D 8003              SJMP    ?C0028
008F         ?C0027:
                                           ; SOURCE LINE # 346
                                           ; SOURCE LINE # 348
008F 120000      E     LCALL   CyPLL_OUT_Stop
                                           ; SOURCE LINE # 349
0092         ?C0028:
                                           ; SOURCE LINE # 355
0092 7F2D              MOV     R7,#02DH
0094 120000      E     LCALL   _CyFlash_SetWaitCycles
                                           ; SOURCE LINE # 375
0097 900000      R     MOV     DPTR,#cyPmBackup+03H
009A E0                MOVX    A,@DPTR
009B FF                MOV     R7,A
009C EF                MOV     A,R7
009D 601E              JZ      ?C0029
                                           ; SOURCE LINE # 376
                                           ; SOURCE LINE # 381
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 41  

009F 900000      R     MOV     DPTR,#cyPmBackup+0BH
00A2 E0                MOVX    A,@DPTR
00A3 FF                MOV     R7,A
00A4 904004            MOV     DPTR,#04004H
00A7 E0                MOVX    A,@DPTR
00A8 FE                MOV     R6,A
00A9 EE                MOV     A,R6
00AA 6F                XRL     A,R7
00AB 6008              JZ      ?C0030
                                           ; SOURCE LINE # 382
                                           ; SOURCE LINE # 384
00AD 900000      R     MOV     DPTR,#cyPmBackup+0BH
00B0 E0                MOVX    A,@DPTR
00B1 FF                MOV     R7,A
00B2 120000      E     LCALL   _CyMasterClk_SetDivider
                                           ; SOURCE LINE # 385
00B5         ?C0030:
                                           ; SOURCE LINE # 388
00B5 900000      R     MOV     DPTR,#cyPmBackup+03H
00B8 E0                MOVX    A,@DPTR
00B9 FF                MOV     R7,A
00BA 120000      E     LCALL   _CyMasterClk_SetSource
                                           ; SOURCE LINE # 389
00BD         ?C0029:
                                           ; SOURCE LINE # 392
00BD 904200            MOV     DPTR,#04200H
00C0 E0                MOVX    A,@DPTR
00C1 FF                MOV     R7,A
00C2 EF                MOV     A,R7
00C3 5407              ANL     A,#07H
00C5 FF                MOV     R7,A
00C6 EF                MOV     A,R7
00C7 900000      R     MOV     DPTR,#cyPmImoFreqReg2Mhz
00CA 93                MOVC    A,@A+DPTR
00CB FF                MOV     R7,A
00CC 900000      R     MOV     DPTR,#cyPmBackup+06H
00CF E0                MOVX    A,@DPTR
00D0 FE                MOV     R6,A
00D1 EE                MOV     A,R6
00D2 6F                XRL     A,R7
00D3 600E              JZ      ?C0031
                                           ; SOURCE LINE # 393
                                           ; SOURCE LINE # 394
00D5 900000      R     MOV     DPTR,#cyPmBackup+06H
00D8 E0                MOVX    A,@DPTR
00D9 FF                MOV     R7,A
00DA EF                MOV     A,R7
00DB 900000      R     MOV     DPTR,#cyPmImoFreqMhz2Reg
00DE 93                MOVC    A,@A+DPTR
00DF FF                MOV     R7,A
00E0 120000      E     LCALL   _CyIMO_SetFreq
                                           ; SOURCE LINE # 395
00E3         ?C0031:
                                           ; SOURCE LINE # 399
00E3 900000      R     MOV     DPTR,#cyPmBackup+08H
00E6 E0                MOVX    A,@DPTR
00E7 FF                MOV     R7,A
00E8 EF                MOV     A,R7
00E9 B40114            CJNE    A,#01H,?C0032
00EC 9043A0            MOV     DPTR,#043A0H
00EF E0                MOVX    A,@DPTR
00F0 FF                MOV     R7,A
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 42  

00F1 EF                MOV     A,R7
00F2 5410              ANL     A,#010H
00F4 FF                MOV     R7,A
00F5 7E00              MOV     R6,#00H
00F7 EF                MOV     A,R7
00F8 4E                ORL     A,R6
00F9 7005              JNZ     ?C0032
                                           ; SOURCE LINE # 400
                                           ; SOURCE LINE # 402
00FB 7F00              MOV     R7,#00H
00FD 120000      E     LCALL   _CyIMO_Start
                                           ; SOURCE LINE # 403
0100         ?C0032:
                                           ; SOURCE LINE # 407
0100 900000      R     MOV     DPTR,#cyPmBackup+08H
0103 E0                MOVX    A,@DPTR
0104 FF                MOV     R7,A
0105 EF                MOV     A,R7
0106 6401              XRL     A,#01H
0108 6012              JZ      ?C0033
010A 9043A0            MOV     DPTR,#043A0H
010D E0                MOVX    A,@DPTR
010E FF                MOV     R7,A
010F EF                MOV     A,R7
0110 5410              ANL     A,#010H
0112 FF                MOV     R7,A
0113 7E00              MOV     R6,#00H
0115 EF                MOV     A,R7
0116 4E                ORL     A,R6
0117 6003              JZ      ?C0033
                                           ; SOURCE LINE # 408
                                           ; SOURCE LINE # 410
0119 120000      E     LCALL   CyIMO_Stop
                                           ; SOURCE LINE # 411
011C         ?C0033:
                                           ; SOURCE LINE # 414
011C 900000      R     MOV     DPTR,#cyPmBackup+04H
011F E0                MOVX    A,@DPTR
0120 FF                MOV     R7,A
0121 120000      E     LCALL   _CyIMO_SetSource
                                           ; SOURCE LINE # 417
0124 900000      R     MOV     DPTR,#cyPmBackup+07H
0127 E0                MOVX    A,@DPTR
0128 FF                MOV     R7,A
0129 EF                MOV     A,R7
012A B40105            CJNE    A,#01H,?C0034
                                           ; SOURCE LINE # 418
                                           ; SOURCE LINE # 420
012D 120000      E     LCALL   CyIMO_EnableDoubler
                                           ; SOURCE LINE # 421
0130 8003              SJMP    ?C0035
0132         ?C0034:
                                           ; SOURCE LINE # 423
                                           ; SOURCE LINE # 425
0132 120000      E     LCALL   CyIMO_DisableDoubler
                                           ; SOURCE LINE # 426
0135         ?C0035:
                                           ; SOURCE LINE # 429
0135 904000            MOV     DPTR,#04000H
0138 E0                MOVX    A,@DPTR
0139 FF                MOV     R7,A
013A EF                MOV     A,R7
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 43  

013B 5430              ANL     A,#030H
013D FF                MOV     R7,A
013E 7E00              MOV     R6,#00H
0140 900000      R     MOV     DPTR,#cyPmBackup+05H
0143 E0                MOVX    A,@DPTR
0144 FD                MOV     R5,A
0145 7C00              MOV     R4,#00H
0147 ED                MOV     A,R5
0148 6F                XRL     A,R7
0149 7002              JNZ     ?C0110
014B EC                MOV     A,R4
014C 6E                XRL     A,R6
014D         ?C0110:
014D 6016              JZ      ?C0036
                                           ; SOURCE LINE # 430
                                           ; SOURCE LINE # 431
014F 904000            MOV     DPTR,#04000H
0152 E0                MOVX    A,@DPTR
0153 FF                MOV     R7,A
0154 EF                MOV     A,R7
0155 54CF              ANL     A,#0CFH
0157 FF                MOV     R7,A
0158 900000      R     MOV     DPTR,#cyPmBackup+05H
015B E0                MOVX    A,@DPTR
015C FE                MOV     R6,A
015D EF                MOV     A,R7
015E 4E                ORL     A,R6
015F FF                MOV     R7,A
0160 904000            MOV     DPTR,#04000H
0163 EF                MOV     A,R7
0164 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 433
0165         ?C0036:
                                           ; SOURCE LINE # 435
0165 900000      R     MOV     DPTR,#cyPmBackup+03H
0168 E0                MOVX    A,@DPTR
0169 FF                MOV     R7,A
016A EF                MOV     A,R7
016B 701E              JNZ     ?C0037
                                           ; SOURCE LINE # 436
                                           ; SOURCE LINE # 438
016D 900000      R     MOV     DPTR,#cyPmBackup+0BH
0170 E0                MOVX    A,@DPTR
0171 FF                MOV     R7,A
0172 904004            MOV     DPTR,#04004H
0175 E0                MOVX    A,@DPTR
0176 FE                MOV     R6,A
0177 EE                MOV     A,R6
0178 6F                XRL     A,R7
0179 6008              JZ      ?C0038
                                           ; SOURCE LINE # 439
                                           ; SOURCE LINE # 441
017B 900000      R     MOV     DPTR,#cyPmBackup+0BH
017E E0                MOVX    A,@DPTR
017F FF                MOV     R7,A
0180 120000      E     LCALL   _CyMasterClk_SetDivider
                                           ; SOURCE LINE # 442
0183         ?C0038:
                                           ; SOURCE LINE # 445
0183 900000      R     MOV     DPTR,#cyPmBackup+03H
0186 E0                MOVX    A,@DPTR
0187 FF                MOV     R7,A
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 44  

0188 120000      E     LCALL   _CyMasterClk_SetSource
                                           ; SOURCE LINE # 447
018B         ?C0037:
                                           ; SOURCE LINE # 450
018B 904007            MOV     DPTR,#04007H
018E E0                MOVX    A,@DPTR
018F FF                MOV     R7,A
0190 7E00              MOV     R6,#00H
0192 EF                MOV     A,R7
0193 7F00              MOV     R7,#00H
0195 FE                MOV     R6,A
0196 904006            MOV     DPTR,#04006H
0199 E0                MOVX    A,@DPTR
019A FD                MOV     R5,A
019B 7C00              MOV     R4,#00H
019D EE                MOV     A,R6
019E 4C                ORL     A,R4
019F FE                MOV     R6,A
01A0 EF                MOV     A,R7
01A1 4D                ORL     A,R5
01A2 FF                MOV     R7,A
01A3 900000      R     MOV     DPTR,#cyPmBackup+09H
01A6 E0                MOVX    A,@DPTR
01A7 FC                MOV     R4,A
01A8 A3                INC     DPTR
01A9 E0                MOVX    A,@DPTR
01AA FD                MOV     R5,A
01AB EF                MOV     A,R7
01AC 6D                XRL     A,R5
01AD 7002              JNZ     ?C0111
01AF EE                MOV     A,R6
01B0 6C                XRL     A,R4
01B1         ?C0111:
01B1 600B              JZ      ?C0039
                                           ; SOURCE LINE # 451
                                           ; SOURCE LINE # 452
01B3 900000      R     MOV     DPTR,#cyPmBackup+09H
01B6 E0                MOVX    A,@DPTR
01B7 FE                MOV     R6,A
01B8 A3                INC     DPTR
01B9 E0                MOVX    A,@DPTR
01BA FF                MOV     R7,A
01BB 120000      E     LCALL   _CyBusClk_SetDivider
                                           ; SOURCE LINE # 453
01BE         ?C0039:
                                           ; SOURCE LINE # 456
01BE 904800            MOV     DPTR,#04800H
01C1 E0                MOVX    A,@DPTR
01C2 FF                MOV     R7,A
01C3 EF                MOV     A,R7
01C4 543F              ANL     A,#03FH
01C6 FF                MOV     R7,A
01C7 900000      R     MOV     DPTR,#cyPmBackup+0CH
01CA E0                MOVX    A,@DPTR
01CB FE                MOV     R6,A
01CC EF                MOV     A,R7
01CD 4E                ORL     A,R6
01CE FF                MOV     R7,A
01CF 904800            MOV     DPTR,#04800H
01D2 EF                MOV     A,R7
01D3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 460
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 45  

01D4 900000      R     MOV     DPTR,#cyPmBackup+010H
01D7 E0                MOVX    A,@DPTR
01D8 FF                MOV     R7,A
01D9 9043A1            MOV     DPTR,#043A1H
01DC EF                MOV     A,R7
01DD F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 461
01DE 900000      R     MOV     DPTR,#cyPmBackup+011H
01E1 E0                MOVX    A,@DPTR
01E2 FF                MOV     R7,A
01E3 9043A2            MOV     DPTR,#043A2H
01E6 EF                MOV     A,R7
01E7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 462
01E8 22                RET     
             ; FUNCTION CyPmRestoreClocks (END)

             ; FUNCTION _CyPmAltAct (BEGIN)
                                           ; SOURCE LINE # 571
0000 900000      R     MOV     DPTR,#wakeupTime
0003 EE                MOV     A,R6
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EF                MOV     A,R7
0007 F0                MOVX    @DPTR,A
0008 900000      R     MOV     DPTR,#wakeupSource
000B EC                MOV     A,R4
000C F0                MOVX    @DPTR,A
000D A3                INC     DPTR
000E ED                MOV     A,R5
000F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 572
                                           ; SOURCE LINE # 574
0010 900000      R     MOV     DPTR,#wakeupTime
0013 E0                MOVX    A,@DPTR
0014 FE                MOV     R6,A
0015 A3                INC     DPTR
0016 E0                MOVX    A,@DPTR
0017 FF                MOV     R7,A
0018 C3                CLR     C
0019 EF                MOV     A,R7
001A 940E              SUBB    A,#0EH
001C EE                MOV     A,R6
001D 9400              SUBB    A,#00H
001F 4038              JC      ?C0041
0021 900000      R     MOV     DPTR,#wakeupTime
0024 E0                MOVX    A,@DPTR
0025 FE                MOV     R6,A
0026 A3                INC     DPTR
0027 E0                MOVX    A,@DPTR
0028 FF                MOV     R7,A
0029 D3                SETB    C
002A EF                MOV     A,R7
002B 940D              SUBB    A,#0DH
002D EE                MOV     A,R6
002E 9401              SUBB    A,#01H
0030 5027              JNC     ?C0041
                                           ; SOURCE LINE # 575
                                           ; SOURCE LINE # 599
0032 900000      R     MOV     DPTR,#wakeupTime
0035 E0                MOVX    A,@DPTR
0036 FE                MOV     R6,A
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 46  

0037 A3                INC     DPTR
0038 E0                MOVX    A,@DPTR
0039 FF                MOV     R7,A
003A EF                MOV     A,R7
003B 24F2              ADD     A,#0F2H
003D FF                MOV     R7,A
003E EF                MOV     A,R7
003F 54FF              ANL     A,#0FFH
0041 FF                MOV     R7,A
0042 120000      R     LCALL   _CyPmFtwSaveSet
                                           ; SOURCE LINE # 604
0045 900000      R     MOV     DPTR,#wakeupSource
0048 E0                MOVX    A,@DPTR
0049 FE                MOV     R6,A
004A A3                INC     DPTR
004B E0                MOVX    A,@DPTR
004C FF                MOV     R7,A
004D EE                MOV     A,R6
004E 4404              ORL     A,#04H
0050 FE                MOV     R6,A
0051 900000      R     MOV     DPTR,#wakeupSource
0054 EE                MOV     A,R6
0055 F0                MOVX    @DPTR,A
0056 A3                INC     DPTR
0057 EF                MOV     A,R7
0058 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 605
0059         ?C0041:
                                           ; SOURCE LINE # 608
0059 900000      R     MOV     DPTR,#wakeupTime
005C E0                MOVX    A,@DPTR
005D FE                MOV     R6,A
005E A3                INC     DPTR
005F E0                MOVX    A,@DPTR
0060 FF                MOV     R7,A
0061 C3                CLR     C
0062 EF                MOV     A,R7
0063 9402              SUBB    A,#02H
0065 EE                MOV     A,R6
0066 9400              SUBB    A,#00H
0068 4037              JC      ?C0042
006A 900000      R     MOV     DPTR,#wakeupTime
006D E0                MOVX    A,@DPTR
006E FE                MOV     R6,A
006F A3                INC     DPTR
0070 E0                MOVX    A,@DPTR
0071 FF                MOV     R7,A
0072 D3                SETB    C
0073 EF                MOV     A,R7
0074 940D              SUBB    A,#0DH
0076 EE                MOV     A,R6
0077 9400              SUBB    A,#00H
0079 5026              JNC     ?C0042
                                           ; SOURCE LINE # 609
                                           ; SOURCE LINE # 611
007B 900000      R     MOV     DPTR,#wakeupTime
007E E0                MOVX    A,@DPTR
007F FE                MOV     R6,A
0080 A3                INC     DPTR
0081 E0                MOVX    A,@DPTR
0082 FF                MOV     R7,A
0083 EF                MOV     A,R7
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 47  

0084 14                DEC     A
0085 FF                MOV     R7,A
0086 EF                MOV     A,R7
0087 540F              ANL     A,#0FH
0089 FF                MOV     R7,A
008A 120000      R     LCALL   _CyPmCtwSaveSet
                                           ; SOURCE LINE # 614
008D 900000      R     MOV     DPTR,#wakeupSource
0090 E0                MOVX    A,@DPTR
0091 FE                MOV     R6,A
0092 A3                INC     DPTR
0093 E0                MOVX    A,@DPTR
0094 FF                MOV     R7,A
0095 EE                MOV     A,R6
0096 4408              ORL     A,#08H
0098 FE                MOV     R6,A
0099 900000      R     MOV     DPTR,#wakeupSource
009C EE                MOV     A,R6
009D F0                MOVX    @DPTR,A
009E A3                INC     DPTR
009F EF                MOV     A,R7
00A0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 615
00A1         ?C0042:
                                           ; SOURCE LINE # 618
00A1 900000      R     MOV     DPTR,#wakeupTime
00A4 E0                MOVX    A,@DPTR
00A5 FE                MOV     R6,A
00A6 A3                INC     DPTR
00A7 E0                MOVX    A,@DPTR
00A8 FF                MOV     R7,A
00A9 EF                MOV     A,R7
00AA 6401              XRL     A,#01H
00AC 4E                ORL     A,R6
00AD 7017              JNZ     ?C0043
                                           ; SOURCE LINE # 619
                                           ; SOURCE LINE # 621
00AF 120000      R     LCALL   CyPmOppsSaveSet
                                           ; SOURCE LINE # 624
00B2 900000      R     MOV     DPTR,#wakeupSource
00B5 E0                MOVX    A,@DPTR
00B6 FE                MOV     R6,A
00B7 A3                INC     DPTR
00B8 E0                MOVX    A,@DPTR
00B9 FF                MOV     R7,A
00BA EE                MOV     A,R6
00BB 4408              ORL     A,#08H
00BD FE                MOV     R6,A
00BE 900000      R     MOV     DPTR,#wakeupSource
00C1 EE                MOV     A,R6
00C2 F0                MOVX    @DPTR,A
00C3 A3                INC     DPTR
00C4 EF                MOV     A,R7
00C5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 625
00C6         ?C0043:
                                           ; SOURCE LINE # 636
00C6 904398            MOV     DPTR,#04398H
00C9 E0                MOVX    A,@DPTR
00CA FF                MOV     R7,A
00CB 900000      R     MOV     DPTR,#cyPmBackup+01EH
00CE EF                MOV     A,R7
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 48  

00CF F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 637
00D0 900000      R     MOV     DPTR,#wakeupSource
00D3 E0                MOVX    A,@DPTR
00D4 FE                MOV     R6,A
00D5 A3                INC     DPTR
00D6 E0                MOVX    A,@DPTR
00D7 FF                MOV     R7,A
00D8 EE                MOV     A,R6
00D9 C4                SWAP    A
00DA F8                MOV     R0,A
00DB 54F0              ANL     A,#0F0H
00DD C8                XCH     A,R0
00DE 68                XRL     A,R0
00DF FE                MOV     R6,A
00E0 EF                MOV     A,R7
00E1 C4                SWAP    A
00E2 540F              ANL     A,#0FH
00E4 48                ORL     A,R0
00E5 FF                MOV     R7,A
00E6 EF                MOV     A,R7
00E7 54FF              ANL     A,#0FFH
00E9 FF                MOV     R7,A
00EA 904398            MOV     DPTR,#04398H
00ED EF                MOV     A,R7
00EE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 640
00EF 904399            MOV     DPTR,#04399H
00F2 E0                MOVX    A,@DPTR
00F3 FF                MOV     R7,A
00F4 900000      R     MOV     DPTR,#cyPmBackup+01FH
00F7 EF                MOV     A,R7
00F8 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 641
00F9 900000      R     MOV     DPTR,#wakeupSource
00FC E0                MOVX    A,@DPTR
00FD FE                MOV     R6,A
00FE A3                INC     DPTR
00FF E0                MOVX    A,@DPTR
0100 FF                MOV     R7,A
0101 EF                MOV     A,R7
0102 540F              ANL     A,#0FH
0104 FF                MOV     R7,A
0105 904399            MOV     DPTR,#04399H
0108 EF                MOV     A,R7
0109 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 647
010A 90439A            MOV     DPTR,#0439AH
010D E0                MOVX    A,@DPTR
010E FF                MOV     R7,A
010F 900000      R     MOV     DPTR,#cyPmBackup+020H
0112 EF                MOV     A,R7
0113 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 648
0114 900000      R     MOV     DPTR,#wakeupSource
0117 E0                MOVX    A,@DPTR
0118 FE                MOV     R6,A
0119 A3                INC     DPTR
011A E0                MOVX    A,@DPTR
011B FF                MOV     R7,A
011C EE                MOV     A,R6
011D C4                SWAP    A
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 49  

011E 540F              ANL     A,#0FH
0120 FF                MOV     R7,A
0121 7E00              MOV     R6,#00H
0123 EF                MOV     A,R7
0124 5401              ANL     A,#01H
0126 FF                MOV     R7,A
0127 90439A            MOV     DPTR,#0439AH
012A EF                MOV     A,R7
012B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 671
012C 120000      E     LCALL   CyEnterCriticalSection
012F 900000      R     MOV     DPTR,#cyPmBackup+014H
0132 EF                MOV     A,R7
0133 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 676
0134 904393            MOV     DPTR,#04393H
0137 E0                MOVX    A,@DPTR
0138 FF                MOV     R7,A
0139 EF                MOV     A,R7
013A 54F8              ANL     A,#0F8H
013C FF                MOV     R7,A
013D EF                MOV     A,R7
013E 4401              ORL     A,#01H
0140 FF                MOV     R7,A
0141 904393            MOV     DPTR,#04393H
0144 EF                MOV     A,R7
0145 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 679
0146 904393            MOV     DPTR,#04393H
0149 E0                MOVX    A,@DPTR
014A FF                MOV     R7,A
                                           ; SOURCE LINE # 682
014B 00                NOP     
                                           ; SOURCE LINE # 683
014C 00                NOP     
                                           ; SOURCE LINE # 710
014D 900000      R     MOV     DPTR,#cyPmBackup+014H
0150 E0                MOVX    A,@DPTR
0151 FF                MOV     R7,A
0152 120000      E     LCALL   _CyExitCriticalSection
                                           ; SOURCE LINE # 722
0155 900000      R     MOV     DPTR,#cyPmBackup+01EH
0158 E0                MOVX    A,@DPTR
0159 FF                MOV     R7,A
015A 904398            MOV     DPTR,#04398H
015D EF                MOV     A,R7
015E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 723
015F 900000      R     MOV     DPTR,#cyPmBackup+01FH
0162 E0                MOVX    A,@DPTR
0163 FF                MOV     R7,A
0164 904399            MOV     DPTR,#04399H
0167 EF                MOV     A,R7
0168 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 728
0169 900000      R     MOV     DPTR,#cyPmBackup+020H
016C E0                MOVX    A,@DPTR
016D FF                MOV     R7,A
016E 90439A            MOV     DPTR,#0439AH
0171 EF                MOV     A,R7
0172 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 733
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 50  

0173 22                RET     
             ; FUNCTION _CyPmAltAct (END)

             ; FUNCTION _CyPmSleep (BEGIN)
                                           ; SOURCE LINE # 832
0000 900000      R     MOV     DPTR,#wakeupTime
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
0005 900000      R     MOV     DPTR,#wakeupSource
0008 EC                MOV     A,R4
0009 F0                MOVX    @DPTR,A
000A A3                INC     DPTR
000B ED                MOV     A,R5
000C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 833
                                           ; SOURCE LINE # 838
000D 904393            MOV     DPTR,#04393H
0010 E0                MOVX    A,@DPTR
0011 FF                MOV     R7,A
0012 EF                MOV     A,R7
0013 5408              ANL     A,#08H
0015 FF                MOV     R7,A
0016 7E00              MOV     R6,#00H
0018 EF                MOV     A,R7
0019 4E                ORL     A,R6
001A 6003              JZ      $ + 5H
001C 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 839
                                           ; SOURCE LINE # 841
001F 904683            MOV     DPTR,#04683H
0022 E0                MOVX    A,@DPTR
0023 FF                MOV     R7,A
0024 EF                MOV     A,R7
0025 541F              ANL     A,#01FH
0027 FF                MOV     R7,A
0028 EF                MOV     A,R7
0029 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 842
                                           ; SOURCE LINE # 844
                                           ; SOURCE LINE # 847
002A         ?C0046:
                                           ; SOURCE LINE # 852
002A 900000      R     MOV     DPTR,#wakeupTime
002D E0                MOVX    A,@DPTR
002E FF                MOV     R7,A
002F EF                MOV     A,R7
0030 C3                CLR     C
0031 9402              SUBB    A,#02H
0033 402E              JC      ?C0048
0035 900000      R     MOV     DPTR,#wakeupTime
0038 E0                MOVX    A,@DPTR
0039 FF                MOV     R7,A
003A EF                MOV     A,R7
003B D3                SETB    C
003C 940D              SUBB    A,#0DH
003E 5023              JNC     ?C0048
                                           ; SOURCE LINE # 853
                                           ; SOURCE LINE # 855
0040 900000      R     MOV     DPTR,#wakeupTime
0043 E0                MOVX    A,@DPTR
0044 FF                MOV     R7,A
0045 EF                MOV     A,R7
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 51  

0046 14                DEC     A
0047 FF                MOV     R7,A
0048 EF                MOV     A,R7
0049 540F              ANL     A,#0FH
004B FF                MOV     R7,A
004C 120000      R     LCALL   _CyPmCtwSaveSet
                                           ; SOURCE LINE # 858
004F 900000      R     MOV     DPTR,#wakeupSource
0052 E0                MOVX    A,@DPTR
0053 FE                MOV     R6,A
0054 A3                INC     DPTR
0055 E0                MOVX    A,@DPTR
0056 FF                MOV     R7,A
0057 EE                MOV     A,R6
0058 4408              ORL     A,#08H
005A FE                MOV     R6,A
005B 900000      R     MOV     DPTR,#wakeupSource
005E EE                MOV     A,R6
005F F0                MOVX    @DPTR,A
0060 A3                INC     DPTR
0061 EF                MOV     A,R7
0062 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 859
0063         ?C0048:
                                           ; SOURCE LINE # 862
0063 900000      R     MOV     DPTR,#wakeupTime
0066 E0                MOVX    A,@DPTR
0067 FF                MOV     R7,A
0068 EF                MOV     A,R7
0069 B40117            CJNE    A,#01H,?C0049
                                           ; SOURCE LINE # 863
                                           ; SOURCE LINE # 865
006C 120000      R     LCALL   CyPmOppsSaveSet
                                           ; SOURCE LINE # 868
006F 900000      R     MOV     DPTR,#wakeupSource
0072 E0                MOVX    A,@DPTR
0073 FE                MOV     R6,A
0074 A3                INC     DPTR
0075 E0                MOVX    A,@DPTR
0076 FF                MOV     R7,A
0077 EE                MOV     A,R6
0078 4408              ORL     A,#08H
007A FE                MOV     R6,A
007B 900000      R     MOV     DPTR,#wakeupSource
007E EE                MOV     A,R6
007F F0                MOVX    @DPTR,A
0080 A3                INC     DPTR
0081 EF                MOV     A,R7
0082 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 869
0083         ?C0049:
                                           ; SOURCE LINE # 879
0083 904398            MOV     DPTR,#04398H
0086 E0                MOVX    A,@DPTR
0087 FF                MOV     R7,A
0088 900000      R     MOV     DPTR,#cyPmBackup+01EH
008B EF                MOV     A,R7
008C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 880
008D 900000      R     MOV     DPTR,#wakeupSource
0090 E0                MOVX    A,@DPTR
0091 FE                MOV     R6,A
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 52  

0092 A3                INC     DPTR
0093 E0                MOVX    A,@DPTR
0094 FF                MOV     R7,A
0095 EE                MOV     A,R6
0096 C4                SWAP    A
0097 F8                MOV     R0,A
0098 54F0              ANL     A,#0F0H
009A C8                XCH     A,R0
009B 68                XRL     A,R0
009C FE                MOV     R6,A
009D EF                MOV     A,R7
009E C4                SWAP    A
009F 540F              ANL     A,#0FH
00A1 48                ORL     A,R0
00A2 FF                MOV     R7,A
00A3 EF                MOV     A,R7
00A4 54FF              ANL     A,#0FFH
00A6 FF                MOV     R7,A
00A7 904398            MOV     DPTR,#04398H
00AA EF                MOV     A,R7
00AB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 883
00AC 904399            MOV     DPTR,#04399H
00AF E0                MOVX    A,@DPTR
00B0 FF                MOV     R7,A
00B1 900000      R     MOV     DPTR,#cyPmBackup+01FH
00B4 EF                MOV     A,R7
00B5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 884
00B6 900000      R     MOV     DPTR,#wakeupSource
00B9 E0                MOVX    A,@DPTR
00BA FE                MOV     R6,A
00BB A3                INC     DPTR
00BC E0                MOVX    A,@DPTR
00BD FF                MOV     R7,A
00BE EF                MOV     A,R7
00BF 540F              ANL     A,#0FH
00C1 FF                MOV     R7,A
00C2 904399            MOV     DPTR,#04399H
00C5 EF                MOV     A,R7
00C6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 890
00C7 90439A            MOV     DPTR,#0439AH
00CA E0                MOVX    A,@DPTR
00CB FF                MOV     R7,A
00CC 900000      R     MOV     DPTR,#cyPmBackup+020H
00CF EF                MOV     A,R7
00D0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 891
00D1 900000      R     MOV     DPTR,#wakeupSource
00D4 E0                MOVX    A,@DPTR
00D5 FE                MOV     R6,A
00D6 A3                INC     DPTR
00D7 E0                MOVX    A,@DPTR
00D8 FF                MOV     R7,A
00D9 EE                MOV     A,R6
00DA C4                SWAP    A
00DB 540F              ANL     A,#0FH
00DD FF                MOV     R7,A
00DE 7E00              MOV     R6,#00H
00E0 EF                MOV     A,R7
00E1 5401              ANL     A,#01H
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 53  

00E3 FF                MOV     R7,A
00E4 90439A            MOV     DPTR,#0439AH
00E7 EF                MOV     A,R7
00E8 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 906
00E9 7F03              MOV     R7,#03H
00EB 120000      R     LCALL   _CyPmHibSlpSaveSet
                                           ; SOURCE LINE # 912
00EE 120000      E     LCALL   CyEnterCriticalSection
00F1 900000      R     MOV     DPTR,#cyPmBackup+014H
00F4 EF                MOV     A,R7
00F5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 915
00F6 904689            MOV     DPTR,#04689H
00F9 E0                MOVX    A,@DPTR
00FA FF                MOV     R7,A
00FB EF                MOV     A,R7
00FC B40106            CJNE    A,#01H,?C0051
00FF 7E00              MOV     R6,#00H
0101 7F01              MOV     R7,#01H
0103 8004              SJMP    ?C0052
0105         ?C0051:
0105 7E00              MOV     R6,#00H
0107 7F00              MOV     R7,#00H
0109         ?C0052:
0109 EF                MOV     A,R7
010A 30E01D            JNB     ACC.0,?C0050
                                           ; SOURCE LINE # 916
                                           ; SOURCE LINE # 918
010D 904331            MOV     DPTR,#04331H
0110 E0                MOVX    A,@DPTR
0111 FF                MOV     R7,A
0112 EF                MOV     A,R7
0113 54FD              ANL     A,#0FDH
0115 FF                MOV     R7,A
0116 EF                MOV     A,R7
0117 4401              ORL     A,#01H
0119 FF                MOV     R7,A
011A 904331            MOV     DPTR,#04331H
011D EF                MOV     A,R7
011E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 921
011F 904331            MOV     DPTR,#04331H
0122 E0                MOVX    A,@DPTR
0123 FF                MOV     R7,A
0124 EF                MOV     A,R7
0125 4402              ORL     A,#02H
0127 FF                MOV     R7,A
0128 EF                MOV     A,R7
0129 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 922
012A         ?C0050:
                                           ; SOURCE LINE # 927
012A 904393            MOV     DPTR,#04393H
012D E0                MOVX    A,@DPTR
012E FF                MOV     R7,A
012F EF                MOV     A,R7
0130 54F8              ANL     A,#0F8H
0132 FF                MOV     R7,A
0133 EF                MOV     A,R7
0134 4403              ORL     A,#03H
0136 FF                MOV     R7,A
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 54  

0137 904393            MOV     DPTR,#04393H
013A EF                MOV     A,R7
013B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 930
013C 904393            MOV     DPTR,#04393H
013F E0                MOVX    A,@DPTR
0140 FF                MOV     R7,A
                                           ; SOURCE LINE # 933
0141 00                NOP     
                                           ; SOURCE LINE # 934
0142 00                NOP     
                                           ; SOURCE LINE # 958
0143 900000      R     MOV     DPTR,#cyPmBackup+016H
0146 E0                MOVX    A,@DPTR
0147 FF                MOV     R7,A
0148 7E14              MOV     R6,#014H
014A EF                MOV     A,R7
014B 8EF0              MOV     B,R6
014D A4                MUL     AB
014E FF                MOV     R7,A
014F AEF0              MOV     R6,B
0151 E4                CLR     A
0152 FC                MOV     R4,A
0153 FD                MOV     R5,A
0154 120000      E     LCALL   _CyDelayCycles
                                           ; SOURCE LINE # 964
0157 904689            MOV     DPTR,#04689H
015A E0                MOVX    A,@DPTR
015B FF                MOV     R7,A
015C EF                MOV     A,R7
015D B40106            CJNE    A,#01H,?C0054
0160 7E00              MOV     R6,#00H
0162 7F01              MOV     R7,#01H
0164 8004              SJMP    ?C0055
0166         ?C0054:
0166 7E00              MOV     R6,#00H
0168 7F00              MOV     R7,#00H
016A         ?C0055:
016A EF                MOV     A,R7
016B 30E016            JNB     ACC.0,?C0053
                                           ; SOURCE LINE # 965
                                           ; SOURCE LINE # 967
016E 904331            MOV     DPTR,#04331H
0171 E0                MOVX    A,@DPTR
0172 FF                MOV     R7,A
0173 EF                MOV     A,R7
0174 54FD              ANL     A,#0FDH
0176 FF                MOV     R7,A
0177 EF                MOV     A,R7
0178 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 970
0179 904331            MOV     DPTR,#04331H
017C E0                MOVX    A,@DPTR
017D FF                MOV     R7,A
017E EF                MOV     A,R7
017F 54FE              ANL     A,#0FEH
0181 FF                MOV     R7,A
0182 EF                MOV     A,R7
0183 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 971
0184         ?C0053:
                                           ; SOURCE LINE # 974
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 55  

0184 900000      R     MOV     DPTR,#cyPmBackup+014H
0187 E0                MOVX    A,@DPTR
0188 FF                MOV     R7,A
0189 120000      E     LCALL   _CyExitCriticalSection
                                           ; SOURCE LINE # 979
018C 120000      R     LCALL   CyPmHibSlpRestore
                                           ; SOURCE LINE # 989
018F 900000      R     MOV     DPTR,#cyPmBackup+01EH
0192 E0                MOVX    A,@DPTR
0193 FF                MOV     R7,A
0194 904398            MOV     DPTR,#04398H
0197 EF                MOV     A,R7
0198 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 990
0199 900000      R     MOV     DPTR,#cyPmBackup+01FH
019C E0                MOVX    A,@DPTR
019D FF                MOV     R7,A
019E 904399            MOV     DPTR,#04399H
01A1 EF                MOV     A,R7
01A2 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 995
01A3 900000      R     MOV     DPTR,#cyPmBackup+020H
01A6 E0                MOVX    A,@DPTR
01A7 FF                MOV     R7,A
01A8 90439A            MOV     DPTR,#0439AH
01AB EF                MOV     A,R7
01AC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1000
01AD         ?C0047:
01AD 22                RET     
             ; FUNCTION _CyPmSleep (END)

             ; FUNCTION CyPmHibernate (BEGIN)
                                           ; SOURCE LINE # 1039
                                           ; SOURCE LINE # 1040
                                           ; SOURCE LINE # 1045
0000 904393            MOV     DPTR,#04393H
0003 E0                MOVX    A,@DPTR
0004 FF                MOV     R7,A
0005 EF                MOV     A,R7
0006 5408              ANL     A,#08H
0008 FF                MOV     R7,A
0009 7E00              MOV     R6,#00H
000B EF                MOV     A,R7
000C 4E                ORL     A,R6
000D 6003              JZ      $ + 5H
000F 020000      R     LJMP    ?C0058
                                           ; SOURCE LINE # 1046
                                           ; SOURCE LINE # 1048
0012 904683            MOV     DPTR,#04683H
0015 E0                MOVX    A,@DPTR
0016 FF                MOV     R7,A
0017 EF                MOV     A,R7
0018 541F              ANL     A,#01FH
001A FF                MOV     R7,A
001B EF                MOV     A,R7
001C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1049
                                           ; SOURCE LINE # 1051
                                           ; SOURCE LINE # 1057
001D         ?C0057:
                                           ; SOURCE LINE # 1062
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 56  

001D 120000      R     LCALL   CyPmHibSaveSet
                                           ; SOURCE LINE # 1072
0020 904398            MOV     DPTR,#04398H
0023 E0                MOVX    A,@DPTR
0024 FF                MOV     R7,A
0025 900000      R     MOV     DPTR,#cyPmBackup+01EH
0028 EF                MOV     A,R7
0029 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1073
002A 904398            MOV     DPTR,#04398H
002D 7404              MOV     A,#04H
002F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1076
0030 904399            MOV     DPTR,#04399H
0033 E0                MOVX    A,@DPTR
0034 FF                MOV     R7,A
0035 900000      R     MOV     DPTR,#cyPmBackup+01FH
0038 EF                MOV     A,R7
0039 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1077
003A 904399            MOV     DPTR,#04399H
003D E4                CLR     A
003E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1083
003F 90439A            MOV     DPTR,#0439AH
0042 E0                MOVX    A,@DPTR
0043 FF                MOV     R7,A
0044 900000      R     MOV     DPTR,#cyPmBackup+020H
0047 EF                MOV     A,R7
0048 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1084
0049 90439A            MOV     DPTR,#0439AH
004C E4                CLR     A
004D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1094
004E 120000      E     LCALL   CyEnterCriticalSection
0051 900000      R     MOV     DPTR,#cyPmBackup+014H
0054 EF                MOV     A,R7
0055 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1099
0056 904393            MOV     DPTR,#04393H
0059 E0                MOVX    A,@DPTR
005A FF                MOV     R7,A
005B EF                MOV     A,R7
005C 54F8              ANL     A,#0F8H
005E FF                MOV     R7,A
005F EF                MOV     A,R7
0060 4404              ORL     A,#04H
0062 FF                MOV     R7,A
0063 904393            MOV     DPTR,#04393H
0066 EF                MOV     A,R7
0067 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1102
0068 904393            MOV     DPTR,#04393H
006B E0                MOVX    A,@DPTR
006C FF                MOV     R7,A
                                           ; SOURCE LINE # 1105
006D 00                NOP     
                                           ; SOURCE LINE # 1106
006E 00                NOP     
                                           ; SOURCE LINE # 1133
006F 900000      R     MOV     DPTR,#cyPmBackup+014H
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 57  

0072 E0                MOVX    A,@DPTR
0073 FF                MOV     R7,A
0074 120000      E     LCALL   _CyExitCriticalSection
                                           ; SOURCE LINE # 1138
0077 120000      R     LCALL   CyPmHibRestore
                                           ; SOURCE LINE # 1146
007A 900000      R     MOV     DPTR,#cyPmBackup+01EH
007D E0                MOVX    A,@DPTR
007E FF                MOV     R7,A
007F 904398            MOV     DPTR,#04398H
0082 EF                MOV     A,R7
0083 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1147
0084 900000      R     MOV     DPTR,#cyPmBackup+01FH
0087 E0                MOVX    A,@DPTR
0088 FF                MOV     R7,A
0089 904399            MOV     DPTR,#04399H
008C EF                MOV     A,R7
008D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1152
008E 900000      R     MOV     DPTR,#cyPmBackup+020H
0091 E0                MOVX    A,@DPTR
0092 FF                MOV     R7,A
0093 90439A            MOV     DPTR,#0439AH
0096 EF                MOV     A,R7
0097 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1157
0098         ?C0058:
0098 22                RET     
             ; FUNCTION CyPmHibernate (END)

             ; FUNCTION _CyPmReadStatus (BEGIN)
                                           ; SOURCE LINE # 1192
0000 900000      R     MOV     DPTR,#mask
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1193
                                           ; SOURCE LINE # 1199
0005 120000      E     LCALL   CyEnterCriticalSection
0008 900000      R     MOV     DPTR,#interruptState
000B EF                MOV     A,R7
000C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1202
000D 900000      R     MOV     DPTR,#interruptStatus
0010 E0                MOVX    A,@DPTR
0011 FF                MOV     R7,A
0012 904390            MOV     DPTR,#04390H
0015 E0                MOVX    A,@DPTR
0016 FE                MOV     R6,A
0017 EF                MOV     A,R7
0018 4E                ORL     A,R6
0019 FF                MOV     R7,A
001A 900000      R     MOV     DPTR,#interruptStatus
001D EF                MOV     A,R7
001E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1203
001F 900000      R     MOV     DPTR,#interruptStatus
0022 E0                MOVX    A,@DPTR
0023 FF                MOV     R7,A
0024 900000      R     MOV     DPTR,#tmpStatus
0027 EF                MOV     A,R7
0028 F0                MOVX    @DPTR,A
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 58  

                                           ; SOURCE LINE # 1204
0029 900000      R     MOV     DPTR,#interruptStatus
002C E0                MOVX    A,@DPTR
002D FF                MOV     R7,A
002E 900000      R     MOV     DPTR,#mask
0031 E0                MOVX    A,@DPTR
0032 FE                MOV     R6,A
0033 EE                MOV     A,R6
0034 F4                CPL     A
0035 FE                MOV     R6,A
0036 EF                MOV     A,R7
0037 5E                ANL     A,R6
0038 FF                MOV     R7,A
0039 900000      R     MOV     DPTR,#interruptStatus
003C EF                MOV     A,R7
003D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1207
003E 900000      R     MOV     DPTR,#interruptState
0041 E0                MOVX    A,@DPTR
0042 FF                MOV     R7,A
0043 120000      E     LCALL   _CyExitCriticalSection
                                           ; SOURCE LINE # 1209
0046 900000      R     MOV     DPTR,#tmpStatus
0049 E0                MOVX    A,@DPTR
004A FF                MOV     R7,A
                                           ; SOURCE LINE # 1210
004B         ?C0059:
004B 22                RET     
             ; FUNCTION _CyPmReadStatus (END)

             ; FUNCTION CyPmHibSaveSet (BEGIN)
                                           ; SOURCE LINE # 1235
                                           ; SOURCE LINE # 1236
                                           ; SOURCE LINE # 1238
0000 904331            MOV     DPTR,#04331H
0003 E0                MOVX    A,@DPTR
0004 FF                MOV     R7,A
0005 EF                MOV     A,R7
0006 5404              ANL     A,#04H
0008 FF                MOV     R7,A
0009 7E00              MOV     R6,#00H
000B EF                MOV     A,R7
000C 4E                ORL     A,R6
000D 6013              JZ      ?C0060
                                           ; SOURCE LINE # 1239
                                           ; SOURCE LINE # 1241
000F 900000      R     MOV     DPTR,#cyPmBackup+012H
0012 7401              MOV     A,#01H
0014 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1242
0015 904331            MOV     DPTR,#04331H
0018 E0                MOVX    A,@DPTR
0019 FF                MOV     R7,A
001A EF                MOV     A,R7
001B 54FB              ANL     A,#0FBH
001D FF                MOV     R7,A
001E EF                MOV     A,R7
001F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1243
0020 8005              SJMP    ?C0061
0022         ?C0060:
                                           ; SOURCE LINE # 1245
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 59  

                                           ; SOURCE LINE # 1247
0022 900000      R     MOV     DPTR,#cyPmBackup+012H
0025 E4                CLR     A
0026 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1248
0027         ?C0061:
                                           ; SOURCE LINE # 1254
0027 7F01              MOV     R7,#01H
0029 120000      E     LCALL   _CyILO_SetPowerMode
002C 900000      R     MOV     DPTR,#cyPmBackup+0DH
002F EF                MOV     A,R7
0030 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1257
0031 904300            MOV     DPTR,#04300H
0034 E0                MOVX    A,@DPTR
0035 FF                MOV     R7,A
0036 EF                MOV     A,R7
0037 5402              ANL     A,#02H
0039 FF                MOV     R7,A
003A 7E00              MOV     R6,#00H
003C EF                MOV     A,R7
003D 4E                ORL     A,R6
003E 6004              JZ      ?C0062
0040 7F01              MOV     R7,#01H
0042 8002              SJMP    ?C0063
0044         ?C0062:
0044 7F00              MOV     R7,#00H
0046         ?C0063:
0046 900000      R     MOV     DPTR,#cyPmBackup+0EH
0049 EF                MOV     A,R7
004A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1261
004B 904300            MOV     DPTR,#04300H
004E E0                MOVX    A,@DPTR
004F FF                MOV     R7,A
0050 EF                MOV     A,R7
0051 5404              ANL     A,#04H
0053 FF                MOV     R7,A
0054 7E00              MOV     R6,#00H
0056 EF                MOV     A,R7
0057 4E                ORL     A,R6
0058 6004              JZ      ?C0064
005A 7F01              MOV     R7,#01H
005C 8002              SJMP    ?C0065
005E         ?C0064:
005E 7F00              MOV     R7,#00H
0060         ?C0065:
0060 900000      R     MOV     DPTR,#cyPmBackup+0FH
0063 EF                MOV     A,R7
0064 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1269
0065 904683            MOV     DPTR,#04683H
0068 E0                MOVX    A,@DPTR
0069 FF                MOV     R7,A
006A EF                MOV     A,R7
006B 5410              ANL     A,#010H
006D FF                MOV     R7,A
006E 7E00              MOV     R6,#00H
0070 EF                MOV     A,R7
0071 4E                ORL     A,R6
0072 7012              JNZ     ?C0066
                                           ; SOURCE LINE # 1270
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 60  

                                           ; SOURCE LINE # 1272
0074 900000      R     MOV     DPTR,#cyPmBackup+017H
0077 E4                CLR     A
0078 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1275
0079 904683            MOV     DPTR,#04683H
007C E0                MOVX    A,@DPTR
007D FF                MOV     R7,A
007E EF                MOV     A,R7
007F 4410              ORL     A,#010H
0081 FF                MOV     R7,A
0082 EF                MOV     A,R7
0083 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1276
0084 8006              SJMP    ?C0067
0086         ?C0066:
                                           ; SOURCE LINE # 1278
                                           ; SOURCE LINE # 1280
0086 900000      R     MOV     DPTR,#cyPmBackup+017H
0089 7401              MOV     A,#01H
008B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1281
008C         ?C0067:
                                           ; SOURCE LINE # 1291
008C 904330            MOV     DPTR,#04330H
008F E0                MOVX    A,@DPTR
0090 FF                MOV     R7,A
0091 EF                MOV     A,R7
0092 5410              ANL     A,#010H
0094 FF                MOV     R7,A
0095 7E00              MOV     R6,#00H
0097 EF                MOV     A,R7
0098 4E                ORL     A,R6
0099 603D              JZ      ?C0068
009B 904330            MOV     DPTR,#04330H
009E E0                MOVX    A,@DPTR
009F FF                MOV     R7,A
00A0 EF                MOV     A,R7
00A1 5420              ANL     A,#020H
00A3 FF                MOV     R7,A
00A4 7E00              MOV     R6,#00H
00A6 EF                MOV     A,R7
00A7 4E                ORL     A,R6
00A8 602E              JZ      ?C0068
                                           ; SOURCE LINE # 1292
                                           ; SOURCE LINE # 1294
00AA 904689            MOV     DPTR,#04689H
00AD E0                MOVX    A,@DPTR
00AE FF                MOV     R7,A
00AF EF                MOV     A,R7
00B0 6006              JZ      ?C0070
00B2 7E00              MOV     R6,#00H
00B4 7F01              MOV     R7,#01H
00B6 8004              SJMP    ?C0071
00B8         ?C0070:
00B8 7E00              MOV     R6,#00H
00BA 7F00              MOV     R7,#00H
00BC         ?C0071:
00BC EF                MOV     A,R7
00BD 30E213            JNB     ACC.2,?C0069
                                           ; SOURCE LINE # 1295
                                           ; SOURCE LINE # 1297
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 61  

00C0 900000      R     MOV     DPTR,#cyPmBackup+013H
00C3 7401              MOV     A,#01H
00C5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1300
00C6 904689            MOV     DPTR,#04689H
00C9 E0                MOVX    A,@DPTR
00CA FF                MOV     R7,A
00CB EF                MOV     A,R7
00CC 54FB              ANL     A,#0FBH
00CE FF                MOV     R7,A
00CF EF                MOV     A,R7
00D0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1301
00D1 8005              SJMP    ?C0068
00D3         ?C0069:
                                           ; SOURCE LINE # 1303
                                           ; SOURCE LINE # 1305
00D3 900000      R     MOV     DPTR,#cyPmBackup+013H
00D6 E4                CLR     A
00D7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1306
                                           ; SOURCE LINE # 1307
00D8         ?C0068:
                                           ; SOURCE LINE # 1312
00D8 7F04              MOV     R7,#04H
00DA 120000      R     LCALL   _CyPmHibSlpSaveSet
                                           ; SOURCE LINE # 1313
00DD 22                RET     
             ; FUNCTION CyPmHibSaveSet (END)

             ; FUNCTION CyPmHibRestore (BEGIN)
                                           ; SOURCE LINE # 1335
                                           ; SOURCE LINE # 1336
                                           ; SOURCE LINE # 1338
0000 120000      R     LCALL   CyPmHibSlpRestore
                                           ; SOURCE LINE # 1341
0003 900000      R     MOV     DPTR,#cyPmBackup+012H
0006 E0                MOVX    A,@DPTR
0007 FF                MOV     R7,A
0008 EF                MOV     A,R7
0009 B4010B            CJNE    A,#01H,?C0074
                                           ; SOURCE LINE # 1342
                                           ; SOURCE LINE # 1344
000C 904331            MOV     DPTR,#04331H
000F E0                MOVX    A,@DPTR
0010 FF                MOV     R7,A
0011 EF                MOV     A,R7
0012 4404              ORL     A,#04H
0014 FF                MOV     R7,A
0015 EF                MOV     A,R7
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1345
0017         ?C0074:
                                           ; SOURCE LINE # 1351
0017 900000      R     MOV     DPTR,#cyPmBackup+0EH
001A E0                MOVX    A,@DPTR
001B FF                MOV     R7,A
001C EF                MOV     A,R7
001D B40103            CJNE    A,#01H,?C0075
                                           ; SOURCE LINE # 1352
                                           ; SOURCE LINE # 1354
0020 120000      E     LCALL   CyILO_Start1K
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 62  

                                           ; SOURCE LINE # 1355
0023         ?C0075:
                                           ; SOURCE LINE # 1358
0023 900000      R     MOV     DPTR,#cyPmBackup+0FH
0026 E0                MOVX    A,@DPTR
0027 FF                MOV     R7,A
0028 EF                MOV     A,R7
0029 B40103            CJNE    A,#01H,?C0076
                                           ; SOURCE LINE # 1359
                                           ; SOURCE LINE # 1361
002C 120000      E     LCALL   CyILO_Start100K
                                           ; SOURCE LINE # 1362
002F         ?C0076:
                                           ; SOURCE LINE # 1365
002F 900000      R     MOV     DPTR,#cyPmBackup+0DH
0032 E0                MOVX    A,@DPTR
0033 FF                MOV     R7,A
0034 120000      E     LCALL   _CyILO_SetPowerMode
                                           ; SOURCE LINE # 1372
0037 900000      R     MOV     DPTR,#cyPmBackup+017H
003A E0                MOVX    A,@DPTR
003B FF                MOV     R7,A
003C EF                MOV     A,R7
003D 700B              JNZ     ?C0077
                                           ; SOURCE LINE # 1373
                                           ; SOURCE LINE # 1375
003F 904683            MOV     DPTR,#04683H
0042 E0                MOVX    A,@DPTR
0043 FF                MOV     R7,A
0044 EF                MOV     A,R7
0045 54EF              ANL     A,#0EFH
0047 FF                MOV     R7,A
0048 EF                MOV     A,R7
0049 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1376
004A         ?C0077:
                                           ; SOURCE LINE # 1384
004A 900000      R     MOV     DPTR,#cyPmBackup+013H
004D E0                MOVX    A,@DPTR
004E FF                MOV     R7,A
004F EF                MOV     A,R7
0050 B4010B            CJNE    A,#01H,?C0079
                                           ; SOURCE LINE # 1385
                                           ; SOURCE LINE # 1387
0053 904689            MOV     DPTR,#04689H
0056 E0                MOVX    A,@DPTR
0057 FF                MOV     R7,A
0058 EF                MOV     A,R7
0059 4404              ORL     A,#04H
005B FF                MOV     R7,A
005C EF                MOV     A,R7
005D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1388
                                           ; SOURCE LINE # 1391
005E         ?C0079:
005E 22                RET     
             ; FUNCTION CyPmHibRestore (END)

             ; FUNCTION _CyPmCtwSaveSet (BEGIN)
                                           ; SOURCE LINE # 1417
0000 900000      R     MOV     DPTR,#ctwInterval
0003 EF                MOV     A,R7
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 63  

0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1418
                                           ; SOURCE LINE # 1420
0005 7F01              MOV     R7,#01H
0007 120000      E     LCALL   _CyILO_SetPowerMode
                                           ; SOURCE LINE # 1423
000A 904382            MOV     DPTR,#04382H
000D E0                MOVX    A,@DPTR
000E FF                MOV     R7,A
000F EF                MOV     A,R7
0010 5408              ANL     A,#08H
0012 FF                MOV     R7,A
0013 7E00              MOV     R6,#00H
0015 EF                MOV     A,R7
0016 4E                ORL     A,R6
0017 600B              JZ      ?C0080
                                           ; SOURCE LINE # 1424
                                           ; SOURCE LINE # 1426
0019 904382            MOV     DPTR,#04382H
001C E0                MOVX    A,@DPTR
001D FF                MOV     R7,A
001E EF                MOV     A,R7
001F 54F7              ANL     A,#0F7H
0021 FF                MOV     R7,A
0022 EF                MOV     A,R7
0023 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1427
0024         ?C0080:
                                           ; SOURCE LINE # 1430
0024 904300            MOV     DPTR,#04300H
0027 E0                MOVX    A,@DPTR
0028 FF                MOV     R7,A
0029 EF                MOV     A,R7
002A 5402              ANL     A,#02H
002C FF                MOV     R7,A
002D 7E00              MOV     R6,#00H
002F EF                MOV     A,R7
0030 4E                ORL     A,R6
0031 7003              JNZ     ?C0081
                                           ; SOURCE LINE # 1431
                                           ; SOURCE LINE # 1433
0033 120000      E     LCALL   CyILO_Start1K
                                           ; SOURCE LINE # 1434
0036         ?C0081:
                                           ; SOURCE LINE # 1437
0036 904382            MOV     DPTR,#04382H
0039 E0                MOVX    A,@DPTR
003A FF                MOV     R7,A
003B EF                MOV     A,R7
003C 5404              ANL     A,#04H
003E FF                MOV     R7,A
003F 7E00              MOV     R6,#00H
0041 EF                MOV     A,R7
0042 4E                ORL     A,R6
0043 602F              JZ      ?C0082
                                           ; SOURCE LINE # 1438
                                           ; SOURCE LINE # 1440
0045 900000      R     MOV     DPTR,#ctwInterval
0048 E0                MOVX    A,@DPTR
0049 FF                MOV     R7,A
004A 904381            MOV     DPTR,#04381H
004D E0                MOVX    A,@DPTR
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 64  

004E FE                MOV     R6,A
004F EE                MOV     A,R6
0050 6F                XRL     A,R7
0051 6044              JZ      ?C0086
                                           ; SOURCE LINE # 1441
                                           ; SOURCE LINE # 1443
0053 904382            MOV     DPTR,#04382H
0056 E0                MOVX    A,@DPTR
0057 FF                MOV     R7,A
0058 EF                MOV     A,R7
0059 54FB              ANL     A,#0FBH
005B FF                MOV     R7,A
005C EF                MOV     A,R7
005D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1444
005E 900000      R     MOV     DPTR,#ctwInterval
0061 E0                MOVX    A,@DPTR
0062 FF                MOV     R7,A
0063 904381            MOV     DPTR,#04381H
0066 EF                MOV     A,R7
0067 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1445
0068 904382            MOV     DPTR,#04382H
006B E0                MOVX    A,@DPTR
006C FF                MOV     R7,A
006D EF                MOV     A,R7
006E 4404              ORL     A,#04H
0070 FF                MOV     R7,A
0071 EF                MOV     A,R7
0072 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1446
                                           ; SOURCE LINE # 1447
0073 22                RET     
0074         ?C0082:
                                           ; SOURCE LINE # 1449
                                           ; SOURCE LINE # 1451
0074 900000      R     MOV     DPTR,#ctwInterval
0077 E0                MOVX    A,@DPTR
0078 FF                MOV     R7,A
0079 904381            MOV     DPTR,#04381H
007C E0                MOVX    A,@DPTR
007D FE                MOV     R6,A
007E EE                MOV     A,R6
007F 6F                XRL     A,R7
0080 600A              JZ      ?C0085
                                           ; SOURCE LINE # 1452
                                           ; SOURCE LINE # 1454
0082 900000      R     MOV     DPTR,#ctwInterval
0085 E0                MOVX    A,@DPTR
0086 FF                MOV     R7,A
0087 904381            MOV     DPTR,#04381H
008A EF                MOV     A,R7
008B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1455
008C         ?C0085:
                                           ; SOURCE LINE # 1458
008C 904382            MOV     DPTR,#04382H
008F E0                MOVX    A,@DPTR
0090 FF                MOV     R7,A
0091 EF                MOV     A,R7
0092 4404              ORL     A,#04H
0094 FF                MOV     R7,A
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 65  

0095 EF                MOV     A,R7
0096 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1459
                                           ; SOURCE LINE # 1460
0097         ?C0086:
0097 22                RET     
             ; FUNCTION _CyPmCtwSaveSet (END)

             ; FUNCTION CyPmOppsSaveSet (BEGIN)
                                           ; SOURCE LINE # 1486
                                           ; SOURCE LINE # 1487
                                           ; SOURCE LINE # 1489
0000 7F01              MOV     R7,#01H
0002 120000      E     LCALL   _CyXTAL_32KHZ_SetPowerMode
                                           ; SOURCE LINE # 1492
0005 904308            MOV     DPTR,#04308H
0008 E0                MOVX    A,@DPTR
0009 FF                MOV     R7,A
000A EF                MOV     A,R7
000B 5401              ANL     A,#01H
000D FF                MOV     R7,A
000E 7E00              MOV     R6,#00H
0010 EF                MOV     A,R7
0011 4E                ORL     A,R6
0012 7003              JNZ     ?C0087
                                           ; SOURCE LINE # 1493
                                           ; SOURCE LINE # 1495
0014 120000      E     LCALL   CyXTAL_32KHZ_Start
                                           ; SOURCE LINE # 1496
0017         ?C0087:
                                           ; SOURCE LINE # 1499
0017 904382            MOV     DPTR,#04382H
001A E0                MOVX    A,@DPTR
001B FF                MOV     R7,A
001C EF                MOV     A,R7
001D 5420              ANL     A,#020H
001F FF                MOV     R7,A
0020 7E00              MOV     R6,#00H
0022 EF                MOV     A,R7
0023 4E                ORL     A,R6
0024 600B              JZ      ?C0088
                                           ; SOURCE LINE # 1500
                                           ; SOURCE LINE # 1502
0026 904382            MOV     DPTR,#04382H
0029 E0                MOVX    A,@DPTR
002A FF                MOV     R7,A
002B EF                MOV     A,R7
002C 54DF              ANL     A,#0DFH
002E FF                MOV     R7,A
002F EF                MOV     A,R7
0030 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1503
0031         ?C0088:
                                           ; SOURCE LINE # 1506
0031 904382            MOV     DPTR,#04382H
0034 E0                MOVX    A,@DPTR
0035 FF                MOV     R7,A
0036 EF                MOV     A,R7
0037 5410              ANL     A,#010H
0039 FF                MOV     R7,A
003A 7E00              MOV     R6,#00H
003C EF                MOV     A,R7
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 66  

003D 4E                ORL     A,R6
003E 700B              JNZ     ?C0090
                                           ; SOURCE LINE # 1507
                                           ; SOURCE LINE # 1509
0040 904382            MOV     DPTR,#04382H
0043 E0                MOVX    A,@DPTR
0044 FF                MOV     R7,A
0045 EF                MOV     A,R7
0046 4410              ORL     A,#010H
0048 FF                MOV     R7,A
0049 EF                MOV     A,R7
004A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1510
                                           ; SOURCE LINE # 1511
004B         ?C0090:
004B 22                RET     
             ; FUNCTION CyPmOppsSaveSet (END)

             ; FUNCTION _CyPmFtwSaveSet (BEGIN)
                                           ; SOURCE LINE # 1537
0000 900000      R     MOV     DPTR,#ftwInterval
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1538
                                           ; SOURCE LINE # 1540
0005 7F01              MOV     R7,#01H
0007 120000      E     LCALL   _CyILO_SetPowerMode
                                           ; SOURCE LINE # 1543
000A 904300            MOV     DPTR,#04300H
000D E0                MOVX    A,@DPTR
000E FF                MOV     R7,A
000F EF                MOV     A,R7
0010 5404              ANL     A,#04H
0012 FF                MOV     R7,A
0013 7E00              MOV     R6,#00H
0015 EF                MOV     A,R7
0016 4E                ORL     A,R6
0017 7003              JNZ     ?C0091
                                           ; SOURCE LINE # 1544
                                           ; SOURCE LINE # 1546
0019 120000      E     LCALL   CyILO_Start100K
                                           ; SOURCE LINE # 1547
001C         ?C0091:
                                           ; SOURCE LINE # 1550
001C 904382            MOV     DPTR,#04382H
001F E0                MOVX    A,@DPTR
0020 FF                MOV     R7,A
0021 EF                MOV     A,R7
0022 5401              ANL     A,#01H
0024 FF                MOV     R7,A
0025 7E00              MOV     R6,#00H
0027 EF                MOV     A,R7
0028 4E                ORL     A,R6
0029 6030              JZ      ?C0092
                                           ; SOURCE LINE # 1551
                                           ; SOURCE LINE # 1553
002B 900000      R     MOV     DPTR,#ftwInterval
002E E0                MOVX    A,@DPTR
002F FF                MOV     R7,A
0030 904380            MOV     DPTR,#04380H
0033 E0                MOVX    A,@DPTR
0034 FE                MOV     R6,A
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 67  

0035 EE                MOV     A,R6
0036 6F                XRL     A,R7
0037 6045              JZ      ?C0094
                                           ; SOURCE LINE # 1554
                                           ; SOURCE LINE # 1556
0039 904382            MOV     DPTR,#04382H
003C E0                MOVX    A,@DPTR
003D FF                MOV     R7,A
003E EF                MOV     A,R7
003F 54FE              ANL     A,#0FEH
0041 FF                MOV     R7,A
0042 EF                MOV     A,R7
0043 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1557
0044 900000      R     MOV     DPTR,#ftwInterval
0047 E0                MOVX    A,@DPTR
0048 FF                MOV     R7,A
0049 904380            MOV     DPTR,#04380H
004C EF                MOV     A,R7
004D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1558
004E 904382            MOV     DPTR,#04382H
0051 E0                MOVX    A,@DPTR
0052 FF                MOV     R7,A
0053 EF                MOV     A,R7
0054 4401              ORL     A,#01H
0056 FF                MOV     R7,A
0057 EF                MOV     A,R7
0058 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1559
                                           ; SOURCE LINE # 1560
0059 8023              SJMP    ?C0094
005B         ?C0092:
                                           ; SOURCE LINE # 1562
                                           ; SOURCE LINE # 1564
005B 900000      R     MOV     DPTR,#ftwInterval
005E E0                MOVX    A,@DPTR
005F FF                MOV     R7,A
0060 904380            MOV     DPTR,#04380H
0063 E0                MOVX    A,@DPTR
0064 FE                MOV     R6,A
0065 EE                MOV     A,R6
0066 6F                XRL     A,R7
0067 600A              JZ      ?C0095
                                           ; SOURCE LINE # 1565
                                           ; SOURCE LINE # 1567
0069 900000      R     MOV     DPTR,#ftwInterval
006C E0                MOVX    A,@DPTR
006D FF                MOV     R7,A
006E 904380            MOV     DPTR,#04380H
0071 EF                MOV     A,R7
0072 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1568
0073         ?C0095:
                                           ; SOURCE LINE # 1571
0073 904382            MOV     DPTR,#04382H
0076 E0                MOVX    A,@DPTR
0077 FF                MOV     R7,A
0078 EF                MOV     A,R7
0079 4401              ORL     A,#01H
007B FF                MOV     R7,A
007C EF                MOV     A,R7
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 68  

007D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1572
007E         ?C0094:
                                           ; SOURCE LINE # 1575
007E 904382            MOV     DPTR,#04382H
0081 E0                MOVX    A,@DPTR
0082 FF                MOV     R7,A
0083 EF                MOV     A,R7
0084 5402              ANL     A,#02H
0086 FF                MOV     R7,A
0087 7E00              MOV     R6,#00H
0089 EF                MOV     A,R7
008A 4E                ORL     A,R6
008B 600B              JZ      ?C0097
                                           ; SOURCE LINE # 1576
                                           ; SOURCE LINE # 1578
008D 904382            MOV     DPTR,#04382H
0090 E0                MOVX    A,@DPTR
0091 FF                MOV     R7,A
0092 EF                MOV     A,R7
0093 54FD              ANL     A,#0FDH
0095 FF                MOV     R7,A
0096 EF                MOV     A,R7
0097 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1579
                                           ; SOURCE LINE # 1580
0098         ?C0097:
0098 22                RET     
             ; FUNCTION _CyPmFtwSaveSet (END)

             ; FUNCTION _CyPmHibSlpSaveSet (BEGIN)
                                           ; SOURCE LINE # 1614
0000 900000      R     MOV     DPTR,#powerMode
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1615
                                           ; SOURCE LINE # 1617
0005 9046F5            MOV     DPTR,#046F5H
0008 E0                MOVX    A,@DPTR
0009 FF                MOV     R7,A
000A EF                MOV     A,R7
000B 5407              ANL     A,#07H
000D FF                MOV     R7,A
000E 900000      R     MOV     DPTR,#cyPmBackup+015H
0011 EF                MOV     A,R7
0012 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1623
0013 905A00            MOV     DPTR,#05A00H
0016 E0                MOVX    A,@DPTR
0017 FF                MOV     R7,A
0018 900000      R     MOV     DPTR,#cyPmBackup+021H
001B EF                MOV     A,R7
001C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1624
001D 905A02            MOV     DPTR,#05A02H
0020 E0                MOVX    A,@DPTR
0021 FF                MOV     R7,A
0022 900000      R     MOV     DPTR,#cyPmBackup+022H
0025 EF                MOV     A,R7
0026 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1625
0027 905A03            MOV     DPTR,#05A03H
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 69  

002A E0                MOVX    A,@DPTR
002B FF                MOV     R7,A
002C 900000      R     MOV     DPTR,#cyPmBackup+023H
002F EF                MOV     A,R7
0030 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1626
0031 905A04            MOV     DPTR,#05A04H
0034 E0                MOVX    A,@DPTR
0035 FF                MOV     R7,A
0036 900000      R     MOV     DPTR,#cyPmBackup+024H
0039 EF                MOV     A,R7
003A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1627
003B 905A06            MOV     DPTR,#05A06H
003E E0                MOVX    A,@DPTR
003F FF                MOV     R7,A
0040 900000      R     MOV     DPTR,#cyPmBackup+025H
0043 EF                MOV     A,R7
0044 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1628
0045 905A08            MOV     DPTR,#05A08H
0048 E0                MOVX    A,@DPTR
0049 FF                MOV     R7,A
004A 900000      R     MOV     DPTR,#cyPmBackup+026H
004D EF                MOV     A,R7
004E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1629
004F 905A0A            MOV     DPTR,#05A0AH
0052 E0                MOVX    A,@DPTR
0053 FF                MOV     R7,A
0054 900000      R     MOV     DPTR,#cyPmBackup+027H
0057 EF                MOV     A,R7
0058 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1631
0059 905A10            MOV     DPTR,#05A10H
005C E0                MOVX    A,@DPTR
005D FF                MOV     R7,A
005E 900000      R     MOV     DPTR,#cyPmBackup+028H
0061 EF                MOV     A,R7
0062 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1632
0063 905A12            MOV     DPTR,#05A12H
0066 E0                MOVX    A,@DPTR
0067 FF                MOV     R7,A
0068 900000      R     MOV     DPTR,#cyPmBackup+029H
006B EF                MOV     A,R7
006C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1633
006D 905A13            MOV     DPTR,#05A13H
0070 E0                MOVX    A,@DPTR
0071 FF                MOV     R7,A
0072 900000      R     MOV     DPTR,#cyPmBackup+02AH
0075 EF                MOV     A,R7
0076 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1634
0077 905A14            MOV     DPTR,#05A14H
007A E0                MOVX    A,@DPTR
007B FF                MOV     R7,A
007C 900000      R     MOV     DPTR,#cyPmBackup+02BH
007F EF                MOV     A,R7
0080 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1635
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 70  

0081 905A16            MOV     DPTR,#05A16H
0084 E0                MOVX    A,@DPTR
0085 FF                MOV     R7,A
0086 900000      R     MOV     DPTR,#cyPmBackup+02CH
0089 EF                MOV     A,R7
008A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1636
008B 905A18            MOV     DPTR,#05A18H
008E E0                MOVX    A,@DPTR
008F FF                MOV     R7,A
0090 900000      R     MOV     DPTR,#cyPmBackup+02DH
0093 EF                MOV     A,R7
0094 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1637
0095 905A1A            MOV     DPTR,#05A1AH
0098 E0                MOVX    A,@DPTR
0099 FF                MOV     R7,A
009A 900000      R     MOV     DPTR,#cyPmBackup+02EH
009D EF                MOV     A,R7
009E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1639
009F 905A20            MOV     DPTR,#05A20H
00A2 E0                MOVX    A,@DPTR
00A3 FF                MOV     R7,A
00A4 900000      R     MOV     DPTR,#cyPmBackup+02FH
00A7 EF                MOV     A,R7
00A8 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1640
00A9 905A22            MOV     DPTR,#05A22H
00AC E0                MOVX    A,@DPTR
00AD FF                MOV     R7,A
00AE 900000      R     MOV     DPTR,#cyPmBackup+030H
00B1 EF                MOV     A,R7
00B2 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1641
00B3 905A23            MOV     DPTR,#05A23H
00B6 E0                MOVX    A,@DPTR
00B7 FF                MOV     R7,A
00B8 900000      R     MOV     DPTR,#cyPmBackup+031H
00BB EF                MOV     A,R7
00BC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1642
00BD 905A24            MOV     DPTR,#05A24H
00C0 E0                MOVX    A,@DPTR
00C1 FF                MOV     R7,A
00C2 900000      R     MOV     DPTR,#cyPmBackup+032H
00C5 EF                MOV     A,R7
00C6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1643
00C7 905A26            MOV     DPTR,#05A26H
00CA E0                MOVX    A,@DPTR
00CB FF                MOV     R7,A
00CC 900000      R     MOV     DPTR,#cyPmBackup+033H
00CF EF                MOV     A,R7
00D0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1644
00D1 905A28            MOV     DPTR,#05A28H
00D4 E0                MOVX    A,@DPTR
00D5 FF                MOV     R7,A
00D6 900000      R     MOV     DPTR,#cyPmBackup+034H
00D9 EF                MOV     A,R7
00DA F0                MOVX    @DPTR,A
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 71  

                                           ; SOURCE LINE # 1645
00DB 905A2A            MOV     DPTR,#05A2AH
00DE E0                MOVX    A,@DPTR
00DF FF                MOV     R7,A
00E0 900000      R     MOV     DPTR,#cyPmBackup+035H
00E3 EF                MOV     A,R7
00E4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1647
00E5 905A30            MOV     DPTR,#05A30H
00E8 E0                MOVX    A,@DPTR
00E9 FF                MOV     R7,A
00EA 900000      R     MOV     DPTR,#cyPmBackup+036H
00ED EF                MOV     A,R7
00EE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1648
00EF 905A32            MOV     DPTR,#05A32H
00F2 E0                MOVX    A,@DPTR
00F3 FF                MOV     R7,A
00F4 900000      R     MOV     DPTR,#cyPmBackup+037H
00F7 EF                MOV     A,R7
00F8 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1649
00F9 905A33            MOV     DPTR,#05A33H
00FC E0                MOVX    A,@DPTR
00FD FF                MOV     R7,A
00FE 900000      R     MOV     DPTR,#cyPmBackup+038H
0101 EF                MOV     A,R7
0102 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1650
0103 905A34            MOV     DPTR,#05A34H
0106 E0                MOVX    A,@DPTR
0107 FF                MOV     R7,A
0108 900000      R     MOV     DPTR,#cyPmBackup+039H
010B EF                MOV     A,R7
010C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1651
010D 905A36            MOV     DPTR,#05A36H
0110 E0                MOVX    A,@DPTR
0111 FF                MOV     R7,A
0112 900000      R     MOV     DPTR,#cyPmBackup+03AH
0115 EF                MOV     A,R7
0116 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1652
0117 905A38            MOV     DPTR,#05A38H
011A E0                MOVX    A,@DPTR
011B FF                MOV     R7,A
011C 900000      R     MOV     DPTR,#cyPmBackup+03BH
011F EF                MOV     A,R7
0120 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1653
0121 905A3A            MOV     DPTR,#05A3AH
0124 E0                MOVX    A,@DPTR
0125 FF                MOV     R7,A
0126 900000      R     MOV     DPTR,#cyPmBackup+03CH
0129 EF                MOV     A,R7
012A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1655
012B 905A00            MOV     DPTR,#05A00H
012E E4                CLR     A
012F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1656
0130 905A02            MOV     DPTR,#05A02H
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 72  

0133 E4                CLR     A
0134 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1657
0135 905A03            MOV     DPTR,#05A03H
0138 E4                CLR     A
0139 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1658
013A 905A04            MOV     DPTR,#05A04H
013D E4                CLR     A
013E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1659
013F 905A06            MOV     DPTR,#05A06H
0142 E4                CLR     A
0143 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1660
0144 905A08            MOV     DPTR,#05A08H
0147 E4                CLR     A
0148 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1661
0149 905A0A            MOV     DPTR,#05A0AH
014C E4                CLR     A
014D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1663
014E 905A10            MOV     DPTR,#05A10H
0151 E4                CLR     A
0152 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1664
0153 905A12            MOV     DPTR,#05A12H
0156 E4                CLR     A
0157 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1665
0158 905A13            MOV     DPTR,#05A13H
015B E4                CLR     A
015C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1666
015D 905A14            MOV     DPTR,#05A14H
0160 E4                CLR     A
0161 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1667
0162 905A16            MOV     DPTR,#05A16H
0165 E4                CLR     A
0166 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1668
0167 905A18            MOV     DPTR,#05A18H
016A E4                CLR     A
016B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1669
016C 905A1A            MOV     DPTR,#05A1AH
016F E4                CLR     A
0170 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1671
0171 905A20            MOV     DPTR,#05A20H
0174 E4                CLR     A
0175 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1672
0176 905A22            MOV     DPTR,#05A22H
0179 E4                CLR     A
017A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1673
017B 905A23            MOV     DPTR,#05A23H
017E E4                CLR     A
017F F0                MOVX    @DPTR,A
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 73  

                                           ; SOURCE LINE # 1674
0180 905A24            MOV     DPTR,#05A24H
0183 E4                CLR     A
0184 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1675
0185 905A26            MOV     DPTR,#05A26H
0188 E4                CLR     A
0189 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1676
018A 905A28            MOV     DPTR,#05A28H
018D E4                CLR     A
018E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1677
018F 905A2A            MOV     DPTR,#05A2AH
0192 E4                CLR     A
0193 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1679
0194 905A30            MOV     DPTR,#05A30H
0197 E4                CLR     A
0198 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1680
0199 905A32            MOV     DPTR,#05A32H
019C E4                CLR     A
019D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1681
019E 905A33            MOV     DPTR,#05A33H
01A1 E4                CLR     A
01A2 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1682
01A3 905A34            MOV     DPTR,#05A34H
01A6 E4                CLR     A
01A7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1683
01A8 905A36            MOV     DPTR,#05A36H
01AB E4                CLR     A
01AC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1684
01AD 905A38            MOV     DPTR,#05A38H
01B0 E4                CLR     A
01B1 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1685
01B2 905A3A            MOV     DPTR,#05A3AH
01B5 E4                CLR     A
01B6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1688
01B7 904685            MOV     DPTR,#04685H
01BA E0                MOVX    A,@DPTR
01BB FF                MOV     R7,A
01BC 900000      R     MOV     DPTR,#cyPmBackup+018H
01BF EF                MOV     A,R7
01C0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1689
01C1 904686            MOV     DPTR,#04686H
01C4 E0                MOVX    A,@DPTR
01C5 FF                MOV     R7,A
01C6 900000      R     MOV     DPTR,#cyPmBackup+019H
01C9 EF                MOV     A,R7
01CA F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1690
01CB 904689            MOV     DPTR,#04689H
01CE E0                MOVX    A,@DPTR
01CF FF                MOV     R7,A
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 74  

01D0 900000      R     MOV     DPTR,#cyPmBackup+01AH
01D3 EF                MOV     A,R7
01D4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1691
01D5 90468A            MOV     DPTR,#0468AH
01D8 E0                MOVX    A,@DPTR
01D9 FF                MOV     R7,A
01DA 900000      R     MOV     DPTR,#cyPmBackup+01BH
01DD EF                MOV     A,R7
01DE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1694
01DF 904689            MOV     DPTR,#04689H
01E2 E0                MOVX    A,@DPTR
01E3 FF                MOV     R7,A
01E4 EF                MOV     A,R7
01E5 4408              ORL     A,#08H
01E7 FF                MOV     R7,A
01E8 EF                MOV     A,R7
01E9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1696
01EA 900000      R     MOV     DPTR,#powerMode
01ED E0                MOVX    A,@DPTR
01EE FF                MOV     R7,A
01EF EF                MOV     A,R7
01F0 120000      E     LCALL   ?C?CCASE
01F3 0000        R     DW      ?C0101
01F5 03                DB      03H
01F6 0000        R     DW      ?C0099
01F8 04                DB      04H
01F9 0000              DW      00H
01FB 0000        R     DW      ?C0098
                                           ; SOURCE LINE # 1697
                                           ; SOURCE LINE # 1698
01FD         ?C0099:
                                           ; SOURCE LINE # 1700
01FD 904681            MOV     DPTR,#04681H
0200 E0                MOVX    A,@DPTR
0201 FF                MOV     R7,A
0202 EF                MOV     A,R7
0203 5480              ANL     A,#080H
0205 FF                MOV     R7,A
0206 7E00              MOV     R6,#00H
0208 EF                MOV     A,R7
0209 4E                ORL     A,R6
020A 700D              JNZ     ?C0101
                                           ; SOURCE LINE # 1701
                                           ; SOURCE LINE # 1703
020C 9046F5            MOV     DPTR,#046F5H
020F E0                MOVX    A,@DPTR
0210 FF                MOV     R7,A
0211 EF                MOV     A,R7
0212 54F8              ANL     A,#0F8H
0214 FF                MOV     R7,A
0215 EF                MOV     A,R7
0216 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1704
0217 8035              SJMP    ?C0098
                                           ; SOURCE LINE # 1705
                                           ; SOURCE LINE # 1708
0219         ?C0101:
                                           ; SOURCE LINE # 1711
0219 9046F5            MOV     DPTR,#046F5H
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 75  

021C E0                MOVX    A,@DPTR
021D FF                MOV     R7,A
021E EF                MOV     A,R7
021F 5407              ANL     A,#07H
0221 FF                MOV     R7,A
0222 7E00              MOV     R6,#00H
0224 EF                MOV     A,R7
0225 4E                ORL     A,R6
0226 601A              JZ      ?C0102
                                           ; SOURCE LINE # 1713
                                           ; SOURCE LINE # 1714
0228 904685            MOV     DPTR,#04685H
022B 747F              MOV     A,#07FH
022D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1715
022E 904686            MOV     DPTR,#04686H
0231 7480              MOV     A,#080H
0233 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1716
0234 904689            MOV     DPTR,#04689H
0237 743B              MOV     A,#03BH
0239 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1717
023A 90468A            MOV     DPTR,#0468AH
023D 745F              MOV     A,#05FH
023F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1718
0240 800C              SJMP    ?C0098
0242         ?C0102:
                                           ; SOURCE LINE # 1720
                                           ; SOURCE LINE # 1722
0242 904685            MOV     DPTR,#04685H
0245 748F              MOV     A,#08FH
0247 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1723
0248 90468A            MOV     DPTR,#0468AH
024B 748E              MOV     A,#08EH
024D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1724
                                           ; SOURCE LINE # 1725
                                           ; SOURCE LINE # 1727
                                           ; SOURCE LINE # 1730
                                           ; SOURCE LINE # 1731
024E         ?C0098:
                                           ; SOURCE LINE # 1736
024E 9046E8            MOV     DPTR,#046E8H
0251 E0                MOVX    A,@DPTR
0252 FF                MOV     R7,A
0253 EF                MOV     A,R7
0254 5404              ANL     A,#04H
0256 FF                MOV     R7,A
0257 7E00              MOV     R6,#00H
0259 EF                MOV     A,R7
025A 4E                ORL     A,R6
025B 6024              JZ      ?C0105
                                           ; SOURCE LINE # 1737
                                           ; SOURCE LINE # 1739
025D 900000      R     MOV     DPTR,#cyPmBackup+01CH
0260 7401              MOV     A,#01H
0262 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1742
0263 90500B            MOV     DPTR,#0500BH
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 76  

0266 E0                MOVX    A,@DPTR
0267 FF                MOV     R7,A
0268 EF                MOV     A,R7
0269 54F1              ANL     A,#0F1H
026B FF                MOV     R7,A
026C EF                MOV     A,R7
026D 4406              ORL     A,#06H
026F FF                MOV     R7,A
0270 900000      R     MOV     DPTR,#cyPmBackup+01DH
0273 EF                MOV     A,R7
0274 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1746
0275 9046E8            MOV     DPTR,#046E8H
0278 E0                MOVX    A,@DPTR
0279 FF                MOV     R7,A
027A EF                MOV     A,R7
027B 54FB              ANL     A,#0FBH
027D FF                MOV     R7,A
027E EF                MOV     A,R7
027F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1747
0280 22                RET     
0281         ?C0105:
                                           ; SOURCE LINE # 1749
                                           ; SOURCE LINE # 1751
0281 900000      R     MOV     DPTR,#cyPmBackup+01CH
0284 E4                CLR     A
0285 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1752
                                           ; SOURCE LINE # 1764
0286         ?C0107:
0286 22                RET     
             ; FUNCTION _CyPmHibSlpSaveSet (END)

             ; FUNCTION CyPmHibSlpRestore (BEGIN)
                                           ; SOURCE LINE # 1785
                                           ; SOURCE LINE # 1786
                                           ; SOURCE LINE # 1788
0000 900000      R     MOV     DPTR,#cyPmBackup+015H
0003 E0                MOVX    A,@DPTR
0004 FF                MOV     R7,A
0005 9046F5            MOV     DPTR,#046F5H
0008 EF                MOV     A,R7
0009 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1794
000A 900000      R     MOV     DPTR,#cyPmBackup+021H
000D E0                MOVX    A,@DPTR
000E FF                MOV     R7,A
000F 905A00            MOV     DPTR,#05A00H
0012 EF                MOV     A,R7
0013 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1795
0014 900000      R     MOV     DPTR,#cyPmBackup+022H
0017 E0                MOVX    A,@DPTR
0018 FF                MOV     R7,A
0019 905A02            MOV     DPTR,#05A02H
001C EF                MOV     A,R7
001D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1796
001E 900000      R     MOV     DPTR,#cyPmBackup+023H
0021 E0                MOVX    A,@DPTR
0022 FF                MOV     R7,A
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 77  

0023 905A03            MOV     DPTR,#05A03H
0026 EF                MOV     A,R7
0027 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1797
0028 900000      R     MOV     DPTR,#cyPmBackup+024H
002B E0                MOVX    A,@DPTR
002C FF                MOV     R7,A
002D 905A04            MOV     DPTR,#05A04H
0030 EF                MOV     A,R7
0031 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1798
0032 900000      R     MOV     DPTR,#cyPmBackup+025H
0035 E0                MOVX    A,@DPTR
0036 FF                MOV     R7,A
0037 905A06            MOV     DPTR,#05A06H
003A EF                MOV     A,R7
003B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1799
003C 900000      R     MOV     DPTR,#cyPmBackup+026H
003F E0                MOVX    A,@DPTR
0040 FF                MOV     R7,A
0041 905A08            MOV     DPTR,#05A08H
0044 EF                MOV     A,R7
0045 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1800
0046 900000      R     MOV     DPTR,#cyPmBackup+027H
0049 E0                MOVX    A,@DPTR
004A FF                MOV     R7,A
004B 905A0A            MOV     DPTR,#05A0AH
004E EF                MOV     A,R7
004F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1802
0050 900000      R     MOV     DPTR,#cyPmBackup+028H
0053 E0                MOVX    A,@DPTR
0054 FF                MOV     R7,A
0055 905A10            MOV     DPTR,#05A10H
0058 EF                MOV     A,R7
0059 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1803
005A 900000      R     MOV     DPTR,#cyPmBackup+029H
005D E0                MOVX    A,@DPTR
005E FF                MOV     R7,A
005F 905A12            MOV     DPTR,#05A12H
0062 EF                MOV     A,R7
0063 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1804
0064 900000      R     MOV     DPTR,#cyPmBackup+02AH
0067 E0                MOVX    A,@DPTR
0068 FF                MOV     R7,A
0069 905A13            MOV     DPTR,#05A13H
006C EF                MOV     A,R7
006D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1805
006E 900000      R     MOV     DPTR,#cyPmBackup+02BH
0071 E0                MOVX    A,@DPTR
0072 FF                MOV     R7,A
0073 905A14            MOV     DPTR,#05A14H
0076 EF                MOV     A,R7
0077 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1806
0078 900000      R     MOV     DPTR,#cyPmBackup+02CH
007B E0                MOVX    A,@DPTR
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 78  

007C FF                MOV     R7,A
007D 905A16            MOV     DPTR,#05A16H
0080 EF                MOV     A,R7
0081 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1807
0082 900000      R     MOV     DPTR,#cyPmBackup+02DH
0085 E0                MOVX    A,@DPTR
0086 FF                MOV     R7,A
0087 905A18            MOV     DPTR,#05A18H
008A EF                MOV     A,R7
008B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1808
008C 900000      R     MOV     DPTR,#cyPmBackup+02EH
008F E0                MOVX    A,@DPTR
0090 FF                MOV     R7,A
0091 905A1A            MOV     DPTR,#05A1AH
0094 EF                MOV     A,R7
0095 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1810
0096 900000      R     MOV     DPTR,#cyPmBackup+02FH
0099 E0                MOVX    A,@DPTR
009A FF                MOV     R7,A
009B 905A20            MOV     DPTR,#05A20H
009E EF                MOV     A,R7
009F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1811
00A0 900000      R     MOV     DPTR,#cyPmBackup+030H
00A3 E0                MOVX    A,@DPTR
00A4 FF                MOV     R7,A
00A5 905A22            MOV     DPTR,#05A22H
00A8 EF                MOV     A,R7
00A9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1812
00AA 900000      R     MOV     DPTR,#cyPmBackup+031H
00AD E0                MOVX    A,@DPTR
00AE FF                MOV     R7,A
00AF 905A23            MOV     DPTR,#05A23H
00B2 EF                MOV     A,R7
00B3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1813
00B4 900000      R     MOV     DPTR,#cyPmBackup+032H
00B7 E0                MOVX    A,@DPTR
00B8 FF                MOV     R7,A
00B9 905A24            MOV     DPTR,#05A24H
00BC EF                MOV     A,R7
00BD F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1814
00BE 900000      R     MOV     DPTR,#cyPmBackup+033H
00C1 E0                MOVX    A,@DPTR
00C2 FF                MOV     R7,A
00C3 905A26            MOV     DPTR,#05A26H
00C6 EF                MOV     A,R7
00C7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1815
00C8 900000      R     MOV     DPTR,#cyPmBackup+034H
00CB E0                MOVX    A,@DPTR
00CC FF                MOV     R7,A
00CD 905A28            MOV     DPTR,#05A28H
00D0 EF                MOV     A,R7
00D1 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1816
00D2 900000      R     MOV     DPTR,#cyPmBackup+035H
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 79  

00D5 E0                MOVX    A,@DPTR
00D6 FF                MOV     R7,A
00D7 905A2A            MOV     DPTR,#05A2AH
00DA EF                MOV     A,R7
00DB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1818
00DC 900000      R     MOV     DPTR,#cyPmBackup+036H
00DF E0                MOVX    A,@DPTR
00E0 FF                MOV     R7,A
00E1 905A30            MOV     DPTR,#05A30H
00E4 EF                MOV     A,R7
00E5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1819
00E6 900000      R     MOV     DPTR,#cyPmBackup+037H
00E9 E0                MOVX    A,@DPTR
00EA FF                MOV     R7,A
00EB 905A32            MOV     DPTR,#05A32H
00EE EF                MOV     A,R7
00EF F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1820
00F0 900000      R     MOV     DPTR,#cyPmBackup+038H
00F3 E0                MOVX    A,@DPTR
00F4 FF                MOV     R7,A
00F5 905A33            MOV     DPTR,#05A33H
00F8 EF                MOV     A,R7
00F9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1821
00FA 900000      R     MOV     DPTR,#cyPmBackup+039H
00FD E0                MOVX    A,@DPTR
00FE FF                MOV     R7,A
00FF 905A34            MOV     DPTR,#05A34H
0102 EF                MOV     A,R7
0103 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1822
0104 900000      R     MOV     DPTR,#cyPmBackup+03AH
0107 E0                MOVX    A,@DPTR
0108 FF                MOV     R7,A
0109 905A36            MOV     DPTR,#05A36H
010C EF                MOV     A,R7
010D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1823
010E 900000      R     MOV     DPTR,#cyPmBackup+03BH
0111 E0                MOVX    A,@DPTR
0112 FF                MOV     R7,A
0113 905A38            MOV     DPTR,#05A38H
0116 EF                MOV     A,R7
0117 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1824
0118 900000      R     MOV     DPTR,#cyPmBackup+03CH
011B E0                MOVX    A,@DPTR
011C FF                MOV     R7,A
011D 905A3A            MOV     DPTR,#05A3AH
0120 EF                MOV     A,R7
0121 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1827
0122 900000      R     MOV     DPTR,#cyPmBackup+018H
0125 E0                MOVX    A,@DPTR
0126 FF                MOV     R7,A
0127 904685            MOV     DPTR,#04685H
012A EF                MOV     A,R7
012B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1828
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 80  

012C 900000      R     MOV     DPTR,#cyPmBackup+019H
012F E0                MOVX    A,@DPTR
0130 FF                MOV     R7,A
0131 904686            MOV     DPTR,#04686H
0134 EF                MOV     A,R7
0135 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1829
0136 900000      R     MOV     DPTR,#cyPmBackup+01AH
0139 E0                MOVX    A,@DPTR
013A FF                MOV     R7,A
013B 904689            MOV     DPTR,#04689H
013E EF                MOV     A,R7
013F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1830
0140 900000      R     MOV     DPTR,#cyPmBackup+01BH
0143 E0                MOVX    A,@DPTR
0144 FF                MOV     R7,A
0145 90468A            MOV     DPTR,#0468AH
0148 EF                MOV     A,R7
0149 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1833
014A 900000      R     MOV     DPTR,#cyPmBackup+01CH
014D E0                MOVX    A,@DPTR
014E FF                MOV     R7,A
014F EF                MOV     A,R7
0150 B40121            CJNE    A,#01H,?C0109
                                           ; SOURCE LINE # 1834
                                           ; SOURCE LINE # 1836
0153 90500B            MOV     DPTR,#0500BH
0156 E0                MOVX    A,@DPTR
0157 FF                MOV     R7,A
0158 EF                MOV     A,R7
0159 54F1              ANL     A,#0F1H
015B FF                MOV     R7,A
015C 900000      R     MOV     DPTR,#cyPmBackup+01DH
015F E0                MOVX    A,@DPTR
0160 FE                MOV     R6,A
0161 EF                MOV     A,R7
0162 4E                ORL     A,R6
0163 FF                MOV     R7,A
0164 900000      R     MOV     DPTR,#cyPmBackup+01DH
0167 EF                MOV     A,R7
0168 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1840
0169 9046E8            MOV     DPTR,#046E8H
016C E0                MOVX    A,@DPTR
016D FF                MOV     R7,A
016E EF                MOV     A,R7
016F 4404              ORL     A,#04H
0171 FF                MOV     R7,A
0172 EF                MOV     A,R7
0173 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1841
                                           ; SOURCE LINE # 1844
0174         ?C0109:
0174 22                RET     
             ; FUNCTION CyPmHibSlpRestore (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   3750    ----
C51 COMPILER V8.16   CYPM                                                                  07/15/2011 13:52:49 PAGE 81  

   CONSTANT SIZE    =     14    ----
   XDATA SIZE       =     62      15
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
